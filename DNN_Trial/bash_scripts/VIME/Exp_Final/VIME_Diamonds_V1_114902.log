Namespace(batch_size=64, bin_alt=None, cat_dims=[2], cat_idx=[0], config='config/diamonds.yml', data_parallel=False, dataset='Diamonds', direction='maximize', dropna_idx=None, early_stopping_rounds=20, epochs=100, frequency_reg=False, gpu_ids=[0, 1], logging_period=100, miss_cat_idx=None, miss_num_idx=None, model_name='VIME', n_trials=30, nominal_idx=None, num_bins=10, num_classes=1, num_features=9, num_idx=None, num_splits=5, objective='probabilistic_regression', one_hot_encode=False, optimize_hyperparameters=True, ordinal_encode=True, ordinal_idx=[1, 2, 3], scale=True, seed=221, shuffle=True, target_encode=False, use_gpu=True, val_batch_size=128, y_distribution='normal')
Start hyperparameter optimization
Loading dataset Diamonds...
Dataset loaded! 

(53940, 9)
Using an existing study with name 'VIME_Diamonds' instead of creating a new one.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3720121190571537, 'alpha': 0.19144321254777824, 'K': 10, 'beta': 2.775149912438648}
Fitted encoder
Epoch 0, Val Loss: 2.30546
Epoch 1, Val Loss: 2.41527
Epoch 2, Val Loss: 2.22302
Epoch 3, Val Loss: 2.21417
Epoch 4, Val Loss: 2.24672
Epoch 5, Val Loss: 2.26243
Epoch 6, Val Loss: 2.17535
Epoch 7, Val Loss: 2.19553
Epoch 8, Val Loss: 2.21263
Epoch 9, Val Loss: 2.26046
Epoch 10, Val Loss: 2.22327
Epoch 11, Val Loss: 2.30882
Epoch 12, Val Loss: 2.33769
Epoch 13, Val Loss: 2.35289
Epoch 14, Val Loss: 2.41872
Epoch 15, Val Loss: 2.34754
Epoch 16, Val Loss: 2.44635
Epoch 17, Val Loss: 2.36483
Epoch 18, Val Loss: 2.37995
Epoch 19, Val Loss: 2.40783
Epoch 20, Val Loss: 2.39968
Epoch 21, Val Loss: 2.45158
Epoch 22, Val Loss: 2.34471
Epoch 23, Val Loss: 2.68148
Epoch 24, Val Loss: 2.68148
Epoch 25, Val Loss: 2.68148
Epoch 26, Val Loss: 2.68148
Epoch 27, Val Loss: 2.68148
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.0319, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3720121190571537, 'alpha': 0.19144321254777824, 'K': 10, 'beta': 2.775149912438648}
Fitted encoder
Epoch 0, Val Loss: 2.37314
Epoch 1, Val Loss: 2.37984
Epoch 2, Val Loss: 2.34868
Epoch 3, Val Loss: 2.34371
Epoch 4, Val Loss: 2.30233
Epoch 5, Val Loss: 2.38663
Epoch 6, Val Loss: 2.46002
Epoch 7, Val Loss: 2.32936
Epoch 8, Val Loss: 2.29066
Epoch 9, Val Loss: 2.33128
Epoch 10, Val Loss: 2.32241
Epoch 11, Val Loss: 2.33375
Epoch 12, Val Loss: 2.38830
Epoch 13, Val Loss: 2.29472
Epoch 14, Val Loss: 2.29527
Epoch 15, Val Loss: 2.28993
Epoch 16, Val Loss: 2.27544
Epoch 17, Val Loss: 2.26087
Epoch 18, Val Loss: 2.25507
Epoch 19, Val Loss: 2.25068
Epoch 20, Val Loss: 2.25046
Epoch 21, Val Loss: 2.25514
Epoch 22, Val Loss: 2.29904
Epoch 23, Val Loss: 2.27126
Epoch 24, Val Loss: 2.30612
Epoch 25, Val Loss: 2.25207
Epoch 26, Val Loss: 2.48269
Epoch 27, Val Loss: 2.38617
Epoch 28, Val Loss: 2.29150
Epoch 29, Val Loss: 2.46282
Epoch 30, Val Loss: 2.25061
Epoch 31, Val Loss: 2.26582
Epoch 32, Val Loss: 2.24028
Epoch 33, Val Loss: 2.30358
Epoch 34, Val Loss: 2.29036
Epoch 35, Val Loss: 2.25835
Epoch 36, Val Loss: 2.29086
Epoch 37, Val Loss: 2.27446
Epoch 38, Val Loss: 2.29180
Epoch 39, Val Loss: 2.23800
Epoch 40, Val Loss: 2.32575
Epoch 41, Val Loss: 2.24700
Epoch 42, Val Loss: 2.23647
Epoch 43, Val Loss: 2.27013
Epoch 44, Val Loss: 2.26776
Epoch 45, Val Loss: 2.23690
Epoch 46, Val Loss: 2.24094
Epoch 47, Val Loss: 2.30489
Epoch 48, Val Loss: 2.23736
Epoch 49, Val Loss: 2.20398
Epoch 50, Val Loss: 2.40019
Epoch 51, Val Loss: 2.23230
Epoch 52, Val Loss: 2.23981
Epoch 53, Val Loss: 2.28844
Epoch 54, Val Loss: 2.22838
Epoch 55, Val Loss: 2.21067
Epoch 56, Val Loss: 2.27014
Epoch 57, Val Loss: 2.21136
Epoch 58, Val Loss: 2.25514
Epoch 59, Val Loss: 2.23362
Epoch 60, Val Loss: 2.23287
Epoch 61, Val Loss: 2.22377
Epoch 62, Val Loss: 2.20877
Epoch 63, Val Loss: 2.20797
Epoch 64, Val Loss: 2.21658
Epoch 65, Val Loss: 2.57970
Epoch 66, Val Loss: 2.22316
Epoch 67, Val Loss: 2.31545
Epoch 68, Val Loss: 2.22559
Epoch 69, Val Loss: 2.27377
Epoch 70, Val Loss: 2.17603
Epoch 71, Val Loss: 2.18978
Epoch 72, Val Loss: 2.26162
Epoch 73, Val Loss: 2.22171
Epoch 74, Val Loss: 2.25140
Epoch 75, Val Loss: 2.26361
Epoch 76, Val Loss: 2.16942
Epoch 77, Val Loss: 2.14445
Epoch 78, Val Loss: 2.21876
Epoch 79, Val Loss: 2.17264
Epoch 80, Val Loss: 2.16556
Epoch 81, Val Loss: 2.24589
Epoch 82, Val Loss: 2.18842
Epoch 83, Val Loss: 2.20230
Epoch 84, Val Loss: 2.18361
Epoch 85, Val Loss: 2.30917
Epoch 86, Val Loss: 2.20039
Epoch 87, Val Loss: 2.18690
Epoch 88, Val Loss: 2.18431
Epoch 89, Val Loss: 2.18308
Epoch 90, Val Loss: 2.16122
Epoch 91, Val Loss: 2.25454
Epoch 92, Val Loss: 2.17555
Epoch 93, Val Loss: 2.18980
Epoch 94, Val Loss: 2.28957
Epoch 95, Val Loss: 2.25100
Epoch 96, Val Loss: 2.17000
Epoch 97, Val Loss: 2.19622
Epoch 98, Val Loss: 2.25951
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.791, 'Log Loss - std': 0.2408999999999999} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3720121190571537, 'alpha': 0.19144321254777824, 'K': 10, 'beta': 2.775149912438648}
Fitted encoder
Epoch 0, Val Loss: 2.31636
Epoch 1, Val Loss: 2.45074
Epoch 2, Val Loss: 2.51054
Epoch 3, Val Loss: 2.40615
Epoch 4, Val Loss: 2.36180
Epoch 5, Val Loss: 2.54014
Epoch 6, Val Loss: 2.68240
Epoch 7, Val Loss: 2.68240
Epoch 8, Val Loss: 2.68240
Epoch 9, Val Loss: 2.68240
Epoch 10, Val Loss: 2.68240
Epoch 11, Val Loss: 2.68240
Epoch 12, Val Loss: 2.68240
Epoch 13, Val Loss: 2.68240
Epoch 14, Val Loss: 2.68240
Epoch 15, Val Loss: 2.68240
Epoch 16, Val Loss: 2.58128
Epoch 17, Val Loss: 2.53463
Epoch 18, Val Loss: 2.50692
Epoch 19, Val Loss: 2.55446
Epoch 20, Val Loss: 2.51656
Epoch 21, Val Loss: 2.51505
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.1735666666666664, 'Log Loss - std': 0.5756761666847854} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3720121190571537, 'alpha': 0.19144321254777824, 'K': 10, 'beta': 2.775149912438648}
Fitted encoder
Epoch 0, Val Loss: 2.34254
Epoch 1, Val Loss: 2.24307
Epoch 2, Val Loss: 2.29952
Epoch 3, Val Loss: 2.28550
Epoch 4, Val Loss: 2.27274
Epoch 5, Val Loss: 2.41246
Epoch 6, Val Loss: 2.33859
Epoch 7, Val Loss: 2.40605
Epoch 8, Val Loss: 2.25468
Epoch 9, Val Loss: 2.21535
Epoch 10, Val Loss: 2.23757
Epoch 11, Val Loss: 2.24643
Epoch 12, Val Loss: 2.27773
Epoch 13, Val Loss: 2.24502
Epoch 14, Val Loss: 2.20363
Epoch 15, Val Loss: 2.20266
Epoch 16, Val Loss: 2.23731
Epoch 17, Val Loss: 2.25021
Epoch 18, Val Loss: 2.29368
Epoch 19, Val Loss: 2.19615
Epoch 20, Val Loss: 2.27331
Epoch 21, Val Loss: 2.29213
Epoch 22, Val Loss: 2.28924
Epoch 23, Val Loss: 2.22665
Epoch 24, Val Loss: 2.40088
Epoch 25, Val Loss: 2.18561
Epoch 26, Val Loss: 2.21769
Epoch 27, Val Loss: 2.21248
Epoch 28, Val Loss: 2.40751
Epoch 29, Val Loss: 2.37461
Epoch 30, Val Loss: 2.30986
Epoch 31, Val Loss: 2.33994
Epoch 32, Val Loss: 2.37094
Epoch 33, Val Loss: 2.26076
Epoch 34, Val Loss: 2.34372
Epoch 35, Val Loss: 2.23281
Epoch 36, Val Loss: 2.23166
Epoch 37, Val Loss: 2.28884
Epoch 38, Val Loss: 2.28844
Epoch 39, Val Loss: 2.34079
Epoch 40, Val Loss: 2.27529
Epoch 41, Val Loss: 2.31785
Epoch 42, Val Loss: 2.33330
Epoch 43, Val Loss: 2.24733
Epoch 44, Val Loss: 2.26702
Epoch 45, Val Loss: 2.33174
Epoch 46, Val Loss: 2.30486
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.1918249999999997, 'Log Loss - std': 0.49955218633792403} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3720121190571537, 'alpha': 0.19144321254777824, 'K': 10, 'beta': 2.775149912438648}
Fitted encoder
Epoch 0, Val Loss: 2.43102
Epoch 1, Val Loss: 2.32721
Epoch 2, Val Loss: 2.39034
Epoch 3, Val Loss: 2.39570
Epoch 4, Val Loss: 2.44663
Epoch 5, Val Loss: 2.28166
Epoch 6, Val Loss: 2.37923
Epoch 7, Val Loss: 2.36273
Epoch 8, Val Loss: 2.50804
Epoch 9, Val Loss: 2.39712
Epoch 10, Val Loss: 2.42768
Epoch 11, Val Loss: 2.38596
Epoch 12, Val Loss: 2.38488
Epoch 13, Val Loss: 2.46506
Epoch 14, Val Loss: 2.68938
Epoch 15, Val Loss: 2.68938
Epoch 16, Val Loss: 2.68938
Epoch 17, Val Loss: 2.68938
Epoch 18, Val Loss: 2.68938
Epoch 19, Val Loss: 2.68938
Epoch 20, Val Loss: 2.68938
Epoch 21, Val Loss: 2.68938
Epoch 22, Val Loss: 2.68938
Epoch 23, Val Loss: 2.68938
Epoch 24, Val Loss: 2.68938
Epoch 25, Val Loss: 2.68938
Epoch 26, Val Loss: 2.68938
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.3829599999999997, 'Log Loss - std': 0.5880240321619516} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 24 finished with value: 2.3829599999999997 and parameters: {'p_m': 0.3720121190571537, 'alpha': 0.19144321254777824, 'K': 10, 'beta': 2.775149912438648}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.536825339888764, 'alpha': 2.286520134541733, 'K': 5, 'beta': 1.1162195530225414}
Fitted encoder
Epoch 0, Val Loss: 2.39367
Epoch 1, Val Loss: 2.32207
Epoch 2, Val Loss: 2.36087
Epoch 3, Val Loss: 2.27976
Epoch 4, Val Loss: 2.33843
Epoch 5, Val Loss: 2.30579
Epoch 6, Val Loss: 2.27417
Epoch 7, Val Loss: 2.31719
Epoch 8, Val Loss: 2.29714
Epoch 9, Val Loss: 2.31595
Epoch 10, Val Loss: 2.27709
Epoch 11, Val Loss: 2.30312
Epoch 12, Val Loss: 2.28589
Epoch 13, Val Loss: 2.40057
Epoch 14, Val Loss: 2.27791
Epoch 15, Val Loss: 2.36042
Epoch 16, Val Loss: 2.36095
Epoch 17, Val Loss: 2.30448
Epoch 18, Val Loss: 2.33950
Epoch 19, Val Loss: 2.29669
Epoch 20, Val Loss: 2.27779
Epoch 21, Val Loss: 2.28339
Epoch 22, Val Loss: 2.27673
Epoch 23, Val Loss: 2.35085
Epoch 24, Val Loss: 2.32792
Epoch 25, Val Loss: 2.28522
Epoch 26, Val Loss: 2.37525
Epoch 27, Val Loss: 2.28340
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.4004, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.536825339888764, 'alpha': 2.286520134541733, 'K': 5, 'beta': 1.1162195530225414}
Fitted encoder
Epoch 0, Val Loss: 2.46951
Epoch 1, Val Loss: 2.67504
Epoch 2, Val Loss: 2.67504
Epoch 3, Val Loss: 2.68543
Epoch 4, Val Loss: 2.68543
Epoch 5, Val Loss: 2.68543
Epoch 6, Val Loss: 2.68543
Epoch 7, Val Loss: 2.68543
Epoch 8, Val Loss: 2.68543
Epoch 9, Val Loss: 2.68543
Epoch 10, Val Loss: 2.68543
Epoch 11, Val Loss: 2.68543
Epoch 12, Val Loss: 2.68543
Epoch 13, Val Loss: 2.68543
Epoch 14, Val Loss: 2.68543
Epoch 15, Val Loss: 2.68543
Epoch 16, Val Loss: 2.68745
Epoch 17, Val Loss: 2.68745
Epoch 18, Val Loss: 2.68745
Epoch 19, Val Loss: 2.68745
Epoch 20, Val Loss: 2.68745
Epoch 21, Val Loss: 2.68745
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.4047, 'Log Loss - std': 1.0042999999999997} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.536825339888764, 'alpha': 2.286520134541733, 'K': 5, 'beta': 1.1162195530225414}
Fitted encoder
Epoch 0, Val Loss: 2.42155
Epoch 1, Val Loss: 2.48984
Epoch 2, Val Loss: 2.39742
Epoch 3, Val Loss: 2.30207
Epoch 4, Val Loss: 2.40257
Epoch 5, Val Loss: 2.33305
Epoch 6, Val Loss: 2.30429
Epoch 7, Val Loss: 2.33293
Epoch 8, Val Loss: 2.35181
Epoch 9, Val Loss: 2.46157
Epoch 10, Val Loss: 2.24355
Epoch 11, Val Loss: 2.33140
Epoch 12, Val Loss: 2.28989
Epoch 13, Val Loss: 2.23441
Epoch 14, Val Loss: 2.22963
Epoch 15, Val Loss: 2.31291
Epoch 16, Val Loss: 2.29558
Epoch 17, Val Loss: 2.27735
Epoch 18, Val Loss: 2.20375
Epoch 19, Val Loss: 2.26072
Epoch 20, Val Loss: 2.23763
Epoch 21, Val Loss: 2.29666
Epoch 22, Val Loss: 2.27733
Epoch 23, Val Loss: 2.34660
Epoch 24, Val Loss: 2.37962
Epoch 25, Val Loss: 2.47478
Epoch 26, Val Loss: 2.30256
Epoch 27, Val Loss: 2.28254
Epoch 28, Val Loss: 2.22114
Epoch 29, Val Loss: 2.27707
Epoch 30, Val Loss: 2.24663
Epoch 31, Val Loss: 2.18631
Epoch 32, Val Loss: 2.16140
Epoch 33, Val Loss: 2.16603
Epoch 34, Val Loss: 2.20913
Epoch 35, Val Loss: 2.26612
Epoch 36, Val Loss: 2.26559
Epoch 37, Val Loss: 2.44259
Epoch 38, Val Loss: 2.22350
Epoch 39, Val Loss: 2.29000
Epoch 40, Val Loss: 2.21597
Epoch 41, Val Loss: 2.24846
Epoch 42, Val Loss: 2.21607
Epoch 43, Val Loss: 2.25213
Epoch 44, Val Loss: 2.37113
Epoch 45, Val Loss: 2.32016
Epoch 46, Val Loss: 2.28992
Epoch 47, Val Loss: 2.36390
Epoch 48, Val Loss: 2.31986
Epoch 49, Val Loss: 2.27603
Epoch 50, Val Loss: 2.36233
Epoch 51, Val Loss: 2.36502
Epoch 52, Val Loss: 2.35851
Epoch 53, Val Loss: 2.29930
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.294066666666667, 'Log Loss - std': 1.771842297973747} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.536825339888764, 'alpha': 2.286520134541733, 'K': 5, 'beta': 1.1162195530225414}
Fitted encoder
Epoch 0, Val Loss: 2.44000
Epoch 1, Val Loss: 2.41827
Epoch 2, Val Loss: 2.42888
Epoch 3, Val Loss: 2.44226
Epoch 4, Val Loss: 2.44460
Epoch 5, Val Loss: 2.45894
Epoch 6, Val Loss: 2.45325
Epoch 7, Val Loss: 2.44158
Epoch 8, Val Loss: 2.44307
Epoch 9, Val Loss: 2.46600
Epoch 10, Val Loss: 2.44058
Epoch 11, Val Loss: 2.68728
Epoch 12, Val Loss: 2.68727
Epoch 13, Val Loss: 2.68727
Epoch 14, Val Loss: 2.39970
Epoch 15, Val Loss: 2.35459
Epoch 16, Val Loss: 2.34483
Epoch 17, Val Loss: 2.39593
Epoch 18, Val Loss: 2.33312
Epoch 19, Val Loss: 2.32865
Epoch 20, Val Loss: 2.34333
Epoch 21, Val Loss: 2.32634
Epoch 22, Val Loss: 2.31713
Epoch 23, Val Loss: 2.31766
Epoch 24, Val Loss: 2.32948
Epoch 25, Val Loss: 2.33825
Epoch 26, Val Loss: 2.29661
Epoch 27, Val Loss: 2.23733
Epoch 28, Val Loss: 2.28387
Epoch 29, Val Loss: 2.31482
Epoch 30, Val Loss: 2.30522
Epoch 31, Val Loss: 2.36332
Epoch 32, Val Loss: 2.36415
Epoch 33, Val Loss: 2.31835
Epoch 34, Val Loss: 2.35986
Epoch 35, Val Loss: 2.32995
Epoch 36, Val Loss: 2.29042
Epoch 37, Val Loss: 2.27795
Epoch 38, Val Loss: 2.29773
Epoch 39, Val Loss: 2.29855
Epoch 40, Val Loss: 2.26483
Epoch 41, Val Loss: 2.30794
Epoch 42, Val Loss: 2.34963
Epoch 43, Val Loss: 2.30113
Epoch 44, Val Loss: 2.29280
Epoch 45, Val Loss: 2.26968
Epoch 46, Val Loss: 2.21936
Epoch 47, Val Loss: 2.26054
Epoch 48, Val Loss: 2.18185
Epoch 49, Val Loss: 2.17345
Epoch 50, Val Loss: 2.15344
Epoch 51, Val Loss: 2.17964
Epoch 52, Val Loss: 2.19902
Epoch 53, Val Loss: 2.15427
Epoch 54, Val Loss: 2.19972
Epoch 55, Val Loss: 2.16534
Epoch 56, Val Loss: 2.20212
Epoch 57, Val Loss: 2.20922
Epoch 58, Val Loss: 2.17876
Epoch 59, Val Loss: 2.18052
Epoch 60, Val Loss: 2.21244
Epoch 61, Val Loss: 2.19800
Epoch 62, Val Loss: 2.15648
Epoch 63, Val Loss: 2.19153
Epoch 64, Val Loss: 2.17204
Epoch 65, Val Loss: 2.21260
Epoch 66, Val Loss: 2.16833
Epoch 67, Val Loss: 2.25307
Epoch 68, Val Loss: 2.18112
Epoch 69, Val Loss: 2.29427
Epoch 70, Val Loss: 2.20071
Epoch 71, Val Loss: 2.23885
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.6803000000000003, 'Log Loss - std': 1.8667344240678694} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.536825339888764, 'alpha': 2.286520134541733, 'K': 5, 'beta': 1.1162195530225414}
Fitted encoder
Epoch 0, Val Loss: 2.51721
Epoch 1, Val Loss: 2.53757
Epoch 2, Val Loss: 2.68487
Epoch 3, Val Loss: 2.68487
Epoch 4, Val Loss: 2.68488
Epoch 5, Val Loss: 2.68488
Epoch 6, Val Loss: 2.68488
Epoch 7, Val Loss: 2.67936
Epoch 8, Val Loss: 2.67936
Epoch 9, Val Loss: 2.67936
Epoch 10, Val Loss: 2.67936
Epoch 11, Val Loss: 2.68938
Epoch 12, Val Loss: 2.68938
Epoch 13, Val Loss: 2.68938
Epoch 14, Val Loss: 2.68267
Epoch 15, Val Loss: 2.68267
Epoch 16, Val Loss: 2.64193
Epoch 17, Val Loss: 2.68488
Epoch 18, Val Loss: 2.68488
Epoch 19, Val Loss: 2.68488
Epoch 20, Val Loss: 2.68488
Epoch 21, Val Loss: 2.68488
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.40568, 'Log Loss - std': 2.2118911604326286} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 25 finished with value: 4.40568 and parameters: {'p_m': 0.536825339888764, 'alpha': 2.286520134541733, 'K': 5, 'beta': 1.1162195530225414}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.41364363415458294, 'alpha': 0.7900711913804557, 'K': 20, 'beta': 1.3219588014773995}
Fitted encoder
Epoch 0, Val Loss: 2.38984
Epoch 1, Val Loss: 2.43429
Epoch 2, Val Loss: 2.40583
Epoch 3, Val Loss: 2.41363
Epoch 4, Val Loss: 2.36321
Epoch 5, Val Loss: 2.44915
Epoch 6, Val Loss: 2.35431
Epoch 7, Val Loss: 2.34355
Epoch 8, Val Loss: 2.30959
Epoch 9, Val Loss: 2.30780
Epoch 10, Val Loss: 2.33785
Epoch 11, Val Loss: 2.35252
Epoch 12, Val Loss: 2.35051
Epoch 13, Val Loss: 2.36217
Epoch 14, Val Loss: 2.36385
Epoch 15, Val Loss: 2.31381
Epoch 16, Val Loss: 2.32217
Epoch 17, Val Loss: 2.44009
Epoch 18, Val Loss: 2.28050
Epoch 19, Val Loss: 2.29577
Epoch 20, Val Loss: 2.29650
Epoch 21, Val Loss: 2.31458
Epoch 22, Val Loss: 2.27541
Epoch 23, Val Loss: 2.31047
Epoch 24, Val Loss: 2.39102
Epoch 25, Val Loss: 2.33556
Epoch 26, Val Loss: 2.27600
Epoch 27, Val Loss: 2.25397
Epoch 28, Val Loss: 2.32453
Epoch 29, Val Loss: 2.26406
Epoch 30, Val Loss: 2.27540
Epoch 31, Val Loss: 2.26933
Epoch 32, Val Loss: 2.26908
Epoch 33, Val Loss: 2.29433
Epoch 34, Val Loss: 2.28757
Epoch 35, Val Loss: 2.34724
Epoch 36, Val Loss: 2.36212
Epoch 37, Val Loss: 2.42666
Epoch 38, Val Loss: 2.38805
Epoch 39, Val Loss: 2.37701
Epoch 40, Val Loss: 2.35811
Epoch 41, Val Loss: 2.31676
Epoch 42, Val Loss: 2.35051
Epoch 43, Val Loss: 2.31188
Epoch 44, Val Loss: 2.40960
Epoch 45, Val Loss: 2.27398
Epoch 46, Val Loss: 2.29686
Epoch 47, Val Loss: 2.54255
Epoch 48, Val Loss: 2.28171
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.8383, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.41364363415458294, 'alpha': 0.7900711913804557, 'K': 20, 'beta': 1.3219588014773995}
Fitted encoder
Epoch 0, Val Loss: 2.34757
Epoch 1, Val Loss: 2.37913
Epoch 2, Val Loss: 2.39294
Epoch 3, Val Loss: 2.35357
Epoch 4, Val Loss: 2.36780
Epoch 5, Val Loss: 2.37895
Epoch 6, Val Loss: 2.29267
Epoch 7, Val Loss: 2.25405
Epoch 8, Val Loss: 2.28298
Epoch 9, Val Loss: 2.51874
Epoch 10, Val Loss: 2.39781
Epoch 11, Val Loss: 2.30017
Epoch 12, Val Loss: 2.42032
Epoch 13, Val Loss: 2.26176
Epoch 14, Val Loss: 2.41930
Epoch 15, Val Loss: 2.29726
Epoch 16, Val Loss: 2.30351
Epoch 17, Val Loss: 2.37403
Epoch 18, Val Loss: 2.41911
Epoch 19, Val Loss: 2.29445
Epoch 20, Val Loss: 2.31585
Epoch 21, Val Loss: 2.31448
Epoch 22, Val Loss: 2.68359
Epoch 23, Val Loss: 2.68359
Epoch 24, Val Loss: 2.68359
Epoch 25, Val Loss: 2.68350
Epoch 26, Val Loss: 2.68350
Epoch 27, Val Loss: 2.68350
Epoch 28, Val Loss: 2.68348
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.7683999999999997, 'Log Loss - std': 0.06989999999999985} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.41364363415458294, 'alpha': 0.7900711913804557, 'K': 20, 'beta': 1.3219588014773995}
Fitted encoder
Epoch 0, Val Loss: 2.40097
Epoch 1, Val Loss: 2.49136
Epoch 2, Val Loss: 2.32882
Epoch 3, Val Loss: 2.40397
Epoch 4, Val Loss: 2.32099
Epoch 5, Val Loss: 2.38864
Epoch 6, Val Loss: 2.62721
Epoch 7, Val Loss: 2.68322
Epoch 8, Val Loss: 2.68322
Epoch 9, Val Loss: 2.68322
Epoch 10, Val Loss: 2.68322
Epoch 11, Val Loss: 2.68322
Epoch 12, Val Loss: 2.68322
Epoch 13, Val Loss: 2.68322
Epoch 14, Val Loss: 2.67707
Epoch 15, Val Loss: 2.67707
Epoch 16, Val Loss: 2.67707
Epoch 17, Val Loss: 2.67707
Epoch 18, Val Loss: 2.67707
Epoch 19, Val Loss: 2.67707
Epoch 20, Val Loss: 2.67707
Epoch 21, Val Loss: 2.67707
Epoch 22, Val Loss: 2.67707
Epoch 23, Val Loss: 2.67707
Epoch 24, Val Loss: 2.67707
Epoch 25, Val Loss: 2.67707
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.5851333333333333, 'Log Loss - std': 1.156444557925522} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.41364363415458294, 'alpha': 0.7900711913804557, 'K': 20, 'beta': 1.3219588014773995}
Fitted encoder
Epoch 0, Val Loss: 2.47859
Epoch 1, Val Loss: 2.46475
Epoch 2, Val Loss: 2.35586
Epoch 3, Val Loss: 2.35535
Epoch 4, Val Loss: 2.39055
Epoch 5, Val Loss: 2.33394
Epoch 6, Val Loss: 2.31679
Epoch 7, Val Loss: 2.33146
Epoch 8, Val Loss: 2.35860
Epoch 9, Val Loss: 2.26088
Epoch 10, Val Loss: 2.31604
Epoch 11, Val Loss: 2.31672
Epoch 12, Val Loss: 2.29579
Epoch 13, Val Loss: 2.34356
Epoch 14, Val Loss: 2.30229
Epoch 15, Val Loss: 2.24824
Epoch 16, Val Loss: 2.29796
Epoch 17, Val Loss: 2.25139
Epoch 18, Val Loss: 2.31190
Epoch 19, Val Loss: 2.28417
Epoch 20, Val Loss: 2.30819
Epoch 21, Val Loss: 2.28883
Epoch 22, Val Loss: 2.32437
Epoch 23, Val Loss: 2.29126
Epoch 24, Val Loss: 2.34110
Epoch 25, Val Loss: 2.37532
Epoch 26, Val Loss: 2.29511
Epoch 27, Val Loss: 2.30670
Epoch 28, Val Loss: 2.36902
Epoch 29, Val Loss: 2.36891
Epoch 30, Val Loss: 2.38719
Epoch 31, Val Loss: 2.31297
Epoch 32, Val Loss: 2.32787
Epoch 33, Val Loss: 2.30038
Epoch 34, Val Loss: 2.26951
Epoch 35, Val Loss: 2.28594
Epoch 36, Val Loss: 2.25436
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.3647, 'Log Loss - std': 1.071818816311787} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.41364363415458294, 'alpha': 0.7900711913804557, 'K': 20, 'beta': 1.3219588014773995}
Fitted encoder
Epoch 0, Val Loss: 2.46113
Epoch 1, Val Loss: 2.40613
Epoch 2, Val Loss: 2.49845
Epoch 3, Val Loss: 2.48075
Epoch 4, Val Loss: 2.44114
Epoch 5, Val Loss: 2.44195
Epoch 6, Val Loss: 2.36195
Epoch 7, Val Loss: 2.36017
Epoch 8, Val Loss: 2.41417
Epoch 9, Val Loss: 2.39449
Epoch 10, Val Loss: 2.30417
Epoch 11, Val Loss: 2.33508
Epoch 12, Val Loss: 2.37898
Epoch 13, Val Loss: 2.33078
Epoch 14, Val Loss: 2.35412
Epoch 15, Val Loss: 2.28520
Epoch 16, Val Loss: 2.33316
Epoch 17, Val Loss: 2.35131
Epoch 18, Val Loss: 2.28535
Epoch 19, Val Loss: 2.29081
Epoch 20, Val Loss: 2.23398
Epoch 21, Val Loss: 2.25555
Epoch 22, Val Loss: 2.26353
Epoch 23, Val Loss: 2.20388
Epoch 24, Val Loss: 2.33972
Epoch 25, Val Loss: 2.22450
Epoch 26, Val Loss: 2.22505
Epoch 27, Val Loss: 2.19214
Epoch 28, Val Loss: 2.22420
Epoch 29, Val Loss: 2.27342
Epoch 30, Val Loss: 2.26920
Epoch 31, Val Loss: 2.27610
Epoch 32, Val Loss: 2.22337
Epoch 33, Val Loss: 2.23134
Epoch 34, Val Loss: 2.22366
Epoch 35, Val Loss: 2.36262
Epoch 36, Val Loss: 2.18558
Epoch 37, Val Loss: 2.16811
Epoch 38, Val Loss: 2.23953
Epoch 39, Val Loss: 2.24235
Epoch 40, Val Loss: 2.20607
Epoch 41, Val Loss: 2.20547
Epoch 42, Val Loss: 2.21472
Epoch 43, Val Loss: 2.25292
Epoch 44, Val Loss: 2.23944
Epoch 45, Val Loss: 2.20016
Epoch 46, Val Loss: 2.24031
Epoch 47, Val Loss: 2.20252
Epoch 48, Val Loss: 2.23299
Epoch 49, Val Loss: 2.19263
Epoch 50, Val Loss: 2.16820
Epoch 51, Val Loss: 2.18864
Epoch 52, Val Loss: 2.23860
Epoch 53, Val Loss: 2.20040
Epoch 54, Val Loss: 2.22934
Epoch 55, Val Loss: 2.18640
Epoch 56, Val Loss: 2.20056
Epoch 57, Val Loss: 2.20231
Epoch 58, Val Loss: 2.18366
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.09618, 'Log Loss - std': 1.098839579556543} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 26 finished with value: 3.09618 and parameters: {'p_m': 0.41364363415458294, 'alpha': 0.7900711913804557, 'K': 20, 'beta': 1.3219588014773995}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3271716612293081, 'alpha': 3.291483798954161, 'K': 2, 'beta': 2.425124976532225}
Fitted encoder
Epoch 0, Val Loss: 2.33406
Epoch 1, Val Loss: 2.28006
Epoch 2, Val Loss: 2.27797
Epoch 3, Val Loss: 2.25069
Epoch 4, Val Loss: 2.28114
Epoch 5, Val Loss: 2.24934
Epoch 6, Val Loss: 2.28756
Epoch 7, Val Loss: 2.27509
Epoch 8, Val Loss: 2.26453
Epoch 9, Val Loss: 2.27165
Epoch 10, Val Loss: 2.24111
Epoch 11, Val Loss: 2.29116
Epoch 12, Val Loss: 2.24831
Epoch 13, Val Loss: 2.26483
Epoch 14, Val Loss: 2.25237
Epoch 15, Val Loss: 2.24877
Epoch 16, Val Loss: 2.36666
Epoch 17, Val Loss: 2.23317
Epoch 18, Val Loss: 2.26216
Epoch 19, Val Loss: 2.26862
Epoch 20, Val Loss: 2.27293
Epoch 21, Val Loss: 2.27184
Epoch 22, Val Loss: 2.24470
Epoch 23, Val Loss: 2.24126
Epoch 24, Val Loss: 2.26375
Epoch 25, Val Loss: 2.24259
Epoch 26, Val Loss: 2.23678
Epoch 27, Val Loss: 2.23176
Epoch 28, Val Loss: 2.33675
Epoch 29, Val Loss: 2.25378
Epoch 30, Val Loss: 2.22990
Epoch 31, Val Loss: 2.25998
Epoch 32, Val Loss: 2.26662
Epoch 33, Val Loss: 2.24374
Epoch 34, Val Loss: 2.24454
Epoch 35, Val Loss: 2.26677
Epoch 36, Val Loss: 2.24464
Epoch 37, Val Loss: 2.24670
Epoch 38, Val Loss: 2.26632
Epoch 39, Val Loss: 2.24286
Epoch 40, Val Loss: 2.30181
Epoch 41, Val Loss: 2.24226
Epoch 42, Val Loss: 2.24000
Epoch 43, Val Loss: 2.22491
Epoch 44, Val Loss: 2.22838
Epoch 45, Val Loss: 2.22675
Epoch 46, Val Loss: 2.24778
Epoch 47, Val Loss: 2.23864
Epoch 48, Val Loss: 2.26587
Epoch 49, Val Loss: 2.24939
Epoch 50, Val Loss: 2.22971
Epoch 51, Val Loss: 2.24386
Epoch 52, Val Loss: 2.23710
Epoch 53, Val Loss: 2.25019
Epoch 54, Val Loss: 2.23968
Epoch 55, Val Loss: 2.24674
Epoch 56, Val Loss: 2.22918
Epoch 57, Val Loss: 2.26337
Epoch 58, Val Loss: 2.23087
Epoch 59, Val Loss: 2.24786
Epoch 60, Val Loss: 2.22976
Epoch 61, Val Loss: 2.26707
Epoch 62, Val Loss: 2.22621
Epoch 63, Val Loss: 2.22717
Epoch 64, Val Loss: 2.21697
Epoch 65, Val Loss: 2.24559
Epoch 66, Val Loss: 2.21665
Epoch 67, Val Loss: 2.22504
Epoch 68, Val Loss: 2.25628
Epoch 69, Val Loss: 2.23994
Epoch 70, Val Loss: 2.26877
Epoch 71, Val Loss: 2.23802
Epoch 72, Val Loss: 2.25460
Epoch 73, Val Loss: 2.27666
Epoch 74, Val Loss: 2.23424
Epoch 75, Val Loss: 2.22345
Epoch 76, Val Loss: 2.25075
Epoch 77, Val Loss: 2.23331
Epoch 78, Val Loss: 2.24865
Epoch 79, Val Loss: 2.24649
Epoch 80, Val Loss: 2.21584
Epoch 81, Val Loss: 2.23199
Epoch 82, Val Loss: 2.26711
Epoch 83, Val Loss: 2.24047
Epoch 84, Val Loss: 2.22170
Epoch 85, Val Loss: 2.21439
Epoch 86, Val Loss: 2.22279
Epoch 87, Val Loss: 2.24940
Epoch 88, Val Loss: 2.26421
Epoch 89, Val Loss: 2.22472
Epoch 90, Val Loss: 2.23966
Epoch 91, Val Loss: 2.21218
Epoch 92, Val Loss: 2.23942
Epoch 93, Val Loss: 2.21633
Epoch 94, Val Loss: 2.23564
Epoch 95, Val Loss: 2.23013
Epoch 96, Val Loss: 2.29034
Epoch 97, Val Loss: 2.21514
Epoch 98, Val Loss: 2.23048
Epoch 99, Val Loss: 2.25400
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.6404, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3271716612293081, 'alpha': 3.291483798954161, 'K': 2, 'beta': 2.425124976532225}
Fitted encoder
Epoch 0, Val Loss: 2.43302
Epoch 1, Val Loss: 2.33221
Epoch 2, Val Loss: 2.23207
Epoch 3, Val Loss: 2.22471
Epoch 4, Val Loss: 2.21827
Epoch 5, Val Loss: 2.26103
Epoch 6, Val Loss: 2.21062
Epoch 7, Val Loss: 2.21512
Epoch 8, Val Loss: 2.21971
Epoch 9, Val Loss: 2.29820
Epoch 10, Val Loss: 2.25022
Epoch 11, Val Loss: 2.19548
Epoch 12, Val Loss: 2.25393
Epoch 13, Val Loss: 2.20653
Epoch 14, Val Loss: 2.19262
Epoch 15, Val Loss: 2.20241
Epoch 16, Val Loss: 2.21152
Epoch 17, Val Loss: 2.20882
Epoch 18, Val Loss: 2.24905
Epoch 19, Val Loss: 2.22562
Epoch 20, Val Loss: 2.24088
Epoch 21, Val Loss: 2.20970
Epoch 22, Val Loss: 2.23081
Epoch 23, Val Loss: 2.20800
Epoch 24, Val Loss: 2.23286
Epoch 25, Val Loss: 2.38365
Epoch 26, Val Loss: 2.26736
Epoch 27, Val Loss: 2.30101
Epoch 28, Val Loss: 2.22345
Epoch 29, Val Loss: 2.30255
Epoch 30, Val Loss: 2.27499
Epoch 31, Val Loss: 2.22174
Epoch 32, Val Loss: 2.24367
Epoch 33, Val Loss: 2.24590
Epoch 34, Val Loss: 2.20036
Epoch 35, Val Loss: 2.20548
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.71605, 'Log Loss - std': 0.07565} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3271716612293081, 'alpha': 3.291483798954161, 'K': 2, 'beta': 2.425124976532225}
Fitted encoder
Epoch 0, Val Loss: 2.35617
Epoch 1, Val Loss: 2.30862
Epoch 2, Val Loss: 2.34892
Epoch 3, Val Loss: 2.23951
Epoch 4, Val Loss: 2.20089
Epoch 5, Val Loss: 2.23072
Epoch 6, Val Loss: 2.20687
Epoch 7, Val Loss: 2.20292
Epoch 8, Val Loss: 2.22077
Epoch 9, Val Loss: 2.20901
Epoch 10, Val Loss: 2.19079
Epoch 11, Val Loss: 2.21346
Epoch 12, Val Loss: 2.20791
Epoch 13, Val Loss: 2.23054
Epoch 14, Val Loss: 2.20830
Epoch 15, Val Loss: 2.19514
Epoch 16, Val Loss: 2.21514
Epoch 17, Val Loss: 2.24603
Epoch 18, Val Loss: 2.22757
Epoch 19, Val Loss: 2.20085
Epoch 20, Val Loss: 2.19981
Epoch 21, Val Loss: 2.22134
Epoch 22, Val Loss: 2.23345
Epoch 23, Val Loss: 2.18230
Epoch 24, Val Loss: 2.19635
Epoch 25, Val Loss: 2.19029
Epoch 26, Val Loss: 2.22003
Epoch 27, Val Loss: 2.23219
Epoch 28, Val Loss: 2.18390
Epoch 29, Val Loss: 2.25305
Epoch 30, Val Loss: 2.19936
Epoch 31, Val Loss: 2.18330
Epoch 32, Val Loss: 2.18744
Epoch 33, Val Loss: 2.17954
Epoch 34, Val Loss: 2.17047
Epoch 35, Val Loss: 2.19365
Epoch 36, Val Loss: 2.23588
Epoch 37, Val Loss: 2.17748
Epoch 38, Val Loss: 2.18642
Epoch 39, Val Loss: 2.17888
Epoch 40, Val Loss: 2.21386
Epoch 41, Val Loss: 2.19134
Epoch 42, Val Loss: 2.21147
Epoch 43, Val Loss: 2.18114
Epoch 44, Val Loss: 2.19974
Epoch 45, Val Loss: 2.18808
Epoch 46, Val Loss: 2.23114
Epoch 47, Val Loss: 2.23833
Epoch 48, Val Loss: 2.19110
Epoch 49, Val Loss: 2.16830
Epoch 50, Val Loss: 2.18681
Epoch 51, Val Loss: 2.23967
Epoch 52, Val Loss: 2.19819
Epoch 53, Val Loss: 2.17803
Epoch 54, Val Loss: 2.16762
Epoch 55, Val Loss: 2.20467
Epoch 56, Val Loss: 2.17387
Epoch 57, Val Loss: 2.18355
Epoch 58, Val Loss: 2.17369
Epoch 59, Val Loss: 2.18891
Epoch 60, Val Loss: 2.17457
Epoch 61, Val Loss: 2.31583
Epoch 62, Val Loss: 2.26584
Epoch 63, Val Loss: 2.19153
Epoch 64, Val Loss: 2.17649
Epoch 65, Val Loss: 2.17334
Epoch 66, Val Loss: 2.23182
Epoch 67, Val Loss: 2.18329
Epoch 68, Val Loss: 2.18003
Epoch 69, Val Loss: 2.18575
Epoch 70, Val Loss: 2.19640
Epoch 71, Val Loss: 2.24583
Epoch 72, Val Loss: 2.18481
Epoch 73, Val Loss: 2.21322
Epoch 74, Val Loss: 2.19271
Epoch 75, Val Loss: 2.19340
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.5302000000000002, 'Log Loss - std': 0.2699920863037779} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3271716612293081, 'alpha': 3.291483798954161, 'K': 2, 'beta': 2.425124976532225}
Fitted encoder
Epoch 0, Val Loss: 2.20877
Epoch 1, Val Loss: 2.24327
Epoch 2, Val Loss: 2.18600
Epoch 3, Val Loss: 2.20436
Epoch 4, Val Loss: 2.22485
Epoch 5, Val Loss: 2.16930
Epoch 6, Val Loss: 2.16120
Epoch 7, Val Loss: 2.21357
Epoch 8, Val Loss: 2.20088
Epoch 9, Val Loss: 2.18490
Epoch 10, Val Loss: 2.18896
Epoch 11, Val Loss: 2.17128
Epoch 12, Val Loss: 2.18929
Epoch 13, Val Loss: 2.16632
Epoch 14, Val Loss: 2.19454
Epoch 15, Val Loss: 2.24485
Epoch 16, Val Loss: 2.18664
Epoch 17, Val Loss: 2.18479
Epoch 18, Val Loss: 2.24463
Epoch 19, Val Loss: 2.18938
Epoch 20, Val Loss: 2.15269
Epoch 21, Val Loss: 2.15953
Epoch 22, Val Loss: 2.18897
Epoch 23, Val Loss: 2.16284
Epoch 24, Val Loss: 2.17724
Epoch 25, Val Loss: 2.19648
Epoch 26, Val Loss: 2.14783
Epoch 27, Val Loss: 2.17606
Epoch 28, Val Loss: 2.14523
Epoch 29, Val Loss: 2.20332
Epoch 30, Val Loss: 2.16064
Epoch 31, Val Loss: 2.15843
Epoch 32, Val Loss: 2.14680
Epoch 33, Val Loss: 2.15101
Epoch 34, Val Loss: 2.16571
Epoch 35, Val Loss: 2.22886
Epoch 36, Val Loss: 2.19353
Epoch 37, Val Loss: 2.18843
Epoch 38, Val Loss: 2.18374
Epoch 39, Val Loss: 2.14632
Epoch 40, Val Loss: 2.16080
Epoch 41, Val Loss: 2.15541
Epoch 42, Val Loss: 2.20955
Epoch 43, Val Loss: 2.15663
Epoch 44, Val Loss: 2.14041
Epoch 45, Val Loss: 2.21148
Epoch 46, Val Loss: 2.22092
Epoch 47, Val Loss: 2.23550
Epoch 48, Val Loss: 2.22281
Epoch 49, Val Loss: 2.17174
Epoch 50, Val Loss: 2.19826
Epoch 51, Val Loss: 2.18248
Epoch 52, Val Loss: 2.21650
Epoch 53, Val Loss: 2.17212
Epoch 54, Val Loss: 2.16547
Epoch 55, Val Loss: 2.21328
Epoch 56, Val Loss: 2.27068
Epoch 57, Val Loss: 2.17652
Epoch 58, Val Loss: 2.29137
Epoch 59, Val Loss: 2.15822
Epoch 60, Val Loss: 2.25592
Epoch 61, Val Loss: 2.25878
Epoch 62, Val Loss: 2.17857
Epoch 63, Val Loss: 2.20663
Epoch 64, Val Loss: 2.23142
Epoch 65, Val Loss: 2.17677
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.3354500000000002, 'Log Loss - std': 0.4104320680697355} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3271716612293081, 'alpha': 3.291483798954161, 'K': 2, 'beta': 2.425124976532225}
Fitted encoder
Epoch 0, Val Loss: 2.36894
Epoch 1, Val Loss: 2.28624
Epoch 2, Val Loss: 2.28159
Epoch 3, Val Loss: 2.27439
Epoch 4, Val Loss: 2.24517
Epoch 5, Val Loss: 2.24767
Epoch 6, Val Loss: 2.24506
Epoch 7, Val Loss: 2.28492
Epoch 8, Val Loss: 2.23655
Epoch 9, Val Loss: 2.25807
Epoch 10, Val Loss: 2.25498
Epoch 11, Val Loss: 2.24224
Epoch 12, Val Loss: 2.26151
Epoch 13, Val Loss: 2.25214
Epoch 14, Val Loss: 2.27724
Epoch 15, Val Loss: 2.24400
Epoch 16, Val Loss: 2.26332
Epoch 17, Val Loss: 2.23961
Epoch 18, Val Loss: 2.24272
Epoch 19, Val Loss: 2.27396
Epoch 20, Val Loss: 2.24713
Epoch 21, Val Loss: 2.27895
Epoch 22, Val Loss: 2.23690
Epoch 23, Val Loss: 2.25978
Epoch 24, Val Loss: 2.24324
Epoch 25, Val Loss: 2.26240
Epoch 26, Val Loss: 2.24880
Epoch 27, Val Loss: 2.25572
Epoch 28, Val Loss: 2.25141
Epoch 29, Val Loss: 2.23183
Epoch 30, Val Loss: 2.23851
Epoch 31, Val Loss: 2.25036
Epoch 32, Val Loss: 2.24851
Epoch 33, Val Loss: 2.23972
Epoch 34, Val Loss: 2.19827
Epoch 35, Val Loss: 2.19713
Epoch 36, Val Loss: 2.18086
Epoch 37, Val Loss: 2.18118
Epoch 38, Val Loss: 2.18852
Epoch 39, Val Loss: 2.21044
Epoch 40, Val Loss: 2.18326
Epoch 41, Val Loss: 2.19339
Epoch 42, Val Loss: 2.19594
Epoch 43, Val Loss: 2.20256
Epoch 44, Val Loss: 2.18961
Epoch 45, Val Loss: 2.19511
Epoch 46, Val Loss: 2.21459
Epoch 47, Val Loss: 2.18337
Epoch 48, Val Loss: 2.17993
Epoch 49, Val Loss: 2.23857
Epoch 50, Val Loss: 2.21790
Epoch 51, Val Loss: 2.21941
Epoch 52, Val Loss: 2.18987
Epoch 53, Val Loss: 2.18792
Epoch 54, Val Loss: 2.19317
Epoch 55, Val Loss: 2.21839
Epoch 56, Val Loss: 2.19344
Epoch 57, Val Loss: 2.21713
Epoch 58, Val Loss: 2.19909
Epoch 59, Val Loss: 2.21240
Epoch 60, Val Loss: 2.18812
Epoch 61, Val Loss: 2.21196
Epoch 62, Val Loss: 2.17976
Epoch 63, Val Loss: 2.22142
Epoch 64, Val Loss: 2.18280
Epoch 65, Val Loss: 2.18920
Epoch 66, Val Loss: 2.20709
Epoch 67, Val Loss: 2.17531
Epoch 68, Val Loss: 2.17511
Epoch 69, Val Loss: 2.21265
Epoch 70, Val Loss: 2.22417
Epoch 71, Val Loss: 2.19675
Epoch 72, Val Loss: 2.19995
Epoch 73, Val Loss: 2.19707
Epoch 74, Val Loss: 2.20011
Epoch 75, Val Loss: 2.21645
Epoch 76, Val Loss: 2.28755
Epoch 77, Val Loss: 2.19291
Epoch 78, Val Loss: 2.23133
Epoch 79, Val Loss: 2.24983
Epoch 80, Val Loss: 2.18189
Epoch 81, Val Loss: 2.19731
Epoch 82, Val Loss: 2.24721
Epoch 83, Val Loss: 2.18766
Epoch 84, Val Loss: 2.19449
Epoch 85, Val Loss: 2.19447
Epoch 86, Val Loss: 2.19188
Epoch 87, Val Loss: 2.19309
Epoch 88, Val Loss: 2.21425
Epoch 89, Val Loss: 2.19399
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.30118, 'Log Loss - std': 0.3734452002637067} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 27 finished with value: 2.30118 and parameters: {'p_m': 0.3271716612293081, 'alpha': 3.291483798954161, 'K': 2, 'beta': 2.425124976532225}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2509804566470245, 'alpha': 1.9261761194161995, 'K': 3, 'beta': 0.7497867523612385}
Fitted encoder
Epoch 0, Val Loss: 2.68441
Epoch 1, Val Loss: 2.68403
Epoch 2, Val Loss: 2.68249
Epoch 3, Val Loss: 2.68249
Epoch 4, Val Loss: 2.68249
Epoch 5, Val Loss: 2.68249
Epoch 6, Val Loss: 2.68249
Epoch 7, Val Loss: 2.68249
Epoch 8, Val Loss: 2.68249
Epoch 9, Val Loss: 2.68249
Epoch 10, Val Loss: 2.68249
Epoch 11, Val Loss: 2.68249
Epoch 12, Val Loss: 2.68249
Epoch 13, Val Loss: 2.68249
Epoch 14, Val Loss: 2.66241
Epoch 15, Val Loss: 2.68396
Epoch 16, Val Loss: 2.68396
Epoch 17, Val Loss: 2.68396
Epoch 18, Val Loss: 2.68396
Epoch 19, Val Loss: 2.68396
Epoch 20, Val Loss: 2.68396
Epoch 21, Val Loss: 2.68396
Epoch 22, Val Loss: 2.68396
Epoch 23, Val Loss: 2.68396
Epoch 24, Val Loss: 2.68396
Epoch 25, Val Loss: 2.68396
Epoch 26, Val Loss: 2.68396
Epoch 27, Val Loss: 2.68396
Epoch 28, Val Loss: 2.50580
Epoch 29, Val Loss: 2.49105
Epoch 30, Val Loss: 2.47536
Epoch 31, Val Loss: 2.47144
Epoch 32, Val Loss: 2.48358
Epoch 33, Val Loss: 2.48706
Epoch 34, Val Loss: 2.46742
Epoch 35, Val Loss: 2.49442
Epoch 36, Val Loss: 2.45401
Epoch 37, Val Loss: 2.46252
Epoch 38, Val Loss: 2.46434
Epoch 39, Val Loss: 2.46183
Epoch 40, Val Loss: 2.49236
Epoch 41, Val Loss: 2.45115
Epoch 42, Val Loss: 2.45211
Epoch 43, Val Loss: 2.40582
Epoch 44, Val Loss: 2.46032
Epoch 45, Val Loss: 2.38666
Epoch 46, Val Loss: 2.35415
Epoch 47, Val Loss: 2.37896
Epoch 48, Val Loss: 2.36388
Epoch 49, Val Loss: 2.36448
Epoch 50, Val Loss: 2.46050
Epoch 51, Val Loss: 2.49698
Epoch 52, Val Loss: 2.46163
Epoch 53, Val Loss: 2.41741
Epoch 54, Val Loss: 2.44223
Epoch 55, Val Loss: 2.39925
Epoch 56, Val Loss: 2.46236
Epoch 57, Val Loss: 2.40368
Epoch 58, Val Loss: 2.44234
Epoch 59, Val Loss: 2.40223
Epoch 60, Val Loss: 2.44651
Epoch 61, Val Loss: 2.36442
Epoch 62, Val Loss: 2.50072
Epoch 63, Val Loss: 2.36738
Epoch 64, Val Loss: 2.38883
Epoch 65, Val Loss: 2.36971
Epoch 66, Val Loss: 2.43051
Epoch 67, Val Loss: 2.36875
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.9728, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2509804566470245, 'alpha': 1.9261761194161995, 'K': 3, 'beta': 0.7497867523612385}
Fitted encoder
Epoch 0, Val Loss: 2.67504
Epoch 1, Val Loss: 2.67504
Epoch 2, Val Loss: 2.67504
Epoch 3, Val Loss: 2.67504
Epoch 4, Val Loss: 2.67504
Epoch 5, Val Loss: 2.68497
Epoch 6, Val Loss: 2.68497
Epoch 7, Val Loss: 2.68497
Epoch 8, Val Loss: 2.68497
Epoch 9, Val Loss: 2.68497
Epoch 10, Val Loss: 2.68543
Epoch 11, Val Loss: 2.68543
Epoch 12, Val Loss: 2.68543
Epoch 13, Val Loss: 2.68543
Epoch 14, Val Loss: 2.56087
Epoch 15, Val Loss: 2.59492
Epoch 16, Val Loss: 2.49578
Epoch 17, Val Loss: 2.50357
Epoch 18, Val Loss: 2.50155
Epoch 19, Val Loss: 2.49952
Epoch 20, Val Loss: 2.50385
Epoch 21, Val Loss: 2.49984
Epoch 22, Val Loss: 2.52448
Epoch 23, Val Loss: 2.51856
Epoch 24, Val Loss: 2.43805
Epoch 25, Val Loss: 2.45417
Epoch 26, Val Loss: 2.44243
Epoch 27, Val Loss: 2.45284
Epoch 28, Val Loss: 2.45521
Epoch 29, Val Loss: 2.44969
Epoch 30, Val Loss: 2.46826
Epoch 31, Val Loss: 2.46527
Epoch 32, Val Loss: 2.45620
Epoch 33, Val Loss: 2.45655
Epoch 34, Val Loss: 2.47881
Epoch 35, Val Loss: 2.46274
Epoch 36, Val Loss: 2.45140
Epoch 37, Val Loss: 2.45719
Epoch 38, Val Loss: 2.44234
Epoch 39, Val Loss: 2.46836
Epoch 40, Val Loss: 2.44979
Epoch 41, Val Loss: 2.40399
Epoch 42, Val Loss: 2.43367
Epoch 43, Val Loss: 2.40068
Epoch 44, Val Loss: 2.30861
Epoch 45, Val Loss: 2.31851
Epoch 46, Val Loss: 2.26588
Epoch 47, Val Loss: 2.20990
Epoch 48, Val Loss: 2.23337
Epoch 49, Val Loss: 2.17380
Epoch 50, Val Loss: 2.17112
Epoch 51, Val Loss: 2.16054
Epoch 52, Val Loss: 2.15773
Epoch 53, Val Loss: 2.14966
Epoch 54, Val Loss: 2.14143
Epoch 55, Val Loss: 2.25246
Epoch 56, Val Loss: 2.13894
Epoch 57, Val Loss: 2.16633
Epoch 58, Val Loss: 2.31591
Epoch 59, Val Loss: 2.13517
Epoch 60, Val Loss: 2.13461
Epoch 61, Val Loss: 2.12710
Epoch 62, Val Loss: 2.15559
Epoch 63, Val Loss: 2.17749
Epoch 64, Val Loss: 2.17851
Epoch 65, Val Loss: 2.20889
Epoch 66, Val Loss: 2.17872
Epoch 67, Val Loss: 2.15868
Epoch 68, Val Loss: 2.23028
Epoch 69, Val Loss: 2.16159
Epoch 70, Val Loss: 2.29856
Epoch 71, Val Loss: 2.15456
Epoch 72, Val Loss: 2.24785
Epoch 73, Val Loss: 2.13385
Epoch 74, Val Loss: 2.25876
Epoch 75, Val Loss: 2.13065
Epoch 76, Val Loss: 2.15083
Epoch 77, Val Loss: 2.14703
Epoch 78, Val Loss: 2.16823
Epoch 79, Val Loss: 2.16161
Epoch 80, Val Loss: 2.12655
Epoch 81, Val Loss: 2.31225
Epoch 82, Val Loss: 2.19053
Epoch 83, Val Loss: 2.23298
Epoch 84, Val Loss: 2.18509
Epoch 85, Val Loss: 2.17846
Epoch 86, Val Loss: 2.18517
Epoch 87, Val Loss: 2.16878
Epoch 88, Val Loss: 2.19775
Epoch 89, Val Loss: 2.20907
Epoch 90, Val Loss: 2.15916
Epoch 91, Val Loss: 2.13777
Epoch 92, Val Loss: 2.19184
Epoch 93, Val Loss: 2.16883
Epoch 94, Val Loss: 2.18261
Epoch 95, Val Loss: 2.17056
Epoch 96, Val Loss: 2.16502
Epoch 97, Val Loss: 2.17313
Epoch 98, Val Loss: 2.18469
Epoch 99, Val Loss: 2.14280
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.72725, 'Log Loss - std': 2.24555} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2509804566470245, 'alpha': 1.9261761194161995, 'K': 3, 'beta': 0.7497867523612385}
Fitted encoder
Epoch 0, Val Loss: 2.67707
Epoch 1, Val Loss: 2.67707
Epoch 2, Val Loss: 2.67707
Epoch 3, Val Loss: 2.67707
Epoch 4, Val Loss: 2.67707
Epoch 5, Val Loss: 2.67707
Epoch 6, Val Loss: 2.68479
Epoch 7, Val Loss: 2.68479
Epoch 8, Val Loss: 2.68479
Epoch 9, Val Loss: 2.68479
Epoch 10, Val Loss: 2.68479
Epoch 11, Val Loss: 2.68479
Epoch 12, Val Loss: 2.68479
Epoch 13, Val Loss: 2.68479
Epoch 14, Val Loss: 2.38815
Epoch 15, Val Loss: 2.35257
Epoch 16, Val Loss: 2.36824
Epoch 17, Val Loss: 2.35435
Epoch 18, Val Loss: 2.33722
Epoch 19, Val Loss: 2.34203
Epoch 20, Val Loss: 2.31002
Epoch 21, Val Loss: 2.28865
Epoch 22, Val Loss: 2.31213
Epoch 23, Val Loss: 2.33960
Epoch 24, Val Loss: 2.31447
Epoch 25, Val Loss: 2.32968
Epoch 26, Val Loss: 2.33681
Epoch 27, Val Loss: 2.28392
Epoch 28, Val Loss: 2.28336
Epoch 29, Val Loss: 2.27929
Epoch 30, Val Loss: 2.32732
Epoch 31, Val Loss: 2.32103
Epoch 32, Val Loss: 2.27596
Epoch 33, Val Loss: 2.27863
Epoch 34, Val Loss: 2.25316
Epoch 35, Val Loss: 2.25528
Epoch 36, Val Loss: 2.25993
Epoch 37, Val Loss: 2.29780
Epoch 38, Val Loss: 2.29269
Epoch 39, Val Loss: 2.27730
Epoch 40, Val Loss: 2.32326
Epoch 41, Val Loss: 2.23518
Epoch 42, Val Loss: 2.26060
Epoch 43, Val Loss: 2.24673
Epoch 44, Val Loss: 2.28312
Epoch 45, Val Loss: 2.25964
Epoch 46, Val Loss: 2.27236
Epoch 47, Val Loss: 2.30331
Epoch 48, Val Loss: 2.26821
Epoch 49, Val Loss: 2.31897
Epoch 50, Val Loss: 2.26449
Epoch 51, Val Loss: 2.27908
Epoch 52, Val Loss: 2.28470
Epoch 53, Val Loss: 2.27700
Epoch 54, Val Loss: 2.26478
Epoch 55, Val Loss: 2.24004
Epoch 56, Val Loss: 2.24425
Epoch 57, Val Loss: 2.29001
Epoch 58, Val Loss: 2.36908
Epoch 59, Val Loss: 2.28436
Epoch 60, Val Loss: 2.23904
Epoch 61, Val Loss: 2.27362
Epoch 62, Val Loss: 2.26539
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.4665666666666666, 'Log Loss - std': 1.8701804196981164} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2509804566470245, 'alpha': 1.9261761194161995, 'K': 3, 'beta': 0.7497867523612385}
Fitted encoder
Epoch 0, Val Loss: 2.44968
Epoch 1, Val Loss: 2.39434
Epoch 2, Val Loss: 2.37905
Epoch 3, Val Loss: 2.43506
Epoch 4, Val Loss: 2.42802
Epoch 5, Val Loss: 2.48117
Epoch 6, Val Loss: 2.45447
Epoch 7, Val Loss: 2.36553
Epoch 8, Val Loss: 2.41206
Epoch 9, Val Loss: 2.35385
Epoch 10, Val Loss: 2.34823
Epoch 11, Val Loss: 2.37995
Epoch 12, Val Loss: 2.43223
Epoch 13, Val Loss: 2.41232
Epoch 14, Val Loss: 2.33989
Epoch 15, Val Loss: 2.34740
Epoch 16, Val Loss: 2.36473
Epoch 17, Val Loss: 2.38716
Epoch 18, Val Loss: 2.39667
Epoch 19, Val Loss: 2.37053
Epoch 20, Val Loss: 2.38726
Epoch 21, Val Loss: 2.36559
Epoch 22, Val Loss: 2.33833
Epoch 23, Val Loss: 2.32488
Epoch 24, Val Loss: 2.32819
Epoch 25, Val Loss: 2.32925
Epoch 26, Val Loss: 2.32498
Epoch 27, Val Loss: 2.36485
Epoch 28, Val Loss: 2.36308
Epoch 29, Val Loss: 2.34021
Epoch 30, Val Loss: 2.46706
Epoch 31, Val Loss: 2.36102
Epoch 32, Val Loss: 2.34720
Epoch 33, Val Loss: 2.42190
Epoch 34, Val Loss: 2.34713
Epoch 35, Val Loss: 2.37421
Epoch 36, Val Loss: 2.32148
Epoch 37, Val Loss: 2.30974
Epoch 38, Val Loss: 2.28504
Epoch 39, Val Loss: 2.23743
Epoch 40, Val Loss: 2.26867
Epoch 41, Val Loss: 2.28318
Epoch 42, Val Loss: 2.30545
Epoch 43, Val Loss: 2.31318
Epoch 44, Val Loss: 2.25440
Epoch 45, Val Loss: 2.27746
Epoch 46, Val Loss: 2.17397
Epoch 47, Val Loss: 2.21139
Epoch 48, Val Loss: 2.20541
Epoch 49, Val Loss: 2.29781
Epoch 50, Val Loss: 2.17877
Epoch 51, Val Loss: 2.19582
Epoch 52, Val Loss: 2.18888
Epoch 53, Val Loss: 2.19386
Epoch 54, Val Loss: 2.22398
Epoch 55, Val Loss: 2.17502
Epoch 56, Val Loss: 2.18376
Epoch 57, Val Loss: 2.21983
Epoch 58, Val Loss: 2.19814
Epoch 59, Val Loss: 2.25409
Epoch 60, Val Loss: 2.23884
Epoch 61, Val Loss: 2.19868
Epoch 62, Val Loss: 2.22003
Epoch 63, Val Loss: 2.27091
Epoch 64, Val Loss: 2.19687
Epoch 65, Val Loss: 2.20721
Epoch 66, Val Loss: 2.19565
Epoch 67, Val Loss: 2.19821
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.13805, 'Log Loss - std': 1.7166684894003268} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2509804566470245, 'alpha': 1.9261761194161995, 'K': 3, 'beta': 0.7497867523612385}
Fitted encoder
Epoch 0, Val Loss: 2.67098
Epoch 1, Val Loss: 2.68194
Epoch 2, Val Loss: 2.68194
Epoch 3, Val Loss: 2.68194
Epoch 4, Val Loss: 2.68194
Epoch 5, Val Loss: 2.68194
Epoch 6, Val Loss: 2.68194
Epoch 7, Val Loss: 2.68194
Epoch 8, Val Loss: 2.68194
Epoch 9, Val Loss: 2.68194
Epoch 10, Val Loss: 2.68194
Epoch 11, Val Loss: 2.68194
Epoch 12, Val Loss: 2.68194
Epoch 13, Val Loss: 2.68194
Epoch 14, Val Loss: 2.68194
Epoch 15, Val Loss: 2.68194
Epoch 16, Val Loss: 2.68194
Epoch 17, Val Loss: 2.68194
Epoch 18, Val Loss: 2.68194
Epoch 19, Val Loss: 2.68194
Epoch 20, Val Loss: 2.68194
Epoch 21, Val Loss: 2.68194
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.61684, 'Log Loss - std': 3.33239253666191} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 28 finished with value: 4.61684 and parameters: {'p_m': 0.2509804566470245, 'alpha': 1.9261761194161995, 'K': 3, 'beta': 0.7497867523612385}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19432293192142366, 'alpha': 0.9555223510932506, 'K': 15, 'beta': 7.854667519642264}
Fitted encoder
Epoch 0, Val Loss: 2.30380
Epoch 1, Val Loss: 2.28277
Epoch 2, Val Loss: 2.21778
Epoch 3, Val Loss: 2.39612
Epoch 4, Val Loss: 2.21755
Epoch 5, Val Loss: 2.20862
Epoch 6, Val Loss: 2.20184
Epoch 7, Val Loss: 2.18346
Epoch 8, Val Loss: 2.19496
Epoch 9, Val Loss: 2.19029
Epoch 10, Val Loss: 2.24600
Epoch 11, Val Loss: 2.19574
Epoch 12, Val Loss: 2.19247
Epoch 13, Val Loss: 2.23531
Epoch 14, Val Loss: 2.18492
Epoch 15, Val Loss: 2.18830
Epoch 16, Val Loss: 2.16361
Epoch 17, Val Loss: 2.19730
Epoch 18, Val Loss: 2.25923
Epoch 19, Val Loss: 2.18343
Epoch 20, Val Loss: 2.18181
Epoch 21, Val Loss: 2.18886
Epoch 22, Val Loss: 2.18469
Epoch 23, Val Loss: 2.20685
Epoch 24, Val Loss: 2.22395
Epoch 25, Val Loss: 2.19374
Epoch 26, Val Loss: 2.17460
Epoch 27, Val Loss: 2.17917
Epoch 28, Val Loss: 2.20616
Epoch 29, Val Loss: 2.22250
Epoch 30, Val Loss: 2.18621
Epoch 31, Val Loss: 2.19892
Epoch 32, Val Loss: 2.17803
Epoch 33, Val Loss: 2.19739
Epoch 34, Val Loss: 2.18510
Epoch 35, Val Loss: 2.22012
Epoch 36, Val Loss: 2.19260
Epoch 37, Val Loss: 2.18735
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.1338, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19432293192142366, 'alpha': 0.9555223510932506, 'K': 15, 'beta': 7.854667519642264}
Fitted encoder
Epoch 0, Val Loss: 2.30384
Epoch 1, Val Loss: 2.27161
Epoch 2, Val Loss: 2.26106
Epoch 3, Val Loss: 2.26008
Epoch 4, Val Loss: 2.27453
Epoch 5, Val Loss: 2.29470
Epoch 6, Val Loss: 2.26624
Epoch 7, Val Loss: 2.24314
Epoch 8, Val Loss: 2.23599
Epoch 9, Val Loss: 2.23856
Epoch 10, Val Loss: 2.23663
Epoch 11, Val Loss: 2.23924
Epoch 12, Val Loss: 2.26078
Epoch 13, Val Loss: 2.23709
Epoch 14, Val Loss: 2.22415
Epoch 15, Val Loss: 2.22872
Epoch 16, Val Loss: 2.21530
Epoch 17, Val Loss: 2.26227
Epoch 18, Val Loss: 2.22982
Epoch 19, Val Loss: 2.22937
Epoch 20, Val Loss: 2.24269
Epoch 21, Val Loss: 2.23574
Epoch 22, Val Loss: 2.21993
Epoch 23, Val Loss: 2.23850
Epoch 24, Val Loss: 2.24037
Epoch 25, Val Loss: 2.22443
Epoch 26, Val Loss: 2.27863
Epoch 27, Val Loss: 2.23693
Epoch 28, Val Loss: 2.22803
Epoch 29, Val Loss: 2.23289
Epoch 30, Val Loss: 2.22288
Epoch 31, Val Loss: 2.22597
Epoch 32, Val Loss: 2.23408
Epoch 33, Val Loss: 2.23105
Epoch 34, Val Loss: 2.22600
Epoch 35, Val Loss: 2.22985
Epoch 36, Val Loss: 2.23011
Epoch 37, Val Loss: 2.22271
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.04525, 'Log Loss - std': 0.08854999999999995} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19432293192142366, 'alpha': 0.9555223510932506, 'K': 15, 'beta': 7.854667519642264}
Fitted encoder
Epoch 0, Val Loss: 2.29148
Epoch 1, Val Loss: 2.27508
Epoch 2, Val Loss: 2.26244
Epoch 3, Val Loss: 2.24614
Epoch 4, Val Loss: 2.26289
Epoch 5, Val Loss: 2.26335
Epoch 6, Val Loss: 2.25411
Epoch 7, Val Loss: 2.24640
Epoch 8, Val Loss: 2.22993
Epoch 9, Val Loss: 2.25405
Epoch 10, Val Loss: 2.24208
Epoch 11, Val Loss: 2.23524
Epoch 12, Val Loss: 2.25249
Epoch 13, Val Loss: 2.22333
Epoch 14, Val Loss: 2.24743
Epoch 15, Val Loss: 2.22942
Epoch 16, Val Loss: 2.23869
Epoch 17, Val Loss: 2.23566
Epoch 18, Val Loss: 2.21722
Epoch 19, Val Loss: 2.22650
Epoch 20, Val Loss: 2.22611
Epoch 21, Val Loss: 2.22622
Epoch 22, Val Loss: 2.24272
Epoch 23, Val Loss: 2.21848
Epoch 24, Val Loss: 2.23695
Epoch 25, Val Loss: 2.22859
Epoch 26, Val Loss: 2.23638
Epoch 27, Val Loss: 2.23606
Epoch 28, Val Loss: 2.24937
Epoch 29, Val Loss: 2.24427
Epoch 30, Val Loss: 2.23285
Epoch 31, Val Loss: 2.23248
Epoch 32, Val Loss: 2.21293
Epoch 33, Val Loss: 2.21330
Epoch 34, Val Loss: 2.21320
Epoch 35, Val Loss: 2.21991
Epoch 36, Val Loss: 2.21458
Epoch 37, Val Loss: 2.21237
Epoch 38, Val Loss: 2.19090
Epoch 39, Val Loss: 2.20014
Epoch 40, Val Loss: 2.22336
Epoch 41, Val Loss: 2.20788
Epoch 42, Val Loss: 2.20232
Epoch 43, Val Loss: 2.23123
Epoch 44, Val Loss: 2.20103
Epoch 45, Val Loss: 2.23265
Epoch 46, Val Loss: 2.20670
Epoch 47, Val Loss: 2.24476
Epoch 48, Val Loss: 2.21595
Epoch 49, Val Loss: 2.22091
Epoch 50, Val Loss: 2.18335
Epoch 51, Val Loss: 2.19787
Epoch 52, Val Loss: 2.20459
Epoch 53, Val Loss: 2.27724
Epoch 54, Val Loss: 2.17884
Epoch 55, Val Loss: 2.17691
Epoch 56, Val Loss: 2.18291
Epoch 57, Val Loss: 2.18265
Epoch 58, Val Loss: 2.18159
Epoch 59, Val Loss: 2.16758
Epoch 60, Val Loss: 2.19037
Epoch 61, Val Loss: 2.20753
Epoch 62, Val Loss: 2.26458
Epoch 63, Val Loss: 2.21907
Epoch 64, Val Loss: 2.17243
Epoch 65, Val Loss: 2.20244
Epoch 66, Val Loss: 2.17825
Epoch 67, Val Loss: 2.17574
Epoch 68, Val Loss: 2.20595
Epoch 69, Val Loss: 2.22588
Epoch 70, Val Loss: 2.19165
Epoch 71, Val Loss: 2.18149
Epoch 72, Val Loss: 2.19104
Epoch 73, Val Loss: 2.16810
Epoch 74, Val Loss: 2.17048
Epoch 75, Val Loss: 2.19103
Epoch 76, Val Loss: 2.21693
Epoch 77, Val Loss: 2.21227
Epoch 78, Val Loss: 2.17537
Epoch 79, Val Loss: 2.22504
Epoch 80, Val Loss: 2.19041
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.0505666666666666, 'Log Loss - std': 0.07269068410433038} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19432293192142366, 'alpha': 0.9555223510932506, 'K': 15, 'beta': 7.854667519642264}
Fitted encoder
Epoch 0, Val Loss: 2.28459
Epoch 1, Val Loss: 2.25948
Epoch 2, Val Loss: 2.25019
Epoch 3, Val Loss: 2.25854
Epoch 4, Val Loss: 2.22929
Epoch 5, Val Loss: 2.24844
Epoch 6, Val Loss: 2.28800
Epoch 7, Val Loss: 2.22031
Epoch 8, Val Loss: 2.22862
Epoch 9, Val Loss: 2.23309
Epoch 10, Val Loss: 2.22991
Epoch 11, Val Loss: 2.21060
Epoch 12, Val Loss: 2.20418
Epoch 13, Val Loss: 2.21159
Epoch 14, Val Loss: 2.17861
Epoch 15, Val Loss: 2.21655
Epoch 16, Val Loss: 2.18936
Epoch 17, Val Loss: 2.16200
Epoch 18, Val Loss: 2.15876
Epoch 19, Val Loss: 2.18903
Epoch 20, Val Loss: 2.19457
Epoch 21, Val Loss: 2.15163
Epoch 22, Val Loss: 2.15648
Epoch 23, Val Loss: 2.16041
Epoch 24, Val Loss: 2.19154
Epoch 25, Val Loss: 2.15149
Epoch 26, Val Loss: 2.16247
Epoch 27, Val Loss: 2.17554
Epoch 28, Val Loss: 2.16992
Epoch 29, Val Loss: 2.16381
Epoch 30, Val Loss: 2.21240
Epoch 31, Val Loss: 2.18123
Epoch 32, Val Loss: 2.16949
Epoch 33, Val Loss: 2.15667
Epoch 34, Val Loss: 2.16645
Epoch 35, Val Loss: 2.17620
Epoch 36, Val Loss: 2.17830
Epoch 37, Val Loss: 2.16819
Epoch 38, Val Loss: 2.18408
Epoch 39, Val Loss: 2.17340
Epoch 40, Val Loss: 2.15243
Epoch 41, Val Loss: 2.18025
Epoch 42, Val Loss: 2.17843
Epoch 43, Val Loss: 2.22380
Epoch 44, Val Loss: 2.14420
Epoch 45, Val Loss: 2.15827
Epoch 46, Val Loss: 2.14883
Epoch 47, Val Loss: 2.14895
Epoch 48, Val Loss: 2.15608
Epoch 49, Val Loss: 2.16895
Epoch 50, Val Loss: 2.15469
Epoch 51, Val Loss: 2.18583
Epoch 52, Val Loss: 2.16467
Epoch 53, Val Loss: 2.16448
Epoch 54, Val Loss: 2.15988
Epoch 55, Val Loss: 2.15524
Epoch 56, Val Loss: 2.17723
Epoch 57, Val Loss: 2.17802
Epoch 58, Val Loss: 2.13500
Epoch 59, Val Loss: 2.19245
Epoch 60, Val Loss: 2.16468
Epoch 61, Val Loss: 2.15706
Epoch 62, Val Loss: 2.20542
Epoch 63, Val Loss: 2.17326
Epoch 64, Val Loss: 2.17121
Epoch 65, Val Loss: 2.13737
Epoch 66, Val Loss: 2.14630
Epoch 67, Val Loss: 2.16241
Epoch 68, Val Loss: 2.18959
Epoch 69, Val Loss: 2.14889
Epoch 70, Val Loss: 2.19052
Epoch 71, Val Loss: 2.14851
Epoch 72, Val Loss: 2.15487
Epoch 73, Val Loss: 2.16249
Epoch 74, Val Loss: 2.14688
Epoch 75, Val Loss: 2.15816
Epoch 76, Val Loss: 2.16418
Epoch 77, Val Loss: 2.13820
Epoch 78, Val Loss: 2.16992
Epoch 79, Val Loss: 2.14601
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.060025, 'Log Loss - std': 0.0650486884956184} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19432293192142366, 'alpha': 0.9555223510932506, 'K': 15, 'beta': 7.854667519642264}
Fitted encoder
Epoch 0, Val Loss: 2.34497
Epoch 1, Val Loss: 2.32101
Epoch 2, Val Loss: 2.30038
Epoch 3, Val Loss: 2.33839
Epoch 4, Val Loss: 2.29386
Epoch 5, Val Loss: 2.31376
Epoch 6, Val Loss: 2.27639
Epoch 7, Val Loss: 2.25726
Epoch 8, Val Loss: 2.23999
Epoch 9, Val Loss: 2.24902
Epoch 10, Val Loss: 2.25533
Epoch 11, Val Loss: 2.22452
Epoch 12, Val Loss: 2.22311
Epoch 13, Val Loss: 2.24341
Epoch 14, Val Loss: 2.24418
Epoch 15, Val Loss: 2.22749
Epoch 16, Val Loss: 2.22464
Epoch 17, Val Loss: 2.17884
Epoch 18, Val Loss: 2.19813
Epoch 19, Val Loss: 2.18058
Epoch 20, Val Loss: 2.18498
Epoch 21, Val Loss: 2.16205
Epoch 22, Val Loss: 2.15771
Epoch 23, Val Loss: 2.18769
Epoch 24, Val Loss: 2.16684
Epoch 25, Val Loss: 2.17249
Epoch 26, Val Loss: 2.16478
Epoch 27, Val Loss: 2.14282
Epoch 28, Val Loss: 2.16306
Epoch 29, Val Loss: 2.16383
Epoch 30, Val Loss: 2.17308
Epoch 31, Val Loss: 2.17217
Epoch 32, Val Loss: 2.18838
Epoch 33, Val Loss: 2.20209
Epoch 34, Val Loss: 2.16753
Epoch 35, Val Loss: 2.17693
Epoch 36, Val Loss: 2.19150
Epoch 37, Val Loss: 2.16077
Epoch 38, Val Loss: 2.18448
Epoch 39, Val Loss: 2.17127
Epoch 40, Val Loss: 2.22101
Epoch 41, Val Loss: 2.15264
Epoch 42, Val Loss: 2.15936
Epoch 43, Val Loss: 2.14840
Epoch 44, Val Loss: 2.16536
Epoch 45, Val Loss: 2.14854
Epoch 46, Val Loss: 2.20976
Epoch 47, Val Loss: 2.18326
Epoch 48, Val Loss: 2.20288
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.0818400000000001, 'Log Loss - std': 0.07272305274120443} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 29 finished with value: 1.0818400000000001 and parameters: {'p_m': 0.19432293192142366, 'alpha': 0.9555223510932506, 'K': 15, 'beta': 7.854667519642264}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.48080581158290875, 'alpha': 4.994803529992808, 'K': 10, 'beta': 0.15012139707063898}
Fitted encoder
Epoch 0, Val Loss: 2.68396
Epoch 1, Val Loss: 2.68396
Epoch 2, Val Loss: 2.68396
Epoch 3, Val Loss: 2.68396
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.68396
Epoch 8, Val Loss: 2.68396
Epoch 9, Val Loss: 2.68396
Epoch 10, Val Loss: 2.68396
Epoch 11, Val Loss: 2.68396
Epoch 12, Val Loss: 2.68396
Epoch 13, Val Loss: 2.68396
Epoch 14, Val Loss: 2.68396
Epoch 15, Val Loss: 2.68396
Epoch 16, Val Loss: 2.68396
Epoch 17, Val Loss: 2.68396
Epoch 18, Val Loss: 2.68396
Epoch 19, Val Loss: 2.68396
Epoch 20, Val Loss: 2.68396
Epoch 21, Val Loss: 2.68396
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6902, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.48080581158290875, 'alpha': 4.994803529992808, 'K': 10, 'beta': 0.15012139707063898}
Fitted encoder
Epoch 0, Val Loss: 2.68368
Epoch 1, Val Loss: 2.68368
Epoch 2, Val Loss: 2.68368
Epoch 3, Val Loss: 2.68368
Epoch 4, Val Loss: 2.68368
Epoch 5, Val Loss: 2.68019
Epoch 6, Val Loss: 2.68028
Epoch 7, Val Loss: 2.68745
Epoch 8, Val Loss: 2.68745
Epoch 9, Val Loss: 2.68745
Epoch 10, Val Loss: 2.68745
Epoch 11, Val Loss: 2.68745
Epoch 12, Val Loss: 2.68745
Epoch 13, Val Loss: 2.68745
Epoch 14, Val Loss: 2.68745
Epoch 15, Val Loss: 2.68745
Epoch 16, Val Loss: 2.68102
Epoch 17, Val Loss: 2.68102
Epoch 18, Val Loss: 2.68102
Epoch 19, Val Loss: 2.68102
Epoch 20, Val Loss: 2.68102
Epoch 21, Val Loss: 2.68102
Epoch 22, Val Loss: 2.68102
Epoch 23, Val Loss: 2.68102
Epoch 24, Val Loss: 2.68102
Epoch 25, Val Loss: 2.68102
Epoch 26, Val Loss: 2.68102
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6683, 'Log Loss - std': 0.021900000000000475} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.48080581158290875, 'alpha': 4.994803529992808, 'K': 10, 'beta': 0.15012139707063898}
Fitted encoder
Epoch 0, Val Loss: 2.68524
Epoch 1, Val Loss: 2.68782
Epoch 2, Val Loss: 2.68782
Epoch 3, Val Loss: 2.68782
Epoch 4, Val Loss: 2.68782
Epoch 5, Val Loss: 2.68479
Epoch 6, Val Loss: 2.68479
Epoch 7, Val Loss: 2.68479
Epoch 8, Val Loss: 2.68479
Epoch 9, Val Loss: 2.68479
Epoch 10, Val Loss: 2.68479
Epoch 11, Val Loss: 2.68479
Epoch 12, Val Loss: 2.51713
Epoch 13, Val Loss: 2.53424
Epoch 14, Val Loss: 2.52286
Epoch 15, Val Loss: 2.46952
Epoch 16, Val Loss: 2.47678
Epoch 17, Val Loss: 2.45857
Epoch 18, Val Loss: 2.47899
Epoch 19, Val Loss: 2.48175
Epoch 20, Val Loss: 2.45505
Epoch 21, Val Loss: 2.47447
Epoch 22, Val Loss: 2.44144
Epoch 23, Val Loss: 2.45572
Epoch 24, Val Loss: 2.43287
Epoch 25, Val Loss: 2.59678
Epoch 26, Val Loss: 2.41364
Epoch 27, Val Loss: 2.40353
Epoch 28, Val Loss: 2.43398
Epoch 29, Val Loss: 2.43464
Epoch 30, Val Loss: 2.43427
Epoch 31, Val Loss: 2.45080
Epoch 32, Val Loss: 2.45379
Epoch 33, Val Loss: 2.41331
Epoch 34, Val Loss: 2.43560
Epoch 35, Val Loss: 2.47234
Epoch 36, Val Loss: 2.37716
Epoch 37, Val Loss: 2.45111
Epoch 38, Val Loss: 2.38618
Epoch 39, Val Loss: 2.46495
Epoch 40, Val Loss: 2.38821
Epoch 41, Val Loss: 2.41602
Epoch 42, Val Loss: 2.40158
Epoch 43, Val Loss: 2.37505
Epoch 44, Val Loss: 2.40771
Epoch 45, Val Loss: 2.41544
Epoch 46, Val Loss: 2.35764
Epoch 47, Val Loss: 2.32975
Epoch 48, Val Loss: 2.39118
Epoch 49, Val Loss: 2.33256
Epoch 50, Val Loss: 2.34987
Epoch 51, Val Loss: 2.37961
Epoch 52, Val Loss: 2.37346
Epoch 53, Val Loss: 2.36982
Epoch 54, Val Loss: 2.36147
Epoch 55, Val Loss: 2.33873
Epoch 56, Val Loss: 2.32578
Epoch 57, Val Loss: 2.34140
Epoch 58, Val Loss: 2.37882
Epoch 59, Val Loss: 2.35305
Epoch 60, Val Loss: 2.38254
Epoch 61, Val Loss: 2.37198
Epoch 62, Val Loss: 2.39748
Epoch 63, Val Loss: 2.48593
Epoch 64, Val Loss: 2.41859
Epoch 65, Val Loss: 2.43308
Epoch 66, Val Loss: 2.42885
Epoch 67, Val Loss: 2.50096
Epoch 68, Val Loss: 2.41895
Epoch 69, Val Loss: 2.45284
Epoch 70, Val Loss: 2.37298
Epoch 71, Val Loss: 2.38073
Epoch 72, Val Loss: 2.36060
Epoch 73, Val Loss: 2.39861
Epoch 74, Val Loss: 2.38348
Epoch 75, Val Loss: 2.35401
Epoch 76, Val Loss: 2.37983
Epoch 77, Val Loss: 2.39611
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.8377, 'Log Loss - std': 2.58892109960887} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.48080581158290875, 'alpha': 4.994803529992808, 'K': 10, 'beta': 0.15012139707063898}
Fitted encoder
Epoch 0, Val Loss: 2.68727
Epoch 1, Val Loss: 2.68727
Epoch 2, Val Loss: 2.68727
Epoch 3, Val Loss: 2.68727
Epoch 4, Val Loss: 2.68727
Epoch 5, Val Loss: 2.68727
Epoch 6, Val Loss: 2.68727
Epoch 7, Val Loss: 2.68727
Epoch 8, Val Loss: 2.68727
Epoch 9, Val Loss: 2.68727
Epoch 10, Val Loss: 2.68727
Epoch 11, Val Loss: 2.68727
Epoch 12, Val Loss: 2.68727
Epoch 13, Val Loss: 2.68727
Epoch 14, Val Loss: 2.68727
Epoch 15, Val Loss: 2.68727
Epoch 16, Val Loss: 2.68727
Epoch 17, Val Loss: 2.68727
Epoch 18, Val Loss: 2.68727
Epoch 19, Val Loss: 2.68727
Epoch 20, Val Loss: 2.68727
Epoch 21, Val Loss: 2.68727
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.310425, 'Log Loss - std': 2.3868998977491707} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.48080581158290875, 'alpha': 4.994803529992808, 'K': 10, 'beta': 0.15012139707063898}
Fitted encoder
Epoch 0, Val Loss: 2.68267
Epoch 1, Val Loss: 2.68267
Epoch 2, Val Loss: 2.68525
Epoch 3, Val Loss: 2.68525
Epoch 4, Val Loss: 2.68525
Epoch 5, Val Loss: 2.68525
Epoch 6, Val Loss: 2.68525
Epoch 7, Val Loss: 2.68525
Epoch 8, Val Loss: 2.62637
Epoch 9, Val Loss: 2.67348
Epoch 10, Val Loss: 2.67348
Epoch 11, Val Loss: 2.67348
Epoch 12, Val Loss: 2.67348
Epoch 13, Val Loss: 2.67348
Epoch 14, Val Loss: 2.67348
Epoch 15, Val Loss: 2.67348
Epoch 16, Val Loss: 2.67348
Epoch 17, Val Loss: 2.67348
Epoch 18, Val Loss: 2.67348
Epoch 19, Val Loss: 2.67348
Epoch 20, Val Loss: 2.67348
Epoch 21, Val Loss: 2.68938
Epoch 22, Val Loss: 2.68938
Epoch 23, Val Loss: 2.68938
Epoch 24, Val Loss: 2.68938
Epoch 25, Val Loss: 2.68938
Epoch 26, Val Loss: 2.68938
Epoch 27, Val Loss: 2.68938
Epoch 28, Val Loss: 2.68938
Epoch 29, Val Loss: 2.68938
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.45006, 'Log Loss - std': 2.153096521384956} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 30 finished with value: 9.45006 and parameters: {'p_m': 0.48080581158290875, 'alpha': 4.994803529992808, 'K': 10, 'beta': 0.15012139707063898}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4952629351180917, 'alpha': 5.285136304210028, 'K': 10, 'beta': 0.2034057514883319}
Fitted encoder
Epoch 0, Val Loss: 2.68412
Epoch 1, Val Loss: 2.68074
Epoch 2, Val Loss: 2.68074
Epoch 3, Val Loss: 2.68074
Epoch 4, Val Loss: 2.68074
Epoch 5, Val Loss: 2.68074
Epoch 6, Val Loss: 2.68074
Epoch 7, Val Loss: 2.68074
Epoch 8, Val Loss: 2.68074
Epoch 9, Val Loss: 2.68074
Epoch 10, Val Loss: 2.68074
Epoch 11, Val Loss: 2.68074
Epoch 12, Val Loss: 2.68396
Epoch 13, Val Loss: 2.68396
Epoch 14, Val Loss: 2.68396
Epoch 15, Val Loss: 2.68396
Epoch 16, Val Loss: 2.68396
Epoch 17, Val Loss: 2.68396
Epoch 18, Val Loss: 2.68396
Epoch 19, Val Loss: 2.68396
Epoch 20, Val Loss: 2.68396
Epoch 21, Val Loss: 2.68396
Epoch 22, Val Loss: 2.68396
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6528, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4952629351180917, 'alpha': 5.285136304210028, 'K': 10, 'beta': 0.2034057514883319}
Fitted encoder
Epoch 0, Val Loss: 2.68543
Epoch 1, Val Loss: 2.68543
Epoch 2, Val Loss: 2.68744
Epoch 3, Val Loss: 2.68727
Epoch 4, Val Loss: 2.68727
Epoch 5, Val Loss: 2.68727
Epoch 6, Val Loss: 2.68727
Epoch 7, Val Loss: 2.68727
Epoch 8, Val Loss: 2.68727
Epoch 9, Val Loss: 2.58014
Epoch 10, Val Loss: 2.68644
Epoch 11, Val Loss: 2.68644
Epoch 12, Val Loss: 2.68644
Epoch 13, Val Loss: 2.68644
Epoch 14, Val Loss: 2.68644
Epoch 15, Val Loss: 2.68644
Epoch 16, Val Loss: 2.68644
Epoch 17, Val Loss: 2.68644
Epoch 18, Val Loss: 2.68644
Epoch 19, Val Loss: 2.68644
Epoch 20, Val Loss: 2.68644
Epoch 21, Val Loss: 2.68644
Epoch 22, Val Loss: 2.68644
Epoch 23, Val Loss: 2.68644
Epoch 24, Val Loss: 2.68644
Epoch 25, Val Loss: 2.61731
Epoch 26, Val Loss: 2.67305
Epoch 27, Val Loss: 2.68727
Epoch 28, Val Loss: 2.68727
Epoch 29, Val Loss: 2.68727
Epoch 30, Val Loss: 2.68723
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.78715, 'Log Loss - std': 1.8656499999999996} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4952629351180917, 'alpha': 5.285136304210028, 'K': 10, 'beta': 0.2034057514883319}
Fitted encoder
Epoch 0, Val Loss: 2.68368
Epoch 1, Val Loss: 2.68368
Epoch 2, Val Loss: 2.68322
Epoch 3, Val Loss: 2.68368
Epoch 4, Val Loss: 2.68368
Epoch 5, Val Loss: 2.68368
Epoch 6, Val Loss: 2.68368
Epoch 7, Val Loss: 2.68368
Epoch 8, Val Loss: 2.52519
Epoch 9, Val Loss: 2.43221
Epoch 10, Val Loss: 2.57048
Epoch 11, Val Loss: 2.61659
Epoch 12, Val Loss: 2.60875
Epoch 13, Val Loss: 2.54031
Epoch 14, Val Loss: 2.53952
Epoch 15, Val Loss: 2.51317
Epoch 16, Val Loss: 2.49713
Epoch 17, Val Loss: 2.51744
Epoch 18, Val Loss: 2.49458
Epoch 19, Val Loss: 2.51141
Epoch 20, Val Loss: 2.50752
Epoch 21, Val Loss: 2.46683
Epoch 22, Val Loss: 2.44395
Epoch 23, Val Loss: 2.47113
Epoch 24, Val Loss: 2.46962
Epoch 25, Val Loss: 2.46459
Epoch 26, Val Loss: 2.44812
Epoch 27, Val Loss: 2.53505
Epoch 28, Val Loss: 2.45735
Epoch 29, Val Loss: 2.48085
Epoch 30, Val Loss: 2.64784
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.1614, 'Log Loss - std': 1.7616921997518933} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4952629351180917, 'alpha': 5.285136304210028, 'K': 10, 'beta': 0.2034057514883319}
Fitted encoder
Epoch 0, Val Loss: 2.68506
Epoch 1, Val Loss: 2.68506
Epoch 2, Val Loss: 2.68506
Epoch 3, Val Loss: 2.68506
Epoch 4, Val Loss: 2.68506
Epoch 5, Val Loss: 2.68506
Epoch 6, Val Loss: 2.68506
Epoch 7, Val Loss: 2.68506
Epoch 8, Val Loss: 2.68506
Epoch 9, Val Loss: 2.68506
Epoch 10, Val Loss: 2.68506
Epoch 11, Val Loss: 2.68506
Epoch 12, Val Loss: 2.68506
Epoch 13, Val Loss: 2.68506
Epoch 14, Val Loss: 2.68506
Epoch 15, Val Loss: 2.68506
Epoch 16, Val Loss: 2.51720
Epoch 17, Val Loss: 2.59610
Epoch 18, Val Loss: 2.53354
Epoch 19, Val Loss: 2.51387
Epoch 20, Val Loss: 2.45512
Epoch 21, Val Loss: 2.53351
Epoch 22, Val Loss: 2.53610
Epoch 23, Val Loss: 2.52852
Epoch 24, Val Loss: 2.54062
Epoch 25, Val Loss: 2.54163
Epoch 26, Val Loss: 2.55793
Epoch 27, Val Loss: 2.52122
Epoch 28, Val Loss: 2.53621
Epoch 29, Val Loss: 2.53097
Epoch 30, Val Loss: 2.53294
Epoch 31, Val Loss: 2.67456
Epoch 32, Val Loss: 2.44712
Epoch 33, Val Loss: 2.54207
Epoch 34, Val Loss: 2.48983
Epoch 35, Val Loss: 2.46750
Epoch 36, Val Loss: 2.44817
Epoch 37, Val Loss: 2.47786
Epoch 38, Val Loss: 2.43266
Epoch 39, Val Loss: 2.50708
Epoch 40, Val Loss: 2.42714
Epoch 41, Val Loss: 2.42945
Epoch 42, Val Loss: 2.48107
Epoch 43, Val Loss: 2.48627
Epoch 44, Val Loss: 2.42389
Epoch 45, Val Loss: 2.45636
Epoch 46, Val Loss: 2.42412
Epoch 47, Val Loss: 2.40858
Epoch 48, Val Loss: 2.39744
Epoch 49, Val Loss: 2.43455
Epoch 50, Val Loss: 2.41754
Epoch 51, Val Loss: 2.48056
Epoch 52, Val Loss: 2.44476
Epoch 53, Val Loss: 2.44350
Epoch 54, Val Loss: 2.43981
Epoch 55, Val Loss: 2.42105
Epoch 56, Val Loss: 2.43256
Epoch 57, Val Loss: 2.41233
Epoch 58, Val Loss: 2.41987
Epoch 59, Val Loss: 2.41493
Epoch 60, Val Loss: 2.40585
Epoch 61, Val Loss: 2.41823
Epoch 62, Val Loss: 2.40714
Epoch 63, Val Loss: 2.41955
Epoch 64, Val Loss: 2.43938
Epoch 65, Val Loss: 2.49782
Epoch 66, Val Loss: 2.39639
Epoch 67, Val Loss: 2.42726
Epoch 68, Val Loss: 2.47777
Epoch 69, Val Loss: 2.41685
Epoch 70, Val Loss: 2.52532
Epoch 71, Val Loss: 2.46398
Epoch 72, Val Loss: 2.44837
Epoch 73, Val Loss: 2.41301
Epoch 74, Val Loss: 2.40556
Epoch 75, Val Loss: 2.40195
Epoch 76, Val Loss: 2.57550
Epoch 77, Val Loss: 2.40388
Epoch 78, Val Loss: 2.39495
Epoch 79, Val Loss: 2.41829
Epoch 80, Val Loss: 2.44540
Epoch 81, Val Loss: 2.42334
Epoch 82, Val Loss: 2.41392
Epoch 83, Val Loss: 2.41015
Epoch 84, Val Loss: 2.53911
Epoch 85, Val Loss: 2.41631
Epoch 86, Val Loss: 2.44663
Epoch 87, Val Loss: 2.40946
Epoch 88, Val Loss: 2.41872
Epoch 89, Val Loss: 2.40414
Epoch 90, Val Loss: 2.43938
Epoch 91, Val Loss: 2.40444
Epoch 92, Val Loss: 2.39567
Epoch 93, Val Loss: 2.45880
Epoch 94, Val Loss: 2.39842
Epoch 95, Val Loss: 2.40482
Epoch 96, Val Loss: 2.40717
Epoch 97, Val Loss: 2.42141
Epoch 98, Val Loss: 2.40111
Epoch 99, Val Loss: 2.40625
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 7.67005, 'Log Loss - std': 1.74698140302065} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4952629351180917, 'alpha': 5.285136304210028, 'K': 10, 'beta': 0.2034057514883319}
Fitted encoder
Epoch 0, Val Loss: 2.67264
Epoch 1, Val Loss: 2.68552
Epoch 2, Val Loss: 2.68552
Epoch 3, Val Loss: 2.68552
Epoch 4, Val Loss: 2.68552
Epoch 5, Val Loss: 2.68552
Epoch 6, Val Loss: 2.68350
Epoch 7, Val Loss: 2.68350
Epoch 8, Val Loss: 2.68350
Epoch 9, Val Loss: 2.68350
Epoch 10, Val Loss: 2.68350
Epoch 11, Val Loss: 2.68350
Epoch 12, Val Loss: 2.68350
Epoch 13, Val Loss: 2.68350
Epoch 14, Val Loss: 2.68350
Epoch 15, Val Loss: 2.68350
Epoch 16, Val Loss: 2.68350
Epoch 17, Val Loss: 2.68350
Epoch 18, Val Loss: 2.68350
Epoch 19, Val Loss: 2.61613
Epoch 20, Val Loss: 2.53118
Epoch 21, Val Loss: 2.51160
Epoch 22, Val Loss: 2.55412
Epoch 23, Val Loss: 2.51098
Epoch 24, Val Loss: 2.51070
Epoch 25, Val Loss: 2.51106
Epoch 26, Val Loss: 2.50869
Epoch 27, Val Loss: 2.48007
Epoch 28, Val Loss: 2.49063
Epoch 29, Val Loss: 2.44989
Epoch 30, Val Loss: 2.51494
Epoch 31, Val Loss: 2.49363
Epoch 32, Val Loss: 2.46091
Epoch 33, Val Loss: 2.50947
Epoch 34, Val Loss: 2.60080
Epoch 35, Val Loss: 2.68148
Epoch 36, Val Loss: 2.68148
Epoch 37, Val Loss: 2.68148
Epoch 38, Val Loss: 2.68148
Epoch 39, Val Loss: 2.68148
Epoch 40, Val Loss: 2.68148
Epoch 41, Val Loss: 2.62967
Epoch 42, Val Loss: 2.60965
Epoch 43, Val Loss: 2.53753
Epoch 44, Val Loss: 2.55096
Epoch 45, Val Loss: 2.55255
Epoch 46, Val Loss: 2.59923
Epoch 47, Val Loss: 2.51970
Epoch 48, Val Loss: 2.52627
Epoch 49, Val Loss: 2.53470
Epoch 50, Val Loss: 2.55081
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 7.60086, 'Log Loss - std': 1.5686632023477822} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 31 finished with value: 7.60086 and parameters: {'p_m': 0.4952629351180917, 'alpha': 5.285136304210028, 'K': 10, 'beta': 0.2034057514883319}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6245375775390853, 'alpha': 7.273799460544899, 'K': 10, 'beta': 1.5825852223809591}
Fitted encoder
Epoch 0, Val Loss: 2.39050
Epoch 1, Val Loss: 2.28547
Epoch 2, Val Loss: 2.24632
Epoch 3, Val Loss: 2.25535
Epoch 4, Val Loss: 2.25872
Epoch 5, Val Loss: 2.25622
Epoch 6, Val Loss: 2.27492
Epoch 7, Val Loss: 2.27085
Epoch 8, Val Loss: 2.23986
Epoch 9, Val Loss: 2.28812
Epoch 10, Val Loss: 2.23706
Epoch 11, Val Loss: 2.22504
Epoch 12, Val Loss: 2.30012
Epoch 13, Val Loss: 2.29340
Epoch 14, Val Loss: 2.28607
Epoch 15, Val Loss: 2.26944
Epoch 16, Val Loss: 2.26676
Epoch 17, Val Loss: 2.25885
Epoch 18, Val Loss: 2.22722
Epoch 19, Val Loss: 2.22350
Epoch 20, Val Loss: 2.22876
Epoch 21, Val Loss: 2.24401
Epoch 22, Val Loss: 2.23587
Epoch 23, Val Loss: 2.22215
Epoch 24, Val Loss: 2.22709
Epoch 25, Val Loss: 2.22998
Epoch 26, Val Loss: 2.24187
Epoch 27, Val Loss: 2.23184
Epoch 28, Val Loss: 2.25606
Epoch 29, Val Loss: 2.25637
Epoch 30, Val Loss: 2.26171
Epoch 31, Val Loss: 2.26164
Epoch 32, Val Loss: 2.24116
Epoch 33, Val Loss: 2.23179
Epoch 34, Val Loss: 2.22989
Epoch 35, Val Loss: 2.21916
Epoch 36, Val Loss: 2.25378
Epoch 37, Val Loss: 2.22929
Epoch 38, Val Loss: 2.24072
Epoch 39, Val Loss: 2.21842
Epoch 40, Val Loss: 2.23343
Epoch 41, Val Loss: 2.23126
Epoch 42, Val Loss: 2.24713
Epoch 43, Val Loss: 2.22103
Epoch 44, Val Loss: 2.23401
Epoch 45, Val Loss: 2.21714
Epoch 46, Val Loss: 2.22409
Epoch 47, Val Loss: 2.23466
Epoch 48, Val Loss: 2.31922
Epoch 49, Val Loss: 2.24741
Epoch 50, Val Loss: 2.25174
Epoch 51, Val Loss: 2.23274
Epoch 52, Val Loss: 2.38397
Epoch 53, Val Loss: 2.23995
Epoch 54, Val Loss: 2.24155
Epoch 55, Val Loss: 2.23709
Epoch 56, Val Loss: 2.22049
Epoch 57, Val Loss: 2.22402
Epoch 58, Val Loss: 2.22000
Epoch 59, Val Loss: 2.24931
Epoch 60, Val Loss: 2.21827
Epoch 61, Val Loss: 2.26818
Epoch 62, Val Loss: 2.22180
Epoch 63, Val Loss: 2.29544
Epoch 64, Val Loss: 2.22186
Epoch 65, Val Loss: 2.23768
Epoch 66, Val Loss: 2.26030
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.0397, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6245375775390853, 'alpha': 7.273799460544899, 'K': 10, 'beta': 1.5825852223809591}
Fitted encoder
Epoch 0, Val Loss: 2.46248
Epoch 1, Val Loss: 2.33438
Epoch 2, Val Loss: 2.33868
Epoch 3, Val Loss: 2.28794
Epoch 4, Val Loss: 2.40387
Epoch 5, Val Loss: 2.36146
Epoch 6, Val Loss: 2.30803
Epoch 7, Val Loss: 2.28812
Epoch 8, Val Loss: 2.25182
Epoch 9, Val Loss: 2.24796
Epoch 10, Val Loss: 2.27858
Epoch 11, Val Loss: 2.28084
Epoch 12, Val Loss: 2.25051
Epoch 13, Val Loss: 2.25364
Epoch 14, Val Loss: 2.26622
Epoch 15, Val Loss: 2.31225
Epoch 16, Val Loss: 2.23225
Epoch 17, Val Loss: 2.25764
Epoch 18, Val Loss: 2.23541
Epoch 19, Val Loss: 2.24010
Epoch 20, Val Loss: 2.23300
Epoch 21, Val Loss: 2.31825
Epoch 22, Val Loss: 2.31449
Epoch 23, Val Loss: 2.37393
Epoch 24, Val Loss: 2.30132
Epoch 25, Val Loss: 2.25188
Epoch 26, Val Loss: 2.25603
Epoch 27, Val Loss: 2.23486
Epoch 28, Val Loss: 2.30471
Epoch 29, Val Loss: 2.29131
Epoch 30, Val Loss: 2.28813
Epoch 31, Val Loss: 2.26100
Epoch 32, Val Loss: 2.31534
Epoch 33, Val Loss: 2.24524
Epoch 34, Val Loss: 2.24914
Epoch 35, Val Loss: 2.19964
Epoch 36, Val Loss: 2.24731
Epoch 37, Val Loss: 2.20160
Epoch 38, Val Loss: 2.27370
Epoch 39, Val Loss: 2.24310
Epoch 40, Val Loss: 2.25628
Epoch 41, Val Loss: 2.21725
Epoch 42, Val Loss: 2.21154
Epoch 43, Val Loss: 2.19288
Epoch 44, Val Loss: 2.19941
Epoch 45, Val Loss: 2.19919
Epoch 46, Val Loss: 2.22602
Epoch 47, Val Loss: 2.23564
Epoch 48, Val Loss: 2.19051
Epoch 49, Val Loss: 2.19782
Epoch 50, Val Loss: 2.23832
Epoch 51, Val Loss: 2.19325
Epoch 52, Val Loss: 2.21201
Epoch 53, Val Loss: 2.23078
Epoch 54, Val Loss: 2.23625
Epoch 55, Val Loss: 2.18978
Epoch 56, Val Loss: 2.24109
Epoch 57, Val Loss: 2.29291
Epoch 58, Val Loss: 2.21049
Epoch 59, Val Loss: 2.19095
Epoch 60, Val Loss: 2.19673
Epoch 61, Val Loss: 2.22805
Epoch 62, Val Loss: 2.18479
Epoch 63, Val Loss: 2.27868
Epoch 64, Val Loss: 2.21353
Epoch 65, Val Loss: 2.22026
Epoch 66, Val Loss: 2.18206
Epoch 67, Val Loss: 2.23610
Epoch 68, Val Loss: 2.20394
Epoch 69, Val Loss: 2.19703
Epoch 70, Val Loss: 2.19135
Epoch 71, Val Loss: 2.19348
Epoch 72, Val Loss: 2.18109
Epoch 73, Val Loss: 2.19640
Epoch 74, Val Loss: 2.20253
Epoch 75, Val Loss: 2.24535
Epoch 76, Val Loss: 2.24802
Epoch 77, Val Loss: 2.22036
Epoch 78, Val Loss: 2.20439
Epoch 79, Val Loss: 2.21414
Epoch 80, Val Loss: 2.23547
Epoch 81, Val Loss: 2.19673
Epoch 82, Val Loss: 2.21786
Epoch 83, Val Loss: 2.20594
Epoch 84, Val Loss: 2.21663
Epoch 85, Val Loss: 2.23957
Epoch 86, Val Loss: 2.23039
Epoch 87, Val Loss: 2.24545
Epoch 88, Val Loss: 2.18706
Epoch 89, Val Loss: 2.25113
Epoch 90, Val Loss: 2.30640
Epoch 91, Val Loss: 2.18893
Epoch 92, Val Loss: 2.19350
Epoch 93, Val Loss: 2.20512
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.6782, 'Log Loss - std': 0.36149999999999993} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6245375775390853, 'alpha': 7.273799460544899, 'K': 10, 'beta': 1.5825852223809591}
Fitted encoder
Epoch 0, Val Loss: 2.29643
Epoch 1, Val Loss: 2.33065
Epoch 2, Val Loss: 2.26292
Epoch 3, Val Loss: 2.28274
Epoch 4, Val Loss: 2.29936
Epoch 5, Val Loss: 2.28463
Epoch 6, Val Loss: 2.27071
Epoch 7, Val Loss: 2.19718
Epoch 8, Val Loss: 2.24974
Epoch 9, Val Loss: 2.19229
Epoch 10, Val Loss: 2.30860
Epoch 11, Val Loss: 2.25450
Epoch 12, Val Loss: 2.18979
Epoch 13, Val Loss: 2.22666
Epoch 14, Val Loss: 2.24281
Epoch 15, Val Loss: 2.21014
Epoch 16, Val Loss: 2.20659
Epoch 17, Val Loss: 2.18183
Epoch 18, Val Loss: 2.15802
Epoch 19, Val Loss: 2.18170
Epoch 20, Val Loss: 2.20878
Epoch 21, Val Loss: 2.18805
Epoch 22, Val Loss: 2.15996
Epoch 23, Val Loss: 2.24614
Epoch 24, Val Loss: 2.15732
Epoch 25, Val Loss: 2.15993
Epoch 26, Val Loss: 2.19981
Epoch 27, Val Loss: 2.23196
Epoch 28, Val Loss: 2.17812
Epoch 29, Val Loss: 2.16232
Epoch 30, Val Loss: 2.17523
Epoch 31, Val Loss: 2.17965
Epoch 32, Val Loss: 2.19041
Epoch 33, Val Loss: 2.18445
Epoch 34, Val Loss: 2.27799
Epoch 35, Val Loss: 2.15502
Epoch 36, Val Loss: 2.15269
Epoch 37, Val Loss: 2.16263
Epoch 38, Val Loss: 2.19617
Epoch 39, Val Loss: 2.20884
Epoch 40, Val Loss: 2.18094
Epoch 41, Val Loss: 2.19526
Epoch 42, Val Loss: 2.16697
Epoch 43, Val Loss: 2.18376
Epoch 44, Val Loss: 2.16630
Epoch 45, Val Loss: 2.17489
Epoch 46, Val Loss: 2.15354
Epoch 47, Val Loss: 2.16191
Epoch 48, Val Loss: 2.14429
Epoch 49, Val Loss: 2.16486
Epoch 50, Val Loss: 2.14926
Epoch 51, Val Loss: 2.19917
Epoch 52, Val Loss: 2.16741
Epoch 53, Val Loss: 2.16135
Epoch 54, Val Loss: 2.14645
Epoch 55, Val Loss: 2.15010
Epoch 56, Val Loss: 2.14201
Epoch 57, Val Loss: 2.20928
Epoch 58, Val Loss: 2.16875
Epoch 59, Val Loss: 2.19252
Epoch 60, Val Loss: 2.16911
Epoch 61, Val Loss: 2.18434
Epoch 62, Val Loss: 2.15812
Epoch 63, Val Loss: 2.30771
Epoch 64, Val Loss: 2.15365
Epoch 65, Val Loss: 2.15517
Epoch 66, Val Loss: 2.14664
Epoch 67, Val Loss: 2.14538
Epoch 68, Val Loss: 2.16404
Epoch 69, Val Loss: 2.15416
Epoch 70, Val Loss: 2.18030
Epoch 71, Val Loss: 2.15134
Epoch 72, Val Loss: 2.18195
Epoch 73, Val Loss: 2.18767
Epoch 74, Val Loss: 2.22683
Epoch 75, Val Loss: 2.15356
Epoch 76, Val Loss: 2.14446
Epoch 77, Val Loss: 2.18790
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.2887, 'Log Loss - std': 0.6249335964724572} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6245375775390853, 'alpha': 7.273799460544899, 'K': 10, 'beta': 1.5825852223809591}
Fitted encoder
Epoch 0, Val Loss: 2.29839
Epoch 1, Val Loss: 2.25274
Epoch 2, Val Loss: 2.30526
Epoch 3, Val Loss: 2.32825
Epoch 4, Val Loss: 2.35490
Epoch 5, Val Loss: 2.29839
Epoch 6, Val Loss: 2.46454
Epoch 7, Val Loss: 2.38094
Epoch 8, Val Loss: 2.39769
Epoch 9, Val Loss: 2.29335
Epoch 10, Val Loss: 2.30266
Epoch 11, Val Loss: 2.27802
Epoch 12, Val Loss: 2.29277
Epoch 13, Val Loss: 2.23764
Epoch 14, Val Loss: 2.26054
Epoch 15, Val Loss: 2.19317
Epoch 16, Val Loss: 2.23637
Epoch 17, Val Loss: 2.28083
Epoch 18, Val Loss: 2.29590
Epoch 19, Val Loss: 2.31583
Epoch 20, Val Loss: 2.37348
Epoch 21, Val Loss: 2.30749
Epoch 22, Val Loss: 2.28360
Epoch 23, Val Loss: 2.29852
Epoch 24, Val Loss: 2.45266
Epoch 25, Val Loss: 2.36611
Epoch 26, Val Loss: 2.44335
Epoch 27, Val Loss: 2.32886
Epoch 28, Val Loss: 2.26314
Epoch 29, Val Loss: 2.22648
Epoch 30, Val Loss: 2.38042
Epoch 31, Val Loss: 2.29062
Epoch 32, Val Loss: 2.23486
Epoch 33, Val Loss: 2.29669
Epoch 34, Val Loss: 2.32263
Epoch 35, Val Loss: 2.25117
Epoch 36, Val Loss: 2.34419
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.4257, 'Log Loss - std': 0.5909428906417269} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6245375775390853, 'alpha': 7.273799460544899, 'K': 10, 'beta': 1.5825852223809591}
Fitted encoder
Epoch 0, Val Loss: 2.32401
Epoch 1, Val Loss: 2.31735
Epoch 2, Val Loss: 2.32666
Epoch 3, Val Loss: 2.29778
Epoch 4, Val Loss: 2.42782
Epoch 5, Val Loss: 2.29585
Epoch 6, Val Loss: 2.27166
Epoch 7, Val Loss: 2.24889
Epoch 8, Val Loss: 2.52452
Epoch 9, Val Loss: 2.45514
Epoch 10, Val Loss: 2.47099
Epoch 11, Val Loss: 2.52615
Epoch 12, Val Loss: 2.46041
Epoch 13, Val Loss: 2.44376
Epoch 14, Val Loss: 2.42749
Epoch 15, Val Loss: 2.30819
Epoch 16, Val Loss: 2.27399
Epoch 17, Val Loss: 2.31154
Epoch 18, Val Loss: 2.29144
Epoch 19, Val Loss: 2.29690
Epoch 20, Val Loss: 2.30573
Epoch 21, Val Loss: 2.25061
Epoch 22, Val Loss: 2.25770
Epoch 23, Val Loss: 2.16982
Epoch 24, Val Loss: 2.16463
Epoch 25, Val Loss: 2.19221
Epoch 26, Val Loss: 2.17824
Epoch 27, Val Loss: 2.16003
Epoch 28, Val Loss: 2.16385
Epoch 29, Val Loss: 2.19975
Epoch 30, Val Loss: 2.15083
Epoch 31, Val Loss: 2.18291
Epoch 32, Val Loss: 2.15792
Epoch 33, Val Loss: 2.16832
Epoch 34, Val Loss: 2.13004
Epoch 35, Val Loss: 2.20681
Epoch 36, Val Loss: 2.14140
Epoch 37, Val Loss: 2.13680
Epoch 38, Val Loss: 2.16614
Epoch 39, Val Loss: 2.13542
Epoch 40, Val Loss: 2.11581
Epoch 41, Val Loss: 2.14911
Epoch 42, Val Loss: 2.14744
Epoch 43, Val Loss: 2.17071
Epoch 44, Val Loss: 2.12130
Epoch 45, Val Loss: 2.11563
Epoch 46, Val Loss: 2.12795
Epoch 47, Val Loss: 2.18836
Epoch 48, Val Loss: 2.16224
Epoch 49, Val Loss: 2.13294
Epoch 50, Val Loss: 2.20263
Epoch 51, Val Loss: 2.14521
Epoch 52, Val Loss: 2.13616
Epoch 53, Val Loss: 2.14456
Epoch 54, Val Loss: 2.15213
Epoch 55, Val Loss: 2.17136
Epoch 56, Val Loss: 2.15001
Epoch 57, Val Loss: 2.13059
Epoch 58, Val Loss: 2.13403
Epoch 59, Val Loss: 2.13926
Epoch 60, Val Loss: 2.14641
Epoch 61, Val Loss: 2.15165
Epoch 62, Val Loss: 2.19567
Epoch 63, Val Loss: 2.15183
Epoch 64, Val Loss: 2.12833
Epoch 65, Val Loss: 2.16999
Epoch 66, Val Loss: 2.16423
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.24862, 'Log Loss - std': 0.6362390318111582} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 32 finished with value: 2.24862 and parameters: {'p_m': 0.6245375775390853, 'alpha': 7.273799460544899, 'K': 10, 'beta': 1.5825852223809591}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4310112762542897, 'alpha': 6.580626514949483, 'K': 10, 'beta': 0.7508324293608496}
Fitted encoder
Epoch 0, Val Loss: 2.57407
Epoch 1, Val Loss: 2.61016
Epoch 2, Val Loss: 2.67302
Epoch 3, Val Loss: 2.67302
Epoch 4, Val Loss: 2.67302
Epoch 5, Val Loss: 2.67302
Epoch 6, Val Loss: 2.67302
Epoch 7, Val Loss: 2.67302
Epoch 8, Val Loss: 2.67302
Epoch 9, Val Loss: 2.67302
Epoch 10, Val Loss: 2.67302
Epoch 11, Val Loss: 2.67302
Epoch 12, Val Loss: 2.67302
Epoch 13, Val Loss: 2.42891
Epoch 14, Val Loss: 2.41416
Epoch 15, Val Loss: 2.37578
Epoch 16, Val Loss: 2.31275
Epoch 17, Val Loss: 2.36317
Epoch 18, Val Loss: 2.30767
Epoch 19, Val Loss: 2.35739
Epoch 20, Val Loss: 2.35406
Epoch 21, Val Loss: 2.36787
Epoch 22, Val Loss: 2.36055
Epoch 23, Val Loss: 2.35175
Epoch 24, Val Loss: 2.32244
Epoch 25, Val Loss: 2.29062
Epoch 26, Val Loss: 2.29402
Epoch 27, Val Loss: 2.29266
Epoch 28, Val Loss: 2.29388
Epoch 29, Val Loss: 2.25741
Epoch 30, Val Loss: 2.33259
Epoch 31, Val Loss: 2.41218
Epoch 32, Val Loss: 2.29502
Epoch 33, Val Loss: 2.27571
Epoch 34, Val Loss: 2.27392
Epoch 35, Val Loss: 2.29176
Epoch 36, Val Loss: 2.28470
Epoch 37, Val Loss: 2.31979
Epoch 38, Val Loss: 2.28412
Epoch 39, Val Loss: 2.29895
Epoch 40, Val Loss: 2.28589
Epoch 41, Val Loss: 2.28534
Epoch 42, Val Loss: 2.27360
Epoch 43, Val Loss: 2.25355
Epoch 44, Val Loss: 2.29685
Epoch 45, Val Loss: 2.29001
Epoch 46, Val Loss: 2.29463
Epoch 47, Val Loss: 2.24457
Epoch 48, Val Loss: 2.24555
Epoch 49, Val Loss: 2.26949
Epoch 50, Val Loss: 2.27249
Epoch 51, Val Loss: 2.28334
Epoch 52, Val Loss: 2.29861
Epoch 53, Val Loss: 2.25245
Epoch 54, Val Loss: 2.26272
Epoch 55, Val Loss: 2.28058
Epoch 56, Val Loss: 2.25110
Epoch 57, Val Loss: 2.24461
Epoch 58, Val Loss: 2.28013
Epoch 59, Val Loss: 2.25489
Epoch 60, Val Loss: 2.27367
Epoch 61, Val Loss: 2.28419
Epoch 62, Val Loss: 2.28484
Epoch 63, Val Loss: 2.27869
Epoch 64, Val Loss: 2.26196
Epoch 65, Val Loss: 2.31710
Epoch 66, Val Loss: 2.24536
Epoch 67, Val Loss: 2.26874
Epoch 68, Val Loss: 2.27165
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.4532, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4310112762542897, 'alpha': 6.580626514949483, 'K': 10, 'beta': 0.7508324293608496}
Fitted encoder
Epoch 0, Val Loss: 2.68745
Epoch 1, Val Loss: 2.68745
Epoch 2, Val Loss: 2.68745
Epoch 3, Val Loss: 2.68745
Epoch 4, Val Loss: 2.68745
Epoch 5, Val Loss: 2.68745
Epoch 6, Val Loss: 2.68745
Epoch 7, Val Loss: 2.68745
Epoch 8, Val Loss: 2.68745
Epoch 9, Val Loss: 2.68745
Epoch 10, Val Loss: 2.68745
Epoch 11, Val Loss: 2.68093
Epoch 12, Val Loss: 2.68093
Epoch 13, Val Loss: 2.68093
Epoch 14, Val Loss: 2.68093
Epoch 15, Val Loss: 2.68093
Epoch 16, Val Loss: 2.55663
Epoch 17, Val Loss: 2.45747
Epoch 18, Val Loss: 2.39948
Epoch 19, Val Loss: 2.36493
Epoch 20, Val Loss: 2.37619
Epoch 21, Val Loss: 2.37140
Epoch 22, Val Loss: 2.42522
Epoch 23, Val Loss: 2.35202
Epoch 24, Val Loss: 2.35736
Epoch 25, Val Loss: 2.39124
Epoch 26, Val Loss: 2.25580
Epoch 27, Val Loss: 2.27148
Epoch 28, Val Loss: 2.21611
Epoch 29, Val Loss: 2.21848
Epoch 30, Val Loss: 2.20697
Epoch 31, Val Loss: 2.30798
Epoch 32, Val Loss: 2.25013
Epoch 33, Val Loss: 2.19900
Epoch 34, Val Loss: 2.19058
Epoch 35, Val Loss: 2.22689
Epoch 36, Val Loss: 2.18664
Epoch 37, Val Loss: 2.19202
Epoch 38, Val Loss: 2.17176
Epoch 39, Val Loss: 2.37704
Epoch 40, Val Loss: 2.20867
Epoch 41, Val Loss: 2.27314
Epoch 42, Val Loss: 2.16491
Epoch 43, Val Loss: 2.17736
Epoch 44, Val Loss: 2.16588
Epoch 45, Val Loss: 2.19221
Epoch 46, Val Loss: 2.35918
Epoch 47, Val Loss: 2.15877
Epoch 48, Val Loss: 2.18537
Epoch 49, Val Loss: 2.13760
Epoch 50, Val Loss: 2.17306
Epoch 51, Val Loss: 2.17937
Epoch 52, Val Loss: 2.23736
Epoch 53, Val Loss: 2.23200
Epoch 54, Val Loss: 2.17467
Epoch 55, Val Loss: 2.25897
Epoch 56, Val Loss: 2.22460
Epoch 57, Val Loss: 2.21850
Epoch 58, Val Loss: 2.18419
Epoch 59, Val Loss: 2.41339
Epoch 60, Val Loss: 2.43796
Epoch 61, Val Loss: 2.35036
Epoch 62, Val Loss: 2.32496
Epoch 63, Val Loss: 2.30479
Epoch 64, Val Loss: 2.31087
Epoch 65, Val Loss: 2.29617
Epoch 66, Val Loss: 2.36199
Epoch 67, Val Loss: 2.29491
Epoch 68, Val Loss: 2.32845
Epoch 69, Val Loss: 2.26019
Epoch 70, Val Loss: 2.27126
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.92625, 'Log Loss - std': 0.5269499999999998} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4310112762542897, 'alpha': 6.580626514949483, 'K': 10, 'beta': 0.7508324293608496}
Fitted encoder
Epoch 0, Val Loss: 2.33414
Epoch 1, Val Loss: 2.48054
Epoch 2, Val Loss: 2.39210
Epoch 3, Val Loss: 2.39942
Epoch 4, Val Loss: 2.40632
Epoch 5, Val Loss: 2.42982
Epoch 6, Val Loss: 2.39662
Epoch 7, Val Loss: 2.47041
Epoch 8, Val Loss: 2.43170
Epoch 9, Val Loss: 2.45133
Epoch 10, Val Loss: 2.50597
Epoch 11, Val Loss: 2.43302
Epoch 12, Val Loss: 2.42465
Epoch 13, Val Loss: 2.40646
Epoch 14, Val Loss: 2.54211
Epoch 15, Val Loss: 2.44914
Epoch 16, Val Loss: 2.44487
Epoch 17, Val Loss: 2.43689
Epoch 18, Val Loss: 2.44476
Epoch 19, Val Loss: 2.48769
Epoch 20, Val Loss: 2.52253
Epoch 21, Val Loss: 2.43571
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.4865666666666666, 'Log Loss - std': 0.9016801366831193} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4310112762542897, 'alpha': 6.580626514949483, 'K': 10, 'beta': 0.7508324293608496}
Fitted encoder
Epoch 0, Val Loss: 2.68276
Epoch 1, Val Loss: 2.68276
Epoch 2, Val Loss: 2.68276
Epoch 3, Val Loss: 2.68276
Epoch 4, Val Loss: 2.68276
Epoch 5, Val Loss: 2.68276
Epoch 6, Val Loss: 2.68276
Epoch 7, Val Loss: 2.68276
Epoch 8, Val Loss: 2.68276
Epoch 9, Val Loss: 2.68276
Epoch 10, Val Loss: 2.68276
Epoch 11, Val Loss: 2.67881
Epoch 12, Val Loss: 2.67881
Epoch 13, Val Loss: 2.67881
Epoch 14, Val Loss: 2.67881
Epoch 15, Val Loss: 2.67881
Epoch 16, Val Loss: 2.67881
Epoch 17, Val Loss: 2.67881
Epoch 18, Val Loss: 2.67881
Epoch 19, Val Loss: 2.67881
Epoch 20, Val Loss: 2.67881
Epoch 21, Val Loss: 2.67881
Epoch 22, Val Loss: 2.60569
Epoch 23, Val Loss: 2.68506
Epoch 24, Val Loss: 2.68506
Epoch 25, Val Loss: 2.68497
Epoch 26, Val Loss: 2.68497
Epoch 27, Val Loss: 2.68497
Epoch 28, Val Loss: 2.68497
Epoch 29, Val Loss: 2.68497
Epoch 30, Val Loss: 2.68497
Epoch 31, Val Loss: 2.68451
Epoch 32, Val Loss: 2.68451
Epoch 33, Val Loss: 2.68451
Epoch 34, Val Loss: 2.68451
Epoch 35, Val Loss: 2.68451
Epoch 36, Val Loss: 2.68451
Epoch 37, Val Loss: 2.68451
Epoch 38, Val Loss: 2.68451
Epoch 39, Val Loss: 2.68451
Epoch 40, Val Loss: 2.68451
Epoch 41, Val Loss: 2.68451
Epoch 42, Val Loss: 2.68451
Epoch 43, Val Loss: 2.68451
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.937225, 'Log Loss - std': 2.6311592695758645} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.4310112762542897, 'alpha': 6.580626514949483, 'K': 10, 'beta': 0.7508324293608496}
Fitted encoder
Epoch 0, Val Loss: 2.62674
Epoch 1, Val Loss: 2.68350
Epoch 2, Val Loss: 2.68350
Epoch 3, Val Loss: 2.68350
Epoch 4, Val Loss: 2.68350
Epoch 5, Val Loss: 2.68350
Epoch 6, Val Loss: 2.68350
Epoch 7, Val Loss: 2.68350
Epoch 8, Val Loss: 2.68350
Epoch 9, Val Loss: 2.68350
Epoch 10, Val Loss: 2.68525
Epoch 11, Val Loss: 2.68525
Epoch 12, Val Loss: 2.68525
Epoch 13, Val Loss: 2.68525
Epoch 14, Val Loss: 2.68525
Epoch 15, Val Loss: 2.68525
Epoch 16, Val Loss: 2.68525
Epoch 17, Val Loss: 2.68525
Epoch 18, Val Loss: 2.68525
Epoch 19, Val Loss: 2.68525
Epoch 20, Val Loss: 2.68525
Epoch 21, Val Loss: 2.68525
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.944, 'Log Loss - std': 3.097221800904804} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 33 finished with value: 5.944 and parameters: {'p_m': 0.4310112762542897, 'alpha': 6.580626514949483, 'K': 10, 'beta': 0.7508324293608496}. Best is trial 10 with value: 10.54098.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.68497
Epoch 1, Val Loss: 2.68497
Epoch 2, Val Loss: 2.68497
Epoch 3, Val Loss: 2.68497
Epoch 4, Val Loss: 2.68497
Epoch 5, Val Loss: 2.68497
Epoch 6, Val Loss: 2.68497
Epoch 7, Val Loss: 2.68497
Epoch 8, Val Loss: 2.68359
Epoch 9, Val Loss: 2.68368
Epoch 10, Val Loss: 2.68460
Epoch 11, Val Loss: 2.68460
Epoch 12, Val Loss: 2.68460
Epoch 13, Val Loss: 2.68460
Epoch 14, Val Loss: 2.68460
Epoch 15, Val Loss: 2.68460
Epoch 16, Val Loss: 2.68460
Epoch 17, Val Loss: 2.68460
Epoch 18, Val Loss: 2.68460
Epoch 19, Val Loss: 2.68460
Epoch 20, Val Loss: 2.68460
Epoch 21, Val Loss: 2.68460
Epoch 22, Val Loss: 2.68460
Epoch 23, Val Loss: 2.68460
Epoch 24, Val Loss: 2.68460
Epoch 25, Val Loss: 2.68396
Epoch 26, Val Loss: 2.68396
Epoch 27, Val Loss: 2.68396
Epoch 28, Val Loss: 2.68396
Epoch 29, Val Loss: 2.68396
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6859, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.67504
Epoch 1, Val Loss: 2.67504
Epoch 2, Val Loss: 2.67504
Epoch 3, Val Loss: 2.68358
Epoch 4, Val Loss: 2.68359
Epoch 5, Val Loss: 2.68359
Epoch 6, Val Loss: 2.68359
Epoch 7, Val Loss: 2.68359
Epoch 8, Val Loss: 2.68359
Epoch 9, Val Loss: 2.68359
Epoch 10, Val Loss: 2.68359
Epoch 11, Val Loss: 2.68359
Epoch 12, Val Loss: 2.68359
Epoch 13, Val Loss: 2.68543
Epoch 14, Val Loss: 2.68543
Epoch 15, Val Loss: 2.68543
Epoch 16, Val Loss: 2.68543
Epoch 17, Val Loss: 2.68093
Epoch 18, Val Loss: 2.68093
Epoch 19, Val Loss: 2.68093
Epoch 20, Val Loss: 2.68093
Epoch 21, Val Loss: 2.68093
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.68535, 'Log Loss - std': 0.0005500000000004945} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.68016
Epoch 1, Val Loss: 2.68001
Epoch 2, Val Loss: 2.68001
Epoch 3, Val Loss: 2.68001
Epoch 4, Val Loss: 2.68001
Epoch 5, Val Loss: 2.68001
Epoch 6, Val Loss: 2.68001
Epoch 7, Val Loss: 2.68396
Epoch 8, Val Loss: 2.68396
Epoch 9, Val Loss: 2.68396
Epoch 10, Val Loss: 2.68396
Epoch 11, Val Loss: 2.68396
Epoch 12, Val Loss: 2.68396
Epoch 13, Val Loss: 2.68396
Epoch 14, Val Loss: 2.67707
Epoch 15, Val Loss: 2.67707
Epoch 16, Val Loss: 2.67707
Epoch 17, Val Loss: 2.67707
Epoch 18, Val Loss: 2.67707
Epoch 19, Val Loss: 2.67707
Epoch 20, Val Loss: 2.67707
Epoch 21, Val Loss: 2.67707
Epoch 22, Val Loss: 2.67707
Epoch 23, Val Loss: 2.67707
Epoch 24, Val Loss: 2.67707
Epoch 25, Val Loss: 2.67707
Epoch 26, Val Loss: 2.67707
Epoch 27, Val Loss: 2.67707
Epoch 28, Val Loss: 2.68874
Epoch 29, Val Loss: 2.68874
Epoch 30, Val Loss: 2.68874
Epoch 31, Val Loss: 2.68874
Epoch 32, Val Loss: 2.68874
Epoch 33, Val Loss: 2.68874
Epoch 34, Val Loss: 2.68001
Epoch 35, Val Loss: 2.68001
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.693, 'Log Loss - std': 0.010828049993727634} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.68571
Epoch 1, Val Loss: 2.68571
Epoch 2, Val Loss: 2.68571
Epoch 3, Val Loss: 2.68571
Epoch 4, Val Loss: 2.68571
Epoch 5, Val Loss: 2.68571
Epoch 6, Val Loss: 2.67946
Epoch 7, Val Loss: 2.67946
Epoch 8, Val Loss: 2.67946
Epoch 9, Val Loss: 2.67946
Epoch 10, Val Loss: 2.67946
Epoch 11, Val Loss: 2.67945
Epoch 12, Val Loss: 2.68139
Epoch 13, Val Loss: 2.68139
Epoch 14, Val Loss: 2.68139
Epoch 15, Val Loss: 2.68139
Epoch 16, Val Loss: 2.68139
Epoch 17, Val Loss: 2.68139
Epoch 18, Val Loss: 2.68451
Epoch 19, Val Loss: 2.68451
Epoch 20, Val Loss: 2.68451
Epoch 21, Val Loss: 2.68451
Epoch 22, Val Loss: 2.68451
Epoch 23, Val Loss: 2.68451
Epoch 24, Val Loss: 2.68451
Epoch 25, Val Loss: 2.68451
Epoch 26, Val Loss: 2.68708
Epoch 27, Val Loss: 2.68708
Epoch 28, Val Loss: 2.68708
Epoch 29, Val Loss: 2.68708
Epoch 30, Val Loss: 2.68708
Epoch 31, Val Loss: 2.68708
Epoch 32, Val Loss: 2.68708
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.679225, 'Log Loss - std': 0.025635656320835403} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.67284
Epoch 1, Val Loss: 2.67311
Epoch 2, Val Loss: 2.67348
Epoch 3, Val Loss: 2.67348
Epoch 4, Val Loss: 2.67348
Epoch 5, Val Loss: 2.67348
Epoch 6, Val Loss: 2.67348
Epoch 7, Val Loss: 2.67348
Epoch 8, Val Loss: 2.66896
Epoch 9, Val Loss: 2.68855
Epoch 10, Val Loss: 2.68865
Epoch 11, Val Loss: 2.68865
Epoch 12, Val Loss: 2.68865
Epoch 13, Val Loss: 2.68865
Epoch 14, Val Loss: 2.68865
Epoch 15, Val Loss: 2.68865
Epoch 16, Val Loss: 2.68865
Epoch 17, Val Loss: 2.68865
Epoch 18, Val Loss: 2.68865
Epoch 19, Val Loss: 2.68865
Epoch 20, Val Loss: 2.68865
Epoch 21, Val Loss: 2.68938
Epoch 22, Val Loss: 2.68938
Epoch 23, Val Loss: 2.68938
Epoch 24, Val Loss: 2.68938
Epoch 25, Val Loss: 2.68938
Epoch 26, Val Loss: 2.68938
Epoch 27, Val Loss: 2.68938
Epoch 28, Val Loss: 2.68938
Epoch 29, Val Loss: 2.68534
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.662, 'Log Loss - std': 0.04138299167532467} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 34 finished with value: 10.662 and parameters: {'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19740245907763318, 'alpha': 4.627051259911111, 'K': 10, 'beta': 2.3071934242187737}
Fitted encoder
Epoch 0, Val Loss: 2.42035
Epoch 1, Val Loss: 2.39655
Epoch 2, Val Loss: 2.37462
Epoch 3, Val Loss: 2.38864
Epoch 4, Val Loss: 2.35756
Epoch 5, Val Loss: 2.28447
Epoch 6, Val Loss: 2.29298
Epoch 7, Val Loss: 2.27383
Epoch 8, Val Loss: 2.26944
Epoch 9, Val Loss: 2.27523
Epoch 10, Val Loss: 2.25178
Epoch 11, Val Loss: 2.26339
Epoch 12, Val Loss: 2.34382
Epoch 13, Val Loss: 2.29349
Epoch 14, Val Loss: 2.26498
Epoch 15, Val Loss: 2.27282
Epoch 16, Val Loss: 2.25233
Epoch 17, Val Loss: 2.27472
Epoch 18, Val Loss: 2.27135
Epoch 19, Val Loss: 2.25806
Epoch 20, Val Loss: 2.25315
Epoch 21, Val Loss: 2.26401
Epoch 22, Val Loss: 2.28798
Epoch 23, Val Loss: 2.26575
Epoch 24, Val Loss: 2.27497
Epoch 25, Val Loss: 2.28209
Epoch 26, Val Loss: 2.26381
Epoch 27, Val Loss: 2.26753
Epoch 28, Val Loss: 2.29634
Epoch 29, Val Loss: 2.26443
Epoch 30, Val Loss: 2.27612
Epoch 31, Val Loss: 2.28403
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.8338, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19740245907763318, 'alpha': 4.627051259911111, 'K': 10, 'beta': 2.3071934242187737}
Fitted encoder
Epoch 0, Val Loss: 2.28879
Epoch 1, Val Loss: 2.24385
Epoch 2, Val Loss: 2.31884
Epoch 3, Val Loss: 2.22823
Epoch 4, Val Loss: 2.18448
Epoch 5, Val Loss: 2.24896
Epoch 6, Val Loss: 2.20237
Epoch 7, Val Loss: 2.25124
Epoch 8, Val Loss: 2.26801
Epoch 9, Val Loss: 2.16517
Epoch 10, Val Loss: 2.19048
Epoch 11, Val Loss: 2.16539
Epoch 12, Val Loss: 2.18723
Epoch 13, Val Loss: 2.19532
Epoch 14, Val Loss: 2.19443
Epoch 15, Val Loss: 2.22514
Epoch 16, Val Loss: 2.22227
Epoch 17, Val Loss: 2.18048
Epoch 18, Val Loss: 2.19054
Epoch 19, Val Loss: 2.15861
Epoch 20, Val Loss: 2.18301
Epoch 21, Val Loss: 2.14787
Epoch 22, Val Loss: 2.17441
Epoch 23, Val Loss: 2.21348
Epoch 24, Val Loss: 2.19181
Epoch 25, Val Loss: 2.25834
Epoch 26, Val Loss: 2.16869
Epoch 27, Val Loss: 2.15644
Epoch 28, Val Loss: 2.16180
Epoch 29, Val Loss: 2.31937
Epoch 30, Val Loss: 2.17896
Epoch 31, Val Loss: 2.18945
Epoch 32, Val Loss: 2.19723
Epoch 33, Val Loss: 2.16409
Epoch 34, Val Loss: 2.17325
Epoch 35, Val Loss: 2.16447
Epoch 36, Val Loss: 2.21939
Epoch 37, Val Loss: 2.22636
Epoch 38, Val Loss: 2.15528
Epoch 39, Val Loss: 2.22317
Epoch 40, Val Loss: 2.18859
Epoch 41, Val Loss: 2.17208
Epoch 42, Val Loss: 2.37846
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.3361, 'Log Loss - std': 0.49770000000000003} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19740245907763318, 'alpha': 4.627051259911111, 'K': 10, 'beta': 2.3071934242187737}
Fitted encoder
Epoch 0, Val Loss: 2.36017
Epoch 1, Val Loss: 2.34403
Epoch 2, Val Loss: 2.36799
Epoch 3, Val Loss: 2.45899
Epoch 4, Val Loss: 2.42970
Epoch 5, Val Loss: 2.39945
Epoch 6, Val Loss: 2.38353
Epoch 7, Val Loss: 2.36926
Epoch 8, Val Loss: 2.35679
Epoch 9, Val Loss: 2.34412
Epoch 10, Val Loss: 2.29982
Epoch 11, Val Loss: 2.29994
Epoch 12, Val Loss: 2.33513
Epoch 13, Val Loss: 2.31897
Epoch 14, Val Loss: 2.23029
Epoch 15, Val Loss: 2.26072
Epoch 16, Val Loss: 2.21082
Epoch 17, Val Loss: 2.28437
Epoch 18, Val Loss: 2.21699
Epoch 19, Val Loss: 2.31922
Epoch 20, Val Loss: 2.22615
Epoch 21, Val Loss: 2.18140
Epoch 22, Val Loss: 2.22818
Epoch 23, Val Loss: 2.17447
Epoch 24, Val Loss: 2.24380
Epoch 25, Val Loss: 2.22539
Epoch 26, Val Loss: 2.18718
Epoch 27, Val Loss: 2.21981
Epoch 28, Val Loss: 2.18601
Epoch 29, Val Loss: 2.22768
Epoch 30, Val Loss: 2.21539
Epoch 31, Val Loss: 2.24001
Epoch 32, Val Loss: 2.22619
Epoch 33, Val Loss: 2.19509
Epoch 34, Val Loss: 2.21380
Epoch 35, Val Loss: 2.30304
Epoch 36, Val Loss: 2.22480
Epoch 37, Val Loss: 2.19703
Epoch 38, Val Loss: 2.20970
Epoch 39, Val Loss: 2.19959
Epoch 40, Val Loss: 2.25623
Epoch 41, Val Loss: 2.21719
Epoch 42, Val Loss: 2.24220
Epoch 43, Val Loss: 2.18774
Epoch 44, Val Loss: 2.19319
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.2879, 'Log Loss - std': 0.41204773995254484} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19740245907763318, 'alpha': 4.627051259911111, 'K': 10, 'beta': 2.3071934242187737}
Fitted encoder
Epoch 0, Val Loss: 2.28956
Epoch 1, Val Loss: 2.29852
Epoch 2, Val Loss: 2.28632
Epoch 3, Val Loss: 2.30335
Epoch 4, Val Loss: 2.26922
Epoch 5, Val Loss: 2.31285
Epoch 6, Val Loss: 2.25997
Epoch 7, Val Loss: 2.23949
Epoch 8, Val Loss: 2.25080
Epoch 9, Val Loss: 2.25034
Epoch 10, Val Loss: 2.24880
Epoch 11, Val Loss: 2.29534
Epoch 12, Val Loss: 2.22901
Epoch 13, Val Loss: 2.24971
Epoch 14, Val Loss: 2.26360
Epoch 15, Val Loss: 2.24423
Epoch 16, Val Loss: 2.24013
Epoch 17, Val Loss: 2.25130
Epoch 18, Val Loss: 2.22977
Epoch 19, Val Loss: 2.23742
Epoch 20, Val Loss: 2.23413
Epoch 21, Val Loss: 2.24039
Epoch 22, Val Loss: 2.24986
Epoch 23, Val Loss: 2.21302
Epoch 24, Val Loss: 2.20394
Epoch 25, Val Loss: 2.20487
Epoch 26, Val Loss: 2.26222
Epoch 27, Val Loss: 2.22042
Epoch 28, Val Loss: 2.19713
Epoch 29, Val Loss: 2.21795
Epoch 30, Val Loss: 2.19291
Epoch 31, Val Loss: 2.22637
Epoch 32, Val Loss: 2.19884
Epoch 33, Val Loss: 2.21885
Epoch 34, Val Loss: 2.24252
Epoch 35, Val Loss: 2.20424
Epoch 36, Val Loss: 2.19524
Epoch 37, Val Loss: 2.24923
Epoch 38, Val Loss: 2.20703
Epoch 39, Val Loss: 2.21271
Epoch 40, Val Loss: 2.20590
Epoch 41, Val Loss: 2.19167
Epoch 42, Val Loss: 2.20518
Epoch 43, Val Loss: 2.21146
Epoch 44, Val Loss: 2.22430
Epoch 45, Val Loss: 2.22061
Epoch 46, Val Loss: 2.19585
Epoch 47, Val Loss: 2.20518
Epoch 48, Val Loss: 2.29193
Epoch 49, Val Loss: 2.20227
Epoch 50, Val Loss: 2.25113
Epoch 51, Val Loss: 2.20364
Epoch 52, Val Loss: 2.19580
Epoch 53, Val Loss: 2.22197
Epoch 54, Val Loss: 2.23378
Epoch 55, Val Loss: 2.20381
Epoch 56, Val Loss: 2.19228
Epoch 57, Val Loss: 2.22091
Epoch 58, Val Loss: 2.21545
Epoch 59, Val Loss: 2.19401
Epoch 60, Val Loss: 2.19880
Epoch 61, Val Loss: 2.19806
Epoch 62, Val Loss: 2.18723
Epoch 63, Val Loss: 2.20886
Epoch 64, Val Loss: 2.20412
Epoch 65, Val Loss: 2.20525
Epoch 66, Val Loss: 2.19206
Epoch 67, Val Loss: 2.20294
Epoch 68, Val Loss: 2.20709
Epoch 69, Val Loss: 2.29866
Epoch 70, Val Loss: 2.21924
Epoch 71, Val Loss: 2.21134
Epoch 72, Val Loss: 2.20687
Epoch 73, Val Loss: 2.19828
Epoch 74, Val Loss: 2.19132
Epoch 75, Val Loss: 2.20467
Epoch 76, Val Loss: 2.18816
Epoch 77, Val Loss: 2.21337
Epoch 78, Val Loss: 2.20746
Epoch 79, Val Loss: 2.19988
Epoch 80, Val Loss: 2.19383
Epoch 81, Val Loss: 2.21747
Epoch 82, Val Loss: 2.19037
Epoch 83, Val Loss: 2.18752
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.305225, 'Log Loss - std': 0.3581032977717463} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.19740245907763318, 'alpha': 4.627051259911111, 'K': 10, 'beta': 2.3071934242187737}
Fitted encoder
Epoch 0, Val Loss: 2.27770
Epoch 1, Val Loss: 2.27075
Epoch 2, Val Loss: 2.32481
Epoch 3, Val Loss: 2.35132
Epoch 4, Val Loss: 2.24674
Epoch 5, Val Loss: 2.31358
Epoch 6, Val Loss: 2.30114
Epoch 7, Val Loss: 2.28852
Epoch 8, Val Loss: 2.39476
Epoch 9, Val Loss: 2.26607
Epoch 10, Val Loss: 2.27955
Epoch 11, Val Loss: 2.27267
Epoch 12, Val Loss: 2.29088
Epoch 13, Val Loss: 2.29101
Epoch 14, Val Loss: 2.27548
Epoch 15, Val Loss: 2.38517
Epoch 16, Val Loss: 2.32610
Epoch 17, Val Loss: 2.28039
Epoch 18, Val Loss: 2.24654
Epoch 19, Val Loss: 2.29013
Epoch 20, Val Loss: 2.24763
Epoch 21, Val Loss: 2.23350
Epoch 22, Val Loss: 2.26149
Epoch 23, Val Loss: 2.25145
Epoch 24, Val Loss: 2.25857
Epoch 25, Val Loss: 2.31452
Epoch 26, Val Loss: 2.23034
Epoch 27, Val Loss: 2.26928
Epoch 28, Val Loss: 2.20572
Epoch 29, Val Loss: 2.23027
Epoch 30, Val Loss: 2.32544
Epoch 31, Val Loss: 2.31961
Epoch 32, Val Loss: 2.33434
Epoch 33, Val Loss: 2.20768
Epoch 34, Val Loss: 2.22407
Epoch 35, Val Loss: 2.19732
Epoch 36, Val Loss: 2.36844
Epoch 37, Val Loss: 2.27916
Epoch 38, Val Loss: 2.37353
Epoch 39, Val Loss: 2.26013
Epoch 40, Val Loss: 2.27268
Epoch 41, Val Loss: 2.24263
Epoch 42, Val Loss: 2.25750
Epoch 43, Val Loss: 2.27240
Epoch 44, Val Loss: 2.28863
Epoch 45, Val Loss: 2.40022
Epoch 46, Val Loss: 2.31106
Epoch 47, Val Loss: 2.29191
Epoch 48, Val Loss: 2.28232
Epoch 49, Val Loss: 2.28724
Epoch 50, Val Loss: 2.26953
Epoch 51, Val Loss: 2.28140
Epoch 52, Val Loss: 2.26299
Epoch 53, Val Loss: 2.32150
Epoch 54, Val Loss: 2.26286
Epoch 55, Val Loss: 2.25436
Epoch 56, Val Loss: 2.33386
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.2471, 'Log Loss - std': 0.34074101602243306} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 35 finished with value: 2.2471 and parameters: {'p_m': 0.19740245907763318, 'alpha': 4.627051259911111, 'K': 10, 'beta': 2.3071934242187737}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2369282541676611, 'alpha': 3.4505538099599065, 'K': 10, 'beta': 0.6318328691593615}
Fitted encoder
Epoch 0, Val Loss: 2.68148
Epoch 1, Val Loss: 2.68396
Epoch 2, Val Loss: 2.68396
Epoch 3, Val Loss: 2.68396
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.67241
Epoch 8, Val Loss: 2.67293
Epoch 9, Val Loss: 2.67302
Epoch 10, Val Loss: 2.67302
Epoch 11, Val Loss: 2.67302
Epoch 12, Val Loss: 2.67302
Epoch 13, Val Loss: 2.67302
Epoch 14, Val Loss: 2.67302
Epoch 15, Val Loss: 2.67302
Epoch 16, Val Loss: 2.67302
Epoch 17, Val Loss: 2.68497
Epoch 18, Val Loss: 2.68497
Epoch 19, Val Loss: 2.68460
Epoch 20, Val Loss: 2.68460
Epoch 21, Val Loss: 2.68460
Epoch 22, Val Loss: 2.68460
Epoch 23, Val Loss: 2.68460
Epoch 24, Val Loss: 2.68460
Epoch 25, Val Loss: 2.68368
Epoch 26, Val Loss: 2.68368
Epoch 27, Val Loss: 2.68368
Epoch 28, Val Loss: 2.68368
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6506, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2369282541676611, 'alpha': 3.4505538099599065, 'K': 10, 'beta': 0.6318328691593615}
Fitted encoder
Epoch 0, Val Loss: 2.68752
Epoch 1, Val Loss: 2.68753
Epoch 2, Val Loss: 2.68745
Epoch 3, Val Loss: 2.68745
Epoch 4, Val Loss: 2.68745
Epoch 5, Val Loss: 2.68745
Epoch 6, Val Loss: 2.68745
Epoch 7, Val Loss: 2.68745
Epoch 8, Val Loss: 2.68745
Epoch 9, Val Loss: 2.68745
Epoch 10, Val Loss: 2.68745
Epoch 11, Val Loss: 2.68745
Epoch 12, Val Loss: 2.68745
Epoch 13, Val Loss: 2.68543
Epoch 14, Val Loss: 2.68543
Epoch 15, Val Loss: 2.68543
Epoch 16, Val Loss: 2.68543
Epoch 17, Val Loss: 2.68543
Epoch 18, Val Loss: 2.68368
Epoch 19, Val Loss: 2.68368
Epoch 20, Val Loss: 2.68368
Epoch 21, Val Loss: 2.68368
Epoch 22, Val Loss: 2.68368
Epoch 23, Val Loss: 2.68368
Epoch 24, Val Loss: 2.68368
Epoch 25, Val Loss: 2.68102
Epoch 26, Val Loss: 2.68102
Epoch 27, Val Loss: 2.68102
Epoch 28, Val Loss: 2.68102
Epoch 29, Val Loss: 2.68102
Epoch 30, Val Loss: 2.68102
Epoch 31, Val Loss: 2.68102
Epoch 32, Val Loss: 2.68102
Epoch 33, Val Loss: 2.68102
Epoch 34, Val Loss: 2.68102
Epoch 35, Val Loss: 2.68102
Epoch 36, Val Loss: 2.68102
Epoch 37, Val Loss: 2.68102
Epoch 38, Val Loss: 2.68102
Epoch 39, Val Loss: 2.68102
Epoch 40, Val Loss: 2.68102
Epoch 41, Val Loss: 2.48167
Epoch 42, Val Loss: 2.47257
Epoch 43, Val Loss: 2.46868
Epoch 44, Val Loss: 2.45838
Epoch 45, Val Loss: 2.45711
Epoch 46, Val Loss: 2.44505
Epoch 47, Val Loss: 2.37507
Epoch 48, Val Loss: 2.42086
Epoch 49, Val Loss: 2.44186
Epoch 50, Val Loss: 2.39937
Epoch 51, Val Loss: 2.44101
Epoch 52, Val Loss: 2.38260
Epoch 53, Val Loss: 2.42791
Epoch 54, Val Loss: 2.39978
Epoch 55, Val Loss: 2.38263
Epoch 56, Val Loss: 2.38503
Epoch 57, Val Loss: 2.37617
Epoch 58, Val Loss: 2.41234
Epoch 59, Val Loss: 2.36613
Epoch 60, Val Loss: 2.34510
Epoch 61, Val Loss: 2.39077
Epoch 62, Val Loss: 2.33097
Epoch 63, Val Loss: 2.32479
Epoch 64, Val Loss: 2.27345
Epoch 65, Val Loss: 2.26810
Epoch 66, Val Loss: 2.25291
Epoch 67, Val Loss: 2.23916
Epoch 68, Val Loss: 2.27810
Epoch 69, Val Loss: 2.24043
Epoch 70, Val Loss: 2.26638
Epoch 71, Val Loss: 2.24200
Epoch 72, Val Loss: 2.28643
Epoch 73, Val Loss: 2.26301
Epoch 74, Val Loss: 2.24969
Epoch 75, Val Loss: 2.26252
Epoch 76, Val Loss: 2.24517
Epoch 77, Val Loss: 2.23284
Epoch 78, Val Loss: 2.26082
Epoch 79, Val Loss: 2.26937
Epoch 80, Val Loss: 2.24131
Epoch 81, Val Loss: 2.27766
Epoch 82, Val Loss: 2.25806
Epoch 83, Val Loss: 2.24678
Epoch 84, Val Loss: 2.25337
Epoch 85, Val Loss: 2.23948
Epoch 86, Val Loss: 2.24294
Epoch 87, Val Loss: 2.28333
Epoch 88, Val Loss: 2.28928
Epoch 89, Val Loss: 2.29053
Epoch 90, Val Loss: 2.34408
Epoch 91, Val Loss: 2.25867
Epoch 92, Val Loss: 2.25307
Epoch 93, Val Loss: 2.28413
Epoch 94, Val Loss: 2.30238
Epoch 95, Val Loss: 2.32193
Epoch 96, Val Loss: 2.37688
Epoch 97, Val Loss: 2.32436
Epoch 98, Val Loss: 2.25323
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 7.01735, 'Log Loss - std': 3.6332500000000003} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2369282541676611, 'alpha': 3.4505538099599065, 'K': 10, 'beta': 0.6318328691593615}
Fitted encoder
Epoch 0, Val Loss: 2.67707
Epoch 1, Val Loss: 2.67707
Epoch 2, Val Loss: 2.67707
Epoch 3, Val Loss: 2.67707
Epoch 4, Val Loss: 2.67707
Epoch 5, Val Loss: 2.67707
Epoch 6, Val Loss: 2.68295
Epoch 7, Val Loss: 2.68295
Epoch 8, Val Loss: 2.68295
Epoch 9, Val Loss: 2.68295
Epoch 10, Val Loss: 2.68295
Epoch 11, Val Loss: 2.68295
Epoch 12, Val Loss: 2.68295
Epoch 13, Val Loss: 2.68295
Epoch 14, Val Loss: 2.68396
Epoch 15, Val Loss: 2.68396
Epoch 16, Val Loss: 2.68396
Epoch 17, Val Loss: 2.68396
Epoch 18, Val Loss: 2.68396
Epoch 19, Val Loss: 2.68396
Epoch 20, Val Loss: 2.68396
Epoch 21, Val Loss: 2.68396
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.247666666666667, 'Log Loss - std': 3.439141643233413} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2369282541676611, 'alpha': 3.4505538099599065, 'K': 10, 'beta': 0.6318328691593615}
Fitted encoder
Epoch 0, Val Loss: 2.61507
Epoch 1, Val Loss: 2.68497
Epoch 2, Val Loss: 2.68497
Epoch 3, Val Loss: 2.68497
Epoch 4, Val Loss: 2.68497
Epoch 5, Val Loss: 2.68497
Epoch 6, Val Loss: 2.68497
Epoch 7, Val Loss: 2.68497
Epoch 8, Val Loss: 2.68497
Epoch 9, Val Loss: 2.68497
Epoch 10, Val Loss: 2.68497
Epoch 11, Val Loss: 2.68497
Epoch 12, Val Loss: 2.61243
Epoch 13, Val Loss: 2.64791
Epoch 14, Val Loss: 2.68506
Epoch 15, Val Loss: 2.68506
Epoch 16, Val Loss: 2.68506
Epoch 17, Val Loss: 2.68506
Epoch 18, Val Loss: 2.67881
Epoch 19, Val Loss: 2.67881
Epoch 20, Val Loss: 2.67881
Epoch 21, Val Loss: 2.67881
Epoch 22, Val Loss: 2.67881
Epoch 23, Val Loss: 2.67881
Epoch 24, Val Loss: 2.67881
Epoch 25, Val Loss: 2.67881
Epoch 26, Val Loss: 2.67881
Epoch 27, Val Loss: 2.67881
Epoch 28, Val Loss: 2.67881
Epoch 29, Val Loss: 2.67881
Epoch 30, Val Loss: 2.67881
Epoch 31, Val Loss: 2.67881
Epoch 32, Val Loss: 2.67881
Epoch 33, Val Loss: 2.67881
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.64885, 'Log Loss - std': 3.0583681322725034} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2369282541676611, 'alpha': 3.4505538099599065, 'K': 10, 'beta': 0.6318328691593615}
Fitted encoder
Epoch 0, Val Loss: 2.68533
Epoch 1, Val Loss: 2.68194
Epoch 2, Val Loss: 2.68194
Epoch 3, Val Loss: 2.68194
Epoch 4, Val Loss: 2.68194
Epoch 5, Val Loss: 2.68194
Epoch 6, Val Loss: 2.68194
Epoch 7, Val Loss: 2.68194
Epoch 8, Val Loss: 2.68194
Epoch 9, Val Loss: 2.68194
Epoch 10, Val Loss: 2.68194
Epoch 11, Val Loss: 2.68194
Epoch 12, Val Loss: 2.68194
Epoch 13, Val Loss: 2.68194
Epoch 14, Val Loss: 2.68194
Epoch 15, Val Loss: 2.68194
Epoch 16, Val Loss: 2.68194
Epoch 17, Val Loss: 2.68194
Epoch 18, Val Loss: 2.68194
Epoch 19, Val Loss: 2.68194
Epoch 20, Val Loss: 2.68194
Epoch 21, Val Loss: 2.67348
Epoch 22, Val Loss: 2.67348
Epoch 23, Val Loss: 2.67348
Epoch 24, Val Loss: 2.67348
Epoch 25, Val Loss: 2.67348
Epoch 26, Val Loss: 2.67348
Epoch 27, Val Loss: 2.67348
Epoch 28, Val Loss: 2.67348
Epoch 29, Val Loss: 2.67348
Epoch 30, Val Loss: 2.67348
Epoch 31, Val Loss: 2.67348
Epoch 32, Val Loss: 2.67348
Epoch 33, Val Loss: 2.67348
Epoch 34, Val Loss: 2.67348
Epoch 35, Val Loss: 2.67348
Epoch 36, Val Loss: 2.67348
Epoch 37, Val Loss: 2.68194
Epoch 38, Val Loss: 2.68194
Epoch 39, Val Loss: 2.68194
Epoch 40, Val Loss: 2.68194
Epoch 41, Val Loss: 2.68194
Epoch 42, Val Loss: 2.68194
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.05242, 'Log Loss - std': 2.852081255083733} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 36 finished with value: 9.05242 and parameters: {'p_m': 0.2369282541676611, 'alpha': 3.4505538099599065, 'K': 10, 'beta': 0.6318328691593615}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6266925333308581, 'alpha': 4.7395453579961355, 'K': 15, 'beta': 1.44180742499534}
Fitted encoder
Epoch 0, Val Loss: 2.30086
Epoch 1, Val Loss: 2.27787
Epoch 2, Val Loss: 2.24153
Epoch 3, Val Loss: 2.21436
Epoch 4, Val Loss: 2.26503
Epoch 5, Val Loss: 2.22235
Epoch 6, Val Loss: 2.18999
Epoch 7, Val Loss: 2.19628
Epoch 8, Val Loss: 2.27555
Epoch 9, Val Loss: 2.17067
Epoch 10, Val Loss: 2.18861
Epoch 11, Val Loss: 2.21087
Epoch 12, Val Loss: 2.17410
Epoch 13, Val Loss: 2.19199
Epoch 14, Val Loss: 2.17641
Epoch 15, Val Loss: 2.40903
Epoch 16, Val Loss: 2.19485
Epoch 17, Val Loss: 2.19133
Epoch 18, Val Loss: 2.18310
Epoch 19, Val Loss: 2.16933
Epoch 20, Val Loss: 2.17922
Epoch 21, Val Loss: 2.32377
Epoch 22, Val Loss: 2.19500
Epoch 23, Val Loss: 2.22311
Epoch 24, Val Loss: 2.25725
Epoch 25, Val Loss: 2.20177
Epoch 26, Val Loss: 2.14958
Epoch 27, Val Loss: 2.16755
Epoch 28, Val Loss: 2.19807
Epoch 29, Val Loss: 2.17311
Epoch 30, Val Loss: 2.17098
Epoch 31, Val Loss: 2.22019
Epoch 32, Val Loss: 2.17889
Epoch 33, Val Loss: 2.17382
Epoch 34, Val Loss: 2.21440
Epoch 35, Val Loss: 2.17343
Epoch 36, Val Loss: 2.20643
Epoch 37, Val Loss: 2.16491
Epoch 38, Val Loss: 2.18441
Epoch 39, Val Loss: 2.17527
Epoch 40, Val Loss: 2.43561
Epoch 41, Val Loss: 2.22869
Epoch 42, Val Loss: 2.16629
Epoch 43, Val Loss: 2.18906
Epoch 44, Val Loss: 2.15512
Epoch 45, Val Loss: 2.19194
Epoch 46, Val Loss: 2.15230
Epoch 47, Val Loss: 2.16723
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.0919, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6266925333308581, 'alpha': 4.7395453579961355, 'K': 15, 'beta': 1.44180742499534}
Fitted encoder
Epoch 0, Val Loss: 2.68093
Epoch 1, Val Loss: 2.68093
Epoch 2, Val Loss: 2.68093
Epoch 3, Val Loss: 2.68093
Epoch 4, Val Loss: 2.68093
Epoch 5, Val Loss: 2.68093
Epoch 6, Val Loss: 2.68093
Epoch 7, Val Loss: 2.68093
Epoch 8, Val Loss: 2.68093
Epoch 9, Val Loss: 2.68093
Epoch 10, Val Loss: 2.68093
Epoch 11, Val Loss: 2.63152
Epoch 12, Val Loss: 2.68267
Epoch 13, Val Loss: 2.68267
Epoch 14, Val Loss: 2.68267
Epoch 15, Val Loss: 2.68267
Epoch 16, Val Loss: 2.68258
Epoch 17, Val Loss: 2.68267
Epoch 18, Val Loss: 2.68267
Epoch 19, Val Loss: 2.68267
Epoch 20, Val Loss: 2.68267
Epoch 21, Val Loss: 2.68267
Epoch 22, Val Loss: 2.68267
Epoch 23, Val Loss: 2.68267
Epoch 24, Val Loss: 2.68267
Epoch 25, Val Loss: 2.68267
Epoch 26, Val Loss: 2.68267
Epoch 27, Val Loss: 2.68644
Epoch 28, Val Loss: 2.68644
Epoch 29, Val Loss: 2.68644
Epoch 30, Val Loss: 2.68644
Epoch 31, Val Loss: 2.68644
Epoch 32, Val Loss: 2.68644
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 6.02905, 'Log Loss - std': 3.9371500000000004} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6266925333308581, 'alpha': 4.7395453579961355, 'K': 15, 'beta': 1.44180742499534}
Fitted encoder
Epoch 0, Val Loss: 2.38009
Epoch 1, Val Loss: 2.39394
Epoch 2, Val Loss: 2.36947
Epoch 3, Val Loss: 2.36981
Epoch 4, Val Loss: 2.34140
Epoch 5, Val Loss: 2.37529
Epoch 6, Val Loss: 2.38596
Epoch 7, Val Loss: 2.39001
Epoch 8, Val Loss: 2.37397
Epoch 9, Val Loss: 2.38969
Epoch 10, Val Loss: 2.45537
Epoch 11, Val Loss: 2.31250
Epoch 12, Val Loss: 2.40340
Epoch 13, Val Loss: 2.30828
Epoch 14, Val Loss: 2.25751
Epoch 15, Val Loss: 2.41634
Epoch 16, Val Loss: 2.24704
Epoch 17, Val Loss: 2.29832
Epoch 18, Val Loss: 2.26725
Epoch 19, Val Loss: 2.32610
Epoch 20, Val Loss: 2.31803
Epoch 21, Val Loss: 2.34046
Epoch 22, Val Loss: 2.28399
Epoch 23, Val Loss: 2.28363
Epoch 24, Val Loss: 2.28570
Epoch 25, Val Loss: 2.25935
Epoch 26, Val Loss: 2.22215
Epoch 27, Val Loss: 2.22234
Epoch 28, Val Loss: 2.26899
Epoch 29, Val Loss: 2.26253
Epoch 30, Val Loss: 2.23625
Epoch 31, Val Loss: 2.25189
Epoch 32, Val Loss: 2.23241
Epoch 33, Val Loss: 2.22637
Epoch 34, Val Loss: 2.22928
Epoch 35, Val Loss: 2.34912
Epoch 36, Val Loss: 2.20527
Epoch 37, Val Loss: 2.23172
Epoch 38, Val Loss: 2.24820
Epoch 39, Val Loss: 2.29232
Epoch 40, Val Loss: 2.48384
Epoch 41, Val Loss: 2.28084
Epoch 42, Val Loss: 2.27766
Epoch 43, Val Loss: 2.26106
Epoch 44, Val Loss: 2.27384
Epoch 45, Val Loss: 2.32556
Epoch 46, Val Loss: 2.28670
Epoch 47, Val Loss: 2.29153
Epoch 48, Val Loss: 2.30159
Epoch 49, Val Loss: 2.28705
Epoch 50, Val Loss: 2.29783
Epoch 51, Val Loss: 2.29189
Epoch 52, Val Loss: 2.28596
Epoch 53, Val Loss: 2.30550
Epoch 54, Val Loss: 2.28390
Epoch 55, Val Loss: 2.28433
Epoch 56, Val Loss: 2.21763
Epoch 57, Val Loss: 2.30883
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.7495, 'Log Loss - std': 3.6889831236624913} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6266925333308581, 'alpha': 4.7395453579961355, 'K': 15, 'beta': 1.44180742499534}
Fitted encoder
Epoch 0, Val Loss: 2.37553
Epoch 1, Val Loss: 2.32854
Epoch 2, Val Loss: 2.28199
Epoch 3, Val Loss: 2.25679
Epoch 4, Val Loss: 2.26465
Epoch 5, Val Loss: 2.28414
Epoch 6, Val Loss: 2.34791
Epoch 7, Val Loss: 2.36319
Epoch 8, Val Loss: 2.23952
Epoch 9, Val Loss: 2.25561
Epoch 10, Val Loss: 2.27860
Epoch 11, Val Loss: 2.28366
Epoch 12, Val Loss: 2.25996
Epoch 13, Val Loss: 2.28276
Epoch 14, Val Loss: 2.29242
Epoch 15, Val Loss: 2.24545
Epoch 16, Val Loss: 2.26227
Epoch 17, Val Loss: 2.26527
Epoch 18, Val Loss: 2.26692
Epoch 19, Val Loss: 2.31841
Epoch 20, Val Loss: 2.24608
Epoch 21, Val Loss: 2.23518
Epoch 22, Val Loss: 2.29733
Epoch 23, Val Loss: 2.27380
Epoch 24, Val Loss: 2.24612
Epoch 25, Val Loss: 2.31282
Epoch 26, Val Loss: 2.27068
Epoch 27, Val Loss: 2.28463
Epoch 28, Val Loss: 2.26019
Epoch 29, Val Loss: 2.24164
Epoch 30, Val Loss: 2.26625
Epoch 31, Val Loss: 2.30027
Epoch 32, Val Loss: 2.26938
Epoch 33, Val Loss: 2.24528
Epoch 34, Val Loss: 2.24619
Epoch 35, Val Loss: 2.32831
Epoch 36, Val Loss: 2.27537
Epoch 37, Val Loss: 2.25563
Epoch 38, Val Loss: 2.26698
Epoch 39, Val Loss: 2.25176
Epoch 40, Val Loss: 2.26587
Epoch 41, Val Loss: 2.24474
Epoch 42, Val Loss: 2.26174
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.447875, 'Log Loss - std': 3.2371870948209036} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.6266925333308581, 'alpha': 4.7395453579961355, 'K': 15, 'beta': 1.44180742499534}
Fitted encoder
Epoch 0, Val Loss: 2.43291
Epoch 1, Val Loss: 2.37272
Epoch 2, Val Loss: 2.37565
Epoch 3, Val Loss: 2.36629
Epoch 4, Val Loss: 2.32622
Epoch 5, Val Loss: 2.31376
Epoch 6, Val Loss: 2.31295
Epoch 7, Val Loss: 2.34763
Epoch 8, Val Loss: 2.35973
Epoch 9, Val Loss: 2.32261
Epoch 10, Val Loss: 2.29447
Epoch 11, Val Loss: 2.32118
Epoch 12, Val Loss: 2.35057
Epoch 13, Val Loss: 2.33630
Epoch 14, Val Loss: 2.35597
Epoch 15, Val Loss: 2.29829
Epoch 16, Val Loss: 2.30098
Epoch 17, Val Loss: 2.29861
Epoch 18, Val Loss: 2.27851
Epoch 19, Val Loss: 2.37731
Epoch 20, Val Loss: 2.27974
Epoch 21, Val Loss: 2.30277
Epoch 22, Val Loss: 2.29742
Epoch 23, Val Loss: 2.30490
Epoch 24, Val Loss: 2.28009
Epoch 25, Val Loss: 2.33798
Epoch 26, Val Loss: 2.30177
Epoch 27, Val Loss: 2.41056
Epoch 28, Val Loss: 2.47344
Epoch 29, Val Loss: 2.27405
Epoch 30, Val Loss: 2.36010
Epoch 31, Val Loss: 2.27330
Epoch 32, Val Loss: 2.28213
Epoch 33, Val Loss: 2.31013
Epoch 34, Val Loss: 2.31813
Epoch 35, Val Loss: 2.27463
Epoch 36, Val Loss: 2.29712
Epoch 37, Val Loss: 2.30518
Epoch 38, Val Loss: 2.28394
Epoch 39, Val Loss: 2.29894
Epoch 40, Val Loss: 2.32176
Epoch 41, Val Loss: 2.26887
Epoch 42, Val Loss: 2.31124
Epoch 43, Val Loss: 2.33019
Epoch 44, Val Loss: 2.29105
Epoch 45, Val Loss: 2.27259
Epoch 46, Val Loss: 2.28282
Epoch 47, Val Loss: 2.28407
Epoch 48, Val Loss: 2.28577
Epoch 49, Val Loss: 2.30240
Epoch 50, Val Loss: 2.25583
Epoch 51, Val Loss: 2.27636
Epoch 52, Val Loss: 2.26116
Epoch 53, Val Loss: 2.25740
Epoch 54, Val Loss: 2.23925
Epoch 55, Val Loss: 2.31535
Epoch 56, Val Loss: 2.21881
Epoch 57, Val Loss: 2.21794
Epoch 58, Val Loss: 2.37110
Epoch 59, Val Loss: 2.21541
Epoch 60, Val Loss: 2.22348
Epoch 61, Val Loss: 2.21028
Epoch 62, Val Loss: 2.23713
Epoch 63, Val Loss: 2.20180
Epoch 64, Val Loss: 2.19931
Epoch 65, Val Loss: 2.22283
Epoch 66, Val Loss: 2.26871
Epoch 67, Val Loss: 2.23350
Epoch 68, Val Loss: 2.25054
Epoch 69, Val Loss: 2.21812
Epoch 70, Val Loss: 2.20087
Epoch 71, Val Loss: 2.22012
Epoch 72, Val Loss: 2.21318
Epoch 73, Val Loss: 2.22305
Epoch 74, Val Loss: 2.20230
Epoch 75, Val Loss: 2.25480
Epoch 76, Val Loss: 2.20887
Epoch 77, Val Loss: 2.22120
Epoch 78, Val Loss: 2.21444
Epoch 79, Val Loss: 2.19799
Epoch 80, Val Loss: 2.19863
Epoch 81, Val Loss: 2.21614
Epoch 82, Val Loss: 2.21558
Epoch 83, Val Loss: 2.20483
Epoch 84, Val Loss: 2.21502
Epoch 85, Val Loss: 2.19432
Epoch 86, Val Loss: 2.19733
Epoch 87, Val Loss: 2.20466
Epoch 88, Val Loss: 2.20636
Epoch 89, Val Loss: 2.26950
Epoch 90, Val Loss: 2.21679
Epoch 91, Val Loss: 2.20397
Epoch 92, Val Loss: 2.24633
Epoch 93, Val Loss: 2.19270
Epoch 94, Val Loss: 2.20594
Epoch 95, Val Loss: 2.21534
Epoch 96, Val Loss: 2.21376
Epoch 97, Val Loss: 2.19802
Epoch 98, Val Loss: 2.20529
Epoch 99, Val Loss: 2.21668
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.09994, 'Log Loss - std': 2.977874961511984} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 37 finished with value: 4.09994 and parameters: {'p_m': 0.6266925333308581, 'alpha': 4.7395453579961355, 'K': 15, 'beta': 1.44180742499534}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.46757243304183094, 'alpha': 6.347545543854008, 'K': 2, 'beta': 0.5543197007051761}
Fitted encoder
Epoch 0, Val Loss: 2.51815
Epoch 1, Val Loss: 2.61695
Epoch 2, Val Loss: 2.68497
Epoch 3, Val Loss: 2.68497
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.68396
Epoch 8, Val Loss: 2.68396
Epoch 9, Val Loss: 2.68396
Epoch 10, Val Loss: 2.68396
Epoch 11, Val Loss: 2.68396
Epoch 12, Val Loss: 2.68396
Epoch 13, Val Loss: 2.68607
Epoch 14, Val Loss: 2.68607
Epoch 15, Val Loss: 2.68607
Epoch 16, Val Loss: 2.68607
Epoch 17, Val Loss: 2.68607
Epoch 18, Val Loss: 2.68607
Epoch 19, Val Loss: 2.68607
Epoch 20, Val Loss: 2.68607
Epoch 21, Val Loss: 2.68607
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.3799, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.46757243304183094, 'alpha': 6.347545543854008, 'K': 2, 'beta': 0.5543197007051761}
Fitted encoder
Epoch 0, Val Loss: 2.68497
Epoch 1, Val Loss: 2.68497
Epoch 2, Val Loss: 2.68497
Epoch 3, Val Loss: 2.68497
Epoch 4, Val Loss: 2.68497
Epoch 5, Val Loss: 2.68497
Epoch 6, Val Loss: 2.68497
Epoch 7, Val Loss: 2.68497
Epoch 8, Val Loss: 2.68497
Epoch 9, Val Loss: 2.67504
Epoch 10, Val Loss: 2.67504
Epoch 11, Val Loss: 2.67504
Epoch 12, Val Loss: 2.67504
Epoch 13, Val Loss: 2.67504
Epoch 14, Val Loss: 2.67504
Epoch 15, Val Loss: 2.67504
Epoch 16, Val Loss: 2.67504
Epoch 17, Val Loss: 2.67504
Epoch 18, Val Loss: 2.67504
Epoch 19, Val Loss: 2.67504
Epoch 20, Val Loss: 2.68368
Epoch 21, Val Loss: 2.68368
Epoch 22, Val Loss: 2.68368
Epoch 23, Val Loss: 2.68368
Epoch 24, Val Loss: 2.68368
Epoch 25, Val Loss: 2.68368
Epoch 26, Val Loss: 2.68368
Epoch 27, Val Loss: 2.68368
Epoch 28, Val Loss: 2.68368
Epoch 29, Val Loss: 2.52165
Epoch 30, Val Loss: 2.35290
Epoch 31, Val Loss: 2.33772
Epoch 32, Val Loss: 2.31946
Epoch 33, Val Loss: 2.30558
Epoch 34, Val Loss: 2.32943
Epoch 35, Val Loss: 2.30609
Epoch 36, Val Loss: 2.30654
Epoch 37, Val Loss: 2.30324
Epoch 38, Val Loss: 2.31266
Epoch 39, Val Loss: 2.28865
Epoch 40, Val Loss: 2.31970
Epoch 41, Val Loss: 2.34983
Epoch 42, Val Loss: 2.34606
Epoch 43, Val Loss: 2.30580
Epoch 44, Val Loss: 2.29470
Epoch 45, Val Loss: 2.35579
Epoch 46, Val Loss: 2.30638
Epoch 47, Val Loss: 2.33677
Epoch 48, Val Loss: 2.41426
Epoch 49, Val Loss: 2.34597
Epoch 50, Val Loss: 2.29774
Epoch 51, Val Loss: 2.29469
Epoch 52, Val Loss: 2.29095
Epoch 53, Val Loss: 2.32962
Epoch 54, Val Loss: 2.39066
Epoch 55, Val Loss: 2.30873
Epoch 56, Val Loss: 2.29231
Epoch 57, Val Loss: 2.31047
Epoch 58, Val Loss: 2.30254
Epoch 59, Val Loss: 2.41604
Epoch 60, Val Loss: 2.34314
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 6.0015, 'Log Loss - std': 2.3783999999999996} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.46757243304183094, 'alpha': 6.347545543854008, 'K': 2, 'beta': 0.5543197007051761}
Fitted encoder
Epoch 0, Val Loss: 2.58766
Epoch 1, Val Loss: 2.67943
Epoch 2, Val Loss: 2.68001
Epoch 3, Val Loss: 2.68001
Epoch 4, Val Loss: 2.68001
Epoch 5, Val Loss: 2.68001
Epoch 6, Val Loss: 2.68001
Epoch 7, Val Loss: 2.68001
Epoch 8, Val Loss: 2.68001
Epoch 9, Val Loss: 2.68001
Epoch 10, Val Loss: 2.67707
Epoch 11, Val Loss: 2.67707
Epoch 12, Val Loss: 2.67707
Epoch 13, Val Loss: 2.67707
Epoch 14, Val Loss: 2.67707
Epoch 15, Val Loss: 2.67707
Epoch 16, Val Loss: 2.67707
Epoch 17, Val Loss: 2.67707
Epoch 18, Val Loss: 2.67707
Epoch 19, Val Loss: 2.67707
Epoch 20, Val Loss: 2.67707
Epoch 21, Val Loss: 2.67707
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 6.6759666666666675, 'Log Loss - std': 2.16356224982987} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.46757243304183094, 'alpha': 6.347545543854008, 'K': 2, 'beta': 0.5543197007051761}
Fitted encoder
Epoch 0, Val Loss: 2.67734
Epoch 1, Val Loss: 2.67734
Epoch 2, Val Loss: 2.68139
Epoch 3, Val Loss: 2.68571
Epoch 4, Val Loss: 2.68571
Epoch 5, Val Loss: 2.68571
Epoch 6, Val Loss: 2.68571
Epoch 7, Val Loss: 2.68571
Epoch 8, Val Loss: 2.68571
Epoch 9, Val Loss: 2.68571
Epoch 10, Val Loss: 2.68571
Epoch 11, Val Loss: 2.64484
Epoch 12, Val Loss: 2.63996
Epoch 13, Val Loss: 2.63918
Epoch 14, Val Loss: 2.63898
Epoch 15, Val Loss: 2.63905
Epoch 16, Val Loss: 2.63907
Epoch 17, Val Loss: 2.63908
Epoch 18, Val Loss: 2.63915
Epoch 19, Val Loss: 2.63909
Epoch 20, Val Loss: 2.63906
Epoch 21, Val Loss: 2.63915
Epoch 22, Val Loss: 2.63912
Epoch 23, Val Loss: 2.63913
Epoch 24, Val Loss: 2.63905
Epoch 25, Val Loss: 2.63902
Epoch 26, Val Loss: 2.63905
Epoch 27, Val Loss: 2.63908
Epoch 28, Val Loss: 2.63912
Epoch 29, Val Loss: 2.63907
Epoch 30, Val Loss: 2.63908
Epoch 31, Val Loss: 2.63909
Epoch 32, Val Loss: 2.63908
Epoch 33, Val Loss: 2.63912
Epoch 34, Val Loss: 2.63908
Epoch 35, Val Loss: 2.63908
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.667625000000001, 'Log Loss - std': 2.5614468483407964} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.46757243304183094, 'alpha': 6.347545543854008, 'K': 2, 'beta': 0.5543197007051761}
Fitted encoder
Epoch 0, Val Loss: 2.68267
Epoch 1, Val Loss: 2.68267
Epoch 2, Val Loss: 2.68267
Epoch 3, Val Loss: 2.68267
Epoch 4, Val Loss: 2.68265
Epoch 5, Val Loss: 2.68267
Epoch 6, Val Loss: 2.68267
Epoch 7, Val Loss: 2.68267
Epoch 8, Val Loss: 2.68267
Epoch 9, Val Loss: 2.68267
Epoch 10, Val Loss: 2.68267
Epoch 11, Val Loss: 2.68267
Epoch 12, Val Loss: 2.68525
Epoch 13, Val Loss: 2.68525
Epoch 14, Val Loss: 2.68524
Epoch 15, Val Loss: 2.68534
Epoch 16, Val Loss: 2.68534
Epoch 17, Val Loss: 2.68534
Epoch 18, Val Loss: 2.68534
Epoch 19, Val Loss: 2.68534
Epoch 20, Val Loss: 2.68534
Epoch 21, Val Loss: 2.68534
Epoch 22, Val Loss: 2.68534
Epoch 23, Val Loss: 2.68534
Epoch 24, Val Loss: 2.68534
Epoch 25, Val Loss: 2.68534
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 6.668140000000001, 'Log Loss - std': 3.041862756009876} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 38 finished with value: 6.668140000000001 and parameters: {'p_m': 0.46757243304183094, 'alpha': 6.347545543854008, 'K': 2, 'beta': 0.5543197007051761}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.17563521913403693, 'alpha': 2.196043081307617, 'K': 20, 'beta': 4.969885080333175}
Fitted encoder
Epoch 0, Val Loss: 2.68607
Epoch 1, Val Loss: 2.68607
Epoch 2, Val Loss: 2.67302
Epoch 3, Val Loss: 2.67302
Epoch 4, Val Loss: 2.67302
Epoch 5, Val Loss: 2.67302
Epoch 6, Val Loss: 2.67302
Epoch 7, Val Loss: 2.67302
Epoch 8, Val Loss: 2.67302
Epoch 9, Val Loss: 2.67302
Epoch 10, Val Loss: 2.67302
Epoch 11, Val Loss: 2.67302
Epoch 12, Val Loss: 2.67302
Epoch 13, Val Loss: 2.67302
Epoch 14, Val Loss: 2.67302
Epoch 15, Val Loss: 2.67302
Epoch 16, Val Loss: 2.67302
Epoch 17, Val Loss: 2.67302
Epoch 18, Val Loss: 2.67302
Epoch 19, Val Loss: 2.67302
Epoch 20, Val Loss: 2.67302
Epoch 21, Val Loss: 2.67302
Epoch 22, Val Loss: 2.68534
Epoch 23, Val Loss: 2.68534
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6613, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.17563521913403693, 'alpha': 2.196043081307617, 'K': 20, 'beta': 4.969885080333175}
Fitted encoder
Epoch 0, Val Loss: 2.27374
Epoch 1, Val Loss: 2.25848
Epoch 2, Val Loss: 2.22668
Epoch 3, Val Loss: 2.20173
Epoch 4, Val Loss: 2.22362
Epoch 5, Val Loss: 2.20592
Epoch 6, Val Loss: 2.19688
Epoch 7, Val Loss: 2.28780
Epoch 8, Val Loss: 2.19155
Epoch 9, Val Loss: 2.20372
Epoch 10, Val Loss: 2.20458
Epoch 11, Val Loss: 2.20585
Epoch 12, Val Loss: 2.21940
Epoch 13, Val Loss: 2.20318
Epoch 14, Val Loss: 2.23062
Epoch 15, Val Loss: 2.20700
Epoch 16, Val Loss: 2.20097
Epoch 17, Val Loss: 2.20036
Epoch 18, Val Loss: 2.20568
Epoch 19, Val Loss: 2.19744
Epoch 20, Val Loss: 2.20109
Epoch 21, Val Loss: 2.19609
Epoch 22, Val Loss: 2.20257
Epoch 23, Val Loss: 2.19607
Epoch 24, Val Loss: 2.20206
Epoch 25, Val Loss: 2.21342
Epoch 26, Val Loss: 2.24151
Epoch 27, Val Loss: 2.18701
Epoch 28, Val Loss: 2.19621
Epoch 29, Val Loss: 2.18788
Epoch 30, Val Loss: 2.17652
Epoch 31, Val Loss: 2.18738
Epoch 32, Val Loss: 2.22556
Epoch 33, Val Loss: 2.21278
Epoch 34, Val Loss: 2.18108
Epoch 35, Val Loss: 2.21351
Epoch 36, Val Loss: 2.20498
Epoch 37, Val Loss: 2.18637
Epoch 38, Val Loss: 2.19369
Epoch 39, Val Loss: 2.18506
Epoch 40, Val Loss: 2.19767
Epoch 41, Val Loss: 2.19753
Epoch 42, Val Loss: 2.22827
Epoch 43, Val Loss: 2.21831
Epoch 44, Val Loss: 2.18743
Epoch 45, Val Loss: 2.24245
Epoch 46, Val Loss: 2.19881
Epoch 47, Val Loss: 2.23753
Epoch 48, Val Loss: 2.21520
Epoch 49, Val Loss: 2.20196
Epoch 50, Val Loss: 2.21261
Epoch 51, Val Loss: 2.19898
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.8654, 'Log Loss - std': 4.7959000000000005} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.17563521913403693, 'alpha': 2.196043081307617, 'K': 20, 'beta': 4.969885080333175}
Fitted encoder
Epoch 0, Val Loss: 2.31403
Epoch 1, Val Loss: 2.24408
Epoch 2, Val Loss: 2.23761
Epoch 3, Val Loss: 2.23609
Epoch 4, Val Loss: 2.18692
Epoch 5, Val Loss: 2.22374
Epoch 6, Val Loss: 2.17220
Epoch 7, Val Loss: 2.19527
Epoch 8, Val Loss: 2.19026
Epoch 9, Val Loss: 2.18235
Epoch 10, Val Loss: 2.16584
Epoch 11, Val Loss: 2.16397
Epoch 12, Val Loss: 2.16947
Epoch 13, Val Loss: 2.14907
Epoch 14, Val Loss: 2.14954
Epoch 15, Val Loss: 2.19395
Epoch 16, Val Loss: 2.19541
Epoch 17, Val Loss: 2.23001
Epoch 18, Val Loss: 2.16736
Epoch 19, Val Loss: 2.17435
Epoch 20, Val Loss: 2.18056
Epoch 21, Val Loss: 2.17896
Epoch 22, Val Loss: 2.16094
Epoch 23, Val Loss: 2.18711
Epoch 24, Val Loss: 2.20095
Epoch 25, Val Loss: 2.18097
Epoch 26, Val Loss: 2.13457
Epoch 27, Val Loss: 2.15013
Epoch 28, Val Loss: 2.15422
Epoch 29, Val Loss: 2.16065
Epoch 30, Val Loss: 2.15198
Epoch 31, Val Loss: 2.15055
Epoch 32, Val Loss: 2.18400
Epoch 33, Val Loss: 2.20880
Epoch 34, Val Loss: 2.18320
Epoch 35, Val Loss: 2.18462
Epoch 36, Val Loss: 2.17717
Epoch 37, Val Loss: 2.14730
Epoch 38, Val Loss: 2.18253
Epoch 39, Val Loss: 2.15523
Epoch 40, Val Loss: 2.15171
Epoch 41, Val Loss: 2.17352
Epoch 42, Val Loss: 2.20147
Epoch 43, Val Loss: 2.16109
Epoch 44, Val Loss: 2.16630
Epoch 45, Val Loss: 2.15119
Epoch 46, Val Loss: 2.13886
Epoch 47, Val Loss: 2.17351
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.3993, 'Log Loss - std': 4.430876846253647} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.17563521913403693, 'alpha': 2.196043081307617, 'K': 20, 'beta': 4.969885080333175}
Fitted encoder
Epoch 0, Val Loss: 2.30864
Epoch 1, Val Loss: 2.27547
Epoch 2, Val Loss: 2.23761
Epoch 3, Val Loss: 2.19883
Epoch 4, Val Loss: 2.23950
Epoch 5, Val Loss: 2.20138
Epoch 6, Val Loss: 2.21521
Epoch 7, Val Loss: 2.21331
Epoch 8, Val Loss: 2.19478
Epoch 9, Val Loss: 2.18783
Epoch 10, Val Loss: 2.21824
Epoch 11, Val Loss: 2.20530
Epoch 12, Val Loss: 2.18788
Epoch 13, Val Loss: 2.17651
Epoch 14, Val Loss: 2.17354
Epoch 15, Val Loss: 2.17604
Epoch 16, Val Loss: 2.17964
Epoch 17, Val Loss: 2.18264
Epoch 18, Val Loss: 2.18818
Epoch 19, Val Loss: 2.16786
Epoch 20, Val Loss: 2.19374
Epoch 21, Val Loss: 2.16397
Epoch 22, Val Loss: 2.16897
Epoch 23, Val Loss: 2.18263
Epoch 24, Val Loss: 2.16798
Epoch 25, Val Loss: 2.21852
Epoch 26, Val Loss: 2.18765
Epoch 27, Val Loss: 2.16230
Epoch 28, Val Loss: 2.17230
Epoch 29, Val Loss: 2.29486
Epoch 30, Val Loss: 2.17082
Epoch 31, Val Loss: 2.24503
Epoch 32, Val Loss: 2.17197
Epoch 33, Val Loss: 2.15799
Epoch 34, Val Loss: 2.17500
Epoch 35, Val Loss: 2.16455
Epoch 36, Val Loss: 2.16226
Epoch 37, Val Loss: 2.17918
Epoch 38, Val Loss: 2.16641
Epoch 39, Val Loss: 2.17361
Epoch 40, Val Loss: 2.17280
Epoch 41, Val Loss: 2.16940
Epoch 42, Val Loss: 2.18326
Epoch 43, Val Loss: 2.21387
Epoch 44, Val Loss: 2.16662
Epoch 45, Val Loss: 2.18151
Epoch 46, Val Loss: 2.17545
Epoch 47, Val Loss: 2.15634
Epoch 48, Val Loss: 2.19595
Epoch 49, Val Loss: 2.19457
Epoch 50, Val Loss: 2.17352
Epoch 51, Val Loss: 2.17270
Epoch 52, Val Loss: 2.21553
Epoch 53, Val Loss: 2.19613
Epoch 54, Val Loss: 2.21741
Epoch 55, Val Loss: 2.18067
Epoch 56, Val Loss: 2.18793
Epoch 57, Val Loss: 2.17570
Epoch 58, Val Loss: 2.17414
Epoch 59, Val Loss: 2.17453
Epoch 60, Val Loss: 2.20103
Epoch 61, Val Loss: 2.17998
Epoch 62, Val Loss: 2.19699
Epoch 63, Val Loss: 2.20084
Epoch 64, Val Loss: 2.21256
Epoch 65, Val Loss: 2.18914
Epoch 66, Val Loss: 2.17613
Epoch 67, Val Loss: 2.20383
Epoch 68, Val Loss: 2.17754
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.564775, 'Log Loss - std': 4.10046316248238} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.17563521913403693, 'alpha': 2.196043081307617, 'K': 20, 'beta': 4.969885080333175}
Fitted encoder
Epoch 0, Val Loss: 2.33348
Epoch 1, Val Loss: 2.27400
Epoch 2, Val Loss: 2.27200
Epoch 3, Val Loss: 2.23752
Epoch 4, Val Loss: 2.27865
Epoch 5, Val Loss: 2.22612
Epoch 6, Val Loss: 2.18451
Epoch 7, Val Loss: 2.17586
Epoch 8, Val Loss: 2.17024
Epoch 9, Val Loss: 2.19122
Epoch 10, Val Loss: 2.25395
Epoch 11, Val Loss: 2.19009
Epoch 12, Val Loss: 2.23737
Epoch 13, Val Loss: 2.23722
Epoch 14, Val Loss: 2.17368
Epoch 15, Val Loss: 2.18098
Epoch 16, Val Loss: 2.23406
Epoch 17, Val Loss: 2.18877
Epoch 18, Val Loss: 2.16825
Epoch 19, Val Loss: 2.20686
Epoch 20, Val Loss: 2.20228
Epoch 21, Val Loss: 2.19991
Epoch 22, Val Loss: 2.16552
Epoch 23, Val Loss: 2.17825
Epoch 24, Val Loss: 2.18165
Epoch 25, Val Loss: 2.15287
Epoch 26, Val Loss: 2.14417
Epoch 27, Val Loss: 2.14418
Epoch 28, Val Loss: 2.17994
Epoch 29, Val Loss: 2.16259
Epoch 30, Val Loss: 2.17299
Epoch 31, Val Loss: 2.24242
Epoch 32, Val Loss: 2.17605
Epoch 33, Val Loss: 2.20792
Epoch 34, Val Loss: 2.17132
Epoch 35, Val Loss: 2.16009
Epoch 36, Val Loss: 2.16629
Epoch 37, Val Loss: 2.15845
Epoch 38, Val Loss: 2.19535
Epoch 39, Val Loss: 2.17471
Epoch 40, Val Loss: 2.18409
Epoch 41, Val Loss: 2.21957
Epoch 42, Val Loss: 2.15941
Epoch 43, Val Loss: 2.16991
Epoch 44, Val Loss: 2.16363
Epoch 45, Val Loss: 2.21145
Epoch 46, Val Loss: 2.22436
Epoch 47, Val Loss: 2.30597
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.0967, 'Log Loss - std': 3.7851572411195815} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 39 finished with value: 3.0967 and parameters: {'p_m': 0.17563521913403693, 'alpha': 2.196043081307617, 'K': 20, 'beta': 4.969885080333175}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.8881857064069707, 'alpha': 2.771478234116123, 'K': 3, 'beta': 3.0957034688260037}
Fitted encoder
Epoch 0, Val Loss: 2.31655
Epoch 1, Val Loss: 2.34180
Epoch 2, Val Loss: 2.26124
Epoch 3, Val Loss: 2.20860
Epoch 4, Val Loss: 2.26757
Epoch 5, Val Loss: 2.21365
Epoch 6, Val Loss: 2.21005
Epoch 7, Val Loss: 2.23021
Epoch 8, Val Loss: 2.31611
Epoch 9, Val Loss: 2.23853
Epoch 10, Val Loss: 2.24264
Epoch 11, Val Loss: 2.23283
Epoch 12, Val Loss: 2.21991
Epoch 13, Val Loss: 2.19195
Epoch 14, Val Loss: 2.21952
Epoch 15, Val Loss: 2.24671
Epoch 16, Val Loss: 2.23756
Epoch 17, Val Loss: 2.17770
Epoch 18, Val Loss: 2.20226
Epoch 19, Val Loss: 2.20177
Epoch 20, Val Loss: 2.22581
Epoch 21, Val Loss: 2.20243
Epoch 22, Val Loss: 2.26197
Epoch 23, Val Loss: 2.18710
Epoch 24, Val Loss: 2.18784
Epoch 25, Val Loss: 2.20916
Epoch 26, Val Loss: 2.20293
Epoch 27, Val Loss: 2.25433
Epoch 28, Val Loss: 2.16830
Epoch 29, Val Loss: 2.17655
Epoch 30, Val Loss: 2.22407
Epoch 31, Val Loss: 2.17851
Epoch 32, Val Loss: 2.20175
Epoch 33, Val Loss: 2.17755
Epoch 34, Val Loss: 2.32978
Epoch 35, Val Loss: 2.18936
Epoch 36, Val Loss: 2.22946
Epoch 37, Val Loss: 2.22490
Epoch 38, Val Loss: 2.27021
Epoch 39, Val Loss: 2.20738
Epoch 40, Val Loss: 2.18974
Epoch 41, Val Loss: 2.20905
Epoch 42, Val Loss: 2.20240
Epoch 43, Val Loss: 2.29499
Epoch 44, Val Loss: 2.23586
Epoch 45, Val Loss: 2.18924
Epoch 46, Val Loss: 2.17641
Epoch 47, Val Loss: 2.25972
Epoch 48, Val Loss: 2.19246
Epoch 49, Val Loss: 2.19995
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.2557, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.8881857064069707, 'alpha': 2.771478234116123, 'K': 3, 'beta': 3.0957034688260037}
Fitted encoder
Epoch 0, Val Loss: 2.41556
Epoch 1, Val Loss: 2.29893
Epoch 2, Val Loss: 2.24437
Epoch 3, Val Loss: 2.23001
Epoch 4, Val Loss: 2.33388
Epoch 5, Val Loss: 2.21072
Epoch 6, Val Loss: 2.24295
Epoch 7, Val Loss: 2.20055
Epoch 8, Val Loss: 2.35718
Epoch 9, Val Loss: 2.24614
Epoch 10, Val Loss: 2.30853
Epoch 11, Val Loss: 2.23949
Epoch 12, Val Loss: 2.23028
Epoch 13, Val Loss: 2.25107
Epoch 14, Val Loss: 2.21083
Epoch 15, Val Loss: 2.20704
Epoch 16, Val Loss: 2.24340
Epoch 17, Val Loss: 2.20993
Epoch 18, Val Loss: 2.20792
Epoch 19, Val Loss: 2.20609
Epoch 20, Val Loss: 2.23602
Epoch 21, Val Loss: 2.22821
Epoch 22, Val Loss: 2.23423
Epoch 23, Val Loss: 2.20923
Epoch 24, Val Loss: 2.22295
Epoch 25, Val Loss: 2.21826
Epoch 26, Val Loss: 2.23163
Epoch 27, Val Loss: 2.30303
Epoch 28, Val Loss: 2.26527
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.11875, 'Log Loss - std': 0.13695000000000002} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.8881857064069707, 'alpha': 2.771478234116123, 'K': 3, 'beta': 3.0957034688260037}
Fitted encoder
Epoch 0, Val Loss: 2.28979
Epoch 1, Val Loss: 2.34689
Epoch 2, Val Loss: 2.23053
Epoch 3, Val Loss: 2.22786
Epoch 4, Val Loss: 2.23062
Epoch 5, Val Loss: 2.21176
Epoch 6, Val Loss: 2.22010
Epoch 7, Val Loss: 2.19431
Epoch 8, Val Loss: 2.20242
Epoch 9, Val Loss: 2.20219
Epoch 10, Val Loss: 2.18282
Epoch 11, Val Loss: 2.20731
Epoch 12, Val Loss: 2.17678
Epoch 13, Val Loss: 2.21441
Epoch 14, Val Loss: 2.23556
Epoch 15, Val Loss: 2.21046
Epoch 16, Val Loss: 2.26612
Epoch 17, Val Loss: 2.22432
Epoch 18, Val Loss: 2.19141
Epoch 19, Val Loss: 2.20863
Epoch 20, Val Loss: 2.20850
Epoch 21, Val Loss: 2.25595
Epoch 22, Val Loss: 2.20183
Epoch 23, Val Loss: 2.21112
Epoch 24, Val Loss: 2.17863
Epoch 25, Val Loss: 2.15206
Epoch 26, Val Loss: 2.19269
Epoch 27, Val Loss: 2.16711
Epoch 28, Val Loss: 2.15630
Epoch 29, Val Loss: 2.15724
Epoch 30, Val Loss: 2.24037
Epoch 31, Val Loss: 2.22055
Epoch 32, Val Loss: 2.15481
Epoch 33, Val Loss: 2.26603
Epoch 34, Val Loss: 2.15997
Epoch 35, Val Loss: 2.15973
Epoch 36, Val Loss: 2.15764
Epoch 37, Val Loss: 2.20682
Epoch 38, Val Loss: 2.13774
Epoch 39, Val Loss: 2.14916
Epoch 40, Val Loss: 2.18668
Epoch 41, Val Loss: 2.15528
Epoch 42, Val Loss: 2.14910
Epoch 43, Val Loss: 2.14360
Epoch 44, Val Loss: 2.14427
Epoch 45, Val Loss: 2.20397
Epoch 46, Val Loss: 2.17895
Epoch 47, Val Loss: 2.14485
Epoch 48, Val Loss: 2.13274
Epoch 49, Val Loss: 2.12712
Epoch 50, Val Loss: 2.14658
Epoch 51, Val Loss: 2.15246
Epoch 52, Val Loss: 2.16262
Epoch 53, Val Loss: 2.20123
Epoch 54, Val Loss: 2.16903
Epoch 55, Val Loss: 2.14940
Epoch 56, Val Loss: 2.17887
Epoch 57, Val Loss: 2.17606
Epoch 58, Val Loss: 2.15534
Epoch 59, Val Loss: 2.18174
Epoch 60, Val Loss: 2.15450
Epoch 61, Val Loss: 2.17436
Epoch 62, Val Loss: 2.11099
Epoch 63, Val Loss: 2.13655
Epoch 64, Val Loss: 2.18050
Epoch 65, Val Loss: 2.14234
Epoch 66, Val Loss: 2.13151
Epoch 67, Val Loss: 2.18376
Epoch 68, Val Loss: 2.14765
Epoch 69, Val Loss: 2.15714
Epoch 70, Val Loss: 2.14972
Epoch 71, Val Loss: 2.15665
Epoch 72, Val Loss: 2.21971
Epoch 73, Val Loss: 2.15402
Epoch 74, Val Loss: 2.17227
Epoch 75, Val Loss: 2.11718
Epoch 76, Val Loss: 2.13391
Epoch 77, Val Loss: 2.13098
Epoch 78, Val Loss: 2.15216
Epoch 79, Val Loss: 2.15883
Epoch 80, Val Loss: 2.15395
Epoch 81, Val Loss: 2.16808
Epoch 82, Val Loss: 2.16281
Epoch 83, Val Loss: 2.16264
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.9555333333333333, 'Log Loss - std': 0.2564817645672993} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.8881857064069707, 'alpha': 2.771478234116123, 'K': 3, 'beta': 3.0957034688260037}
Fitted encoder
Epoch 0, Val Loss: 2.33796
Epoch 1, Val Loss: 2.34271
Epoch 2, Val Loss: 2.32370
Epoch 3, Val Loss: 2.29022
Epoch 4, Val Loss: 2.26077
Epoch 5, Val Loss: 2.28376
Epoch 6, Val Loss: 2.30651
Epoch 7, Val Loss: 2.27230
Epoch 8, Val Loss: 2.24602
Epoch 9, Val Loss: 2.25748
Epoch 10, Val Loss: 2.32642
Epoch 11, Val Loss: 2.23883
Epoch 12, Val Loss: 2.24325
Epoch 13, Val Loss: 2.22752
Epoch 14, Val Loss: 2.29719
Epoch 15, Val Loss: 2.25457
Epoch 16, Val Loss: 2.22545
Epoch 17, Val Loss: 2.24655
Epoch 18, Val Loss: 2.22536
Epoch 19, Val Loss: 2.22468
Epoch 20, Val Loss: 2.23015
Epoch 21, Val Loss: 2.17303
Epoch 22, Val Loss: 2.16200
Epoch 23, Val Loss: 2.26400
Epoch 24, Val Loss: 2.15940
Epoch 25, Val Loss: 2.25107
Epoch 26, Val Loss: 2.19206
Epoch 27, Val Loss: 2.18303
Epoch 28, Val Loss: 2.16836
Epoch 29, Val Loss: 2.17400
Epoch 30, Val Loss: 2.18145
Epoch 31, Val Loss: 2.18520
Epoch 32, Val Loss: 2.22773
Epoch 33, Val Loss: 2.22036
Epoch 34, Val Loss: 2.16707
Epoch 35, Val Loss: 2.16175
Epoch 36, Val Loss: 2.19506
Epoch 37, Val Loss: 2.20241
Epoch 38, Val Loss: 2.19286
Epoch 39, Val Loss: 2.15219
Epoch 40, Val Loss: 2.22018
Epoch 41, Val Loss: 2.19019
Epoch 42, Val Loss: 2.21139
Epoch 43, Val Loss: 2.18384
Epoch 44, Val Loss: 2.16750
Epoch 45, Val Loss: 2.20049
Epoch 46, Val Loss: 2.23827
Epoch 47, Val Loss: 2.20162
Epoch 48, Val Loss: 2.21405
Epoch 49, Val Loss: 2.23943
Epoch 50, Val Loss: 2.30441
Epoch 51, Val Loss: 2.14811
Epoch 52, Val Loss: 2.21236
Epoch 53, Val Loss: 2.17330
Epoch 54, Val Loss: 2.14537
Epoch 55, Val Loss: 2.19665
Epoch 56, Val Loss: 2.16839
Epoch 57, Val Loss: 2.19160
Epoch 58, Val Loss: 2.15609
Epoch 59, Val Loss: 2.17811
Epoch 60, Val Loss: 2.17362
Epoch 61, Val Loss: 2.19766
Epoch 62, Val Loss: 2.15887
Epoch 63, Val Loss: 2.21132
Epoch 64, Val Loss: 2.17706
Epoch 65, Val Loss: 2.24286
Epoch 66, Val Loss: 2.24093
Epoch 67, Val Loss: 2.20612
Epoch 68, Val Loss: 2.14723
Epoch 69, Val Loss: 2.16471
Epoch 70, Val Loss: 2.19125
Epoch 71, Val Loss: 2.17803
Epoch 72, Val Loss: 2.16397
Epoch 73, Val Loss: 2.14421
Epoch 74, Val Loss: 2.15859
Epoch 75, Val Loss: 2.19093
Epoch 76, Val Loss: 2.15410
Epoch 77, Val Loss: 2.15844
Epoch 78, Val Loss: 2.20910
Epoch 79, Val Loss: 2.15047
Epoch 80, Val Loss: 2.16119
Epoch 81, Val Loss: 2.18179
Epoch 82, Val Loss: 2.21806
Epoch 83, Val Loss: 2.20715
Epoch 84, Val Loss: 2.23775
Epoch 85, Val Loss: 2.23034
Epoch 86, Val Loss: 2.17136
Epoch 87, Val Loss: 2.15981
Epoch 88, Val Loss: 2.19245
Epoch 89, Val Loss: 2.20058
Epoch 90, Val Loss: 2.21254
Epoch 91, Val Loss: 2.18672
Epoch 92, Val Loss: 2.13843
Epoch 93, Val Loss: 2.18362
Epoch 94, Val Loss: 2.15538
Epoch 95, Val Loss: 2.21724
Epoch 96, Val Loss: 2.15310
Epoch 97, Val Loss: 2.18273
Epoch 98, Val Loss: 2.15413
Epoch 99, Val Loss: 2.24800
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.7758, 'Log Loss - std': 0.38242565944245954} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.8881857064069707, 'alpha': 2.771478234116123, 'K': 3, 'beta': 3.0957034688260037}
Fitted encoder
Epoch 0, Val Loss: 2.33542
Epoch 1, Val Loss: 2.31041
Epoch 2, Val Loss: 2.31925
Epoch 3, Val Loss: 2.28057
Epoch 4, Val Loss: 2.28286
Epoch 5, Val Loss: 2.30997
Epoch 6, Val Loss: 2.28641
Epoch 7, Val Loss: 2.24977
Epoch 8, Val Loss: 2.30428
Epoch 9, Val Loss: 2.22685
Epoch 10, Val Loss: 2.21458
Epoch 11, Val Loss: 2.27507
Epoch 12, Val Loss: 2.26430
Epoch 13, Val Loss: 2.25413
Epoch 14, Val Loss: 2.20624
Epoch 15, Val Loss: 2.27868
Epoch 16, Val Loss: 2.22277
Epoch 17, Val Loss: 2.26118
Epoch 18, Val Loss: 2.23529
Epoch 19, Val Loss: 2.22355
Epoch 20, Val Loss: 2.25168
Epoch 21, Val Loss: 2.28552
Epoch 22, Val Loss: 2.26670
Epoch 23, Val Loss: 2.27092
Epoch 24, Val Loss: 2.22654
Epoch 25, Val Loss: 2.23218
Epoch 26, Val Loss: 2.25675
Epoch 27, Val Loss: 2.21753
Epoch 28, Val Loss: 2.23671
Epoch 29, Val Loss: 2.23023
Epoch 30, Val Loss: 2.22491
Epoch 31, Val Loss: 2.21493
Epoch 32, Val Loss: 2.21415
Epoch 33, Val Loss: 2.23506
Epoch 34, Val Loss: 2.22152
Epoch 35, Val Loss: 2.25572
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.8807000000000003, 'Log Loss - std': 0.4012674270358859} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 40 finished with value: 1.8807000000000003 and parameters: {'p_m': 0.8881857064069707, 'alpha': 2.771478234116123, 'K': 3, 'beta': 3.0957034688260037}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3349631752526421, 'alpha': 0.6527891669153183, 'K': 10, 'beta': 0.11657842406730096}
Fitted encoder
Epoch 0, Val Loss: 2.68396
Epoch 1, Val Loss: 2.68396
Epoch 2, Val Loss: 2.68396
Epoch 3, Val Loss: 2.68396
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.67007
Epoch 8, Val Loss: 2.67265
Epoch 9, Val Loss: 2.67302
Epoch 10, Val Loss: 2.67302
Epoch 11, Val Loss: 2.67302
Epoch 12, Val Loss: 2.67226
Epoch 13, Val Loss: 2.68249
Epoch 14, Val Loss: 2.68249
Epoch 15, Val Loss: 2.68249
Epoch 16, Val Loss: 2.68249
Epoch 17, Val Loss: 2.68249
Epoch 18, Val Loss: 2.68249
Epoch 19, Val Loss: 2.68249
Epoch 20, Val Loss: 2.68249
Epoch 21, Val Loss: 2.68249
Epoch 22, Val Loss: 2.68249
Epoch 23, Val Loss: 2.68249
Epoch 24, Val Loss: 2.68249
Epoch 25, Val Loss: 2.68497
Epoch 26, Val Loss: 2.68497
Epoch 27, Val Loss: 2.68497
Epoch 28, Val Loss: 2.68497
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 10.6265, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3349631752526421, 'alpha': 0.6527891669153183, 'K': 10, 'beta': 0.11657842406730096}
Fitted encoder
Epoch 0, Val Loss: 2.67504
Epoch 1, Val Loss: 2.67504
Epoch 2, Val Loss: 2.67504
Epoch 3, Val Loss: 2.67504
Epoch 4, Val Loss: 2.67504
Epoch 5, Val Loss: 2.67504
Epoch 6, Val Loss: 2.67504
Epoch 7, Val Loss: 2.67504
Epoch 8, Val Loss: 2.67504
Epoch 9, Val Loss: 2.59600
Epoch 10, Val Loss: 2.56812
Epoch 11, Val Loss: 2.59376
Epoch 12, Val Loss: 2.56380
Epoch 13, Val Loss: 2.60349
Epoch 14, Val Loss: 2.58825
Epoch 15, Val Loss: 2.57307
Epoch 16, Val Loss: 2.55580
Epoch 17, Val Loss: 2.54718
Epoch 18, Val Loss: 2.52503
Epoch 19, Val Loss: 2.53000
Epoch 20, Val Loss: 2.57304
Epoch 21, Val Loss: 2.55850
Epoch 22, Val Loss: 2.53637
Epoch 23, Val Loss: 2.53880
Epoch 24, Val Loss: 2.52234
Epoch 25, Val Loss: 2.52408
Epoch 26, Val Loss: 2.55869
Epoch 27, Val Loss: 2.52373
Epoch 28, Val Loss: 2.51969
Epoch 29, Val Loss: 2.51873
Epoch 30, Val Loss: 2.51657
Epoch 31, Val Loss: 2.51239
Epoch 32, Val Loss: 2.51802
Epoch 33, Val Loss: 2.51661
Epoch 34, Val Loss: 2.56205
Epoch 35, Val Loss: 2.56293
Epoch 36, Val Loss: 2.66641
Epoch 37, Val Loss: 2.55856
Epoch 38, Val Loss: 2.55625
Epoch 39, Val Loss: 2.52685
Epoch 40, Val Loss: 2.53439
Epoch 41, Val Loss: 2.54302
Epoch 42, Val Loss: 2.54559
Epoch 43, Val Loss: 2.52855
Epoch 44, Val Loss: 2.54800
Epoch 45, Val Loss: 2.57189
Epoch 46, Val Loss: 2.52498
Epoch 47, Val Loss: 2.65014
Epoch 48, Val Loss: 2.51622
Epoch 49, Val Loss: 2.64180
Epoch 50, Val Loss: 2.53433
Epoch 51, Val Loss: 2.61463
Epoch 52, Val Loss: 2.52565
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.39465, 'Log Loss - std': 1.2318499999999997} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3349631752526421, 'alpha': 0.6527891669153183, 'K': 10, 'beta': 0.11657842406730096}
Fitted encoder
Epoch 0, Val Loss: 2.68001
Epoch 1, Val Loss: 2.68001
Epoch 2, Val Loss: 2.68001
Epoch 3, Val Loss: 2.68001
Epoch 4, Val Loss: 2.68001
Epoch 5, Val Loss: 2.68001
Epoch 6, Val Loss: 2.68001
Epoch 7, Val Loss: 2.68479
Epoch 8, Val Loss: 2.68479
Epoch 9, Val Loss: 2.68479
Epoch 10, Val Loss: 2.68479
Epoch 11, Val Loss: 2.68479
Epoch 12, Val Loss: 2.68479
Epoch 13, Val Loss: 2.68479
Epoch 14, Val Loss: 2.68479
Epoch 15, Val Loss: 2.68479
Epoch 16, Val Loss: 2.68479
Epoch 17, Val Loss: 2.68479
Epoch 18, Val Loss: 2.68460
Epoch 19, Val Loss: 2.68460
Epoch 20, Val Loss: 2.68460
Epoch 21, Val Loss: 2.68460
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.8112, 'Log Loss - std': 1.1656174701275994} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3349631752526421, 'alpha': 0.6527891669153183, 'K': 10, 'beta': 0.11657842406730096}
Fitted encoder
Epoch 0, Val Loss: 2.68727
Epoch 1, Val Loss: 2.68727
Epoch 2, Val Loss: 2.68727
Epoch 3, Val Loss: 2.68727
Epoch 4, Val Loss: 2.68727
Epoch 5, Val Loss: 2.68727
Epoch 6, Val Loss: 2.68727
Epoch 7, Val Loss: 2.68727
Epoch 8, Val Loss: 2.63272
Epoch 9, Val Loss: 2.68497
Epoch 10, Val Loss: 2.68497
Epoch 11, Val Loss: 2.68497
Epoch 12, Val Loss: 2.68497
Epoch 13, Val Loss: 2.68497
Epoch 14, Val Loss: 2.68497
Epoch 15, Val Loss: 2.68497
Epoch 16, Val Loss: 2.68497
Epoch 17, Val Loss: 2.68497
Epoch 18, Val Loss: 2.68497
Epoch 19, Val Loss: 2.68497
Epoch 20, Val Loss: 2.68497
Epoch 21, Val Loss: 2.68506
Epoch 22, Val Loss: 2.68506
Epoch 23, Val Loss: 2.68506
Epoch 24, Val Loss: 2.68451
Epoch 25, Val Loss: 2.68451
Epoch 26, Val Loss: 2.68451
Epoch 27, Val Loss: 2.68451
Epoch 28, Val Loss: 2.68451
Epoch 29, Val Loss: 2.68451
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.875174999999999, 'Log Loss - std': 1.0155178318843048} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3349631752526421, 'alpha': 0.6527891669153183, 'K': 10, 'beta': 0.11657842406730096}
Fitted encoder
Epoch 0, Val Loss: 2.63036
Epoch 1, Val Loss: 2.68534
Epoch 2, Val Loss: 2.68534
Epoch 3, Val Loss: 2.68534
Epoch 4, Val Loss: 2.68534
Epoch 5, Val Loss: 2.68525
Epoch 6, Val Loss: 2.68525
Epoch 7, Val Loss: 2.68525
Epoch 8, Val Loss: 2.68525
Epoch 9, Val Loss: 2.68525
Epoch 10, Val Loss: 2.68525
Epoch 11, Val Loss: 2.68258
Epoch 12, Val Loss: 2.68267
Epoch 13, Val Loss: 2.68267
Epoch 14, Val Loss: 2.68267
Epoch 15, Val Loss: 2.68267
Epoch 16, Val Loss: 2.68267
Epoch 17, Val Loss: 2.68267
Epoch 18, Val Loss: 2.68267
Epoch 19, Val Loss: 2.68267
Epoch 20, Val Loss: 2.68267
Epoch 21, Val Loss: 2.68267
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.909519999999999, 'Log Loss - std': 0.9109003730375784} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 41 finished with value: 9.909519999999999 and parameters: {'p_m': 0.3349631752526421, 'alpha': 0.6527891669153183, 'K': 10, 'beta': 0.11657842406730096}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2900051943481827, 'alpha': 0.8784687314705584, 'K': 10, 'beta': 0.6597413212763086}
Fitted encoder
Epoch 0, Val Loss: 2.61268
Epoch 1, Val Loss: 2.63662
Epoch 2, Val Loss: 2.68396
Epoch 3, Val Loss: 2.68396
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.68396
Epoch 8, Val Loss: 2.68396
Epoch 9, Val Loss: 2.68396
Epoch 10, Val Loss: 2.68396
Epoch 11, Val Loss: 2.68396
Epoch 12, Val Loss: 2.68396
Epoch 13, Val Loss: 2.68497
Epoch 14, Val Loss: 2.68497
Epoch 15, Val Loss: 2.68497
Epoch 16, Val Loss: 2.68249
Epoch 17, Val Loss: 2.68249
Epoch 18, Val Loss: 2.68249
Epoch 19, Val Loss: 2.68249
Epoch 20, Val Loss: 2.68249
Epoch 21, Val Loss: 2.63927
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.8609, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2900051943481827, 'alpha': 0.8784687314705584, 'K': 10, 'beta': 0.6597413212763086}
Fitted encoder
Epoch 0, Val Loss: 2.68543
Epoch 1, Val Loss: 2.68543
Epoch 2, Val Loss: 2.68543
Epoch 3, Val Loss: 2.68258
Epoch 4, Val Loss: 2.68359
Epoch 5, Val Loss: 2.68359
Epoch 6, Val Loss: 2.68359
Epoch 7, Val Loss: 2.68359
Epoch 8, Val Loss: 2.68359
Epoch 9, Val Loss: 2.68359
Epoch 10, Val Loss: 2.68359
Epoch 11, Val Loss: 2.68359
Epoch 12, Val Loss: 2.68359
Epoch 13, Val Loss: 2.67504
Epoch 14, Val Loss: 2.67504
Epoch 15, Val Loss: 2.67504
Epoch 16, Val Loss: 2.67504
Epoch 17, Val Loss: 2.67504
Epoch 18, Val Loss: 2.67504
Epoch 19, Val Loss: 2.67504
Epoch 20, Val Loss: 2.67504
Epoch 21, Val Loss: 2.67504
Epoch 22, Val Loss: 2.67504
Epoch 23, Val Loss: 2.67504
Epoch 24, Val Loss: 2.67504
Epoch 25, Val Loss: 2.68267
Epoch 26, Val Loss: 2.68267
Epoch 27, Val Loss: 2.68267
Epoch 28, Val Loss: 2.62504
Epoch 29, Val Loss: 2.61203
Epoch 30, Val Loss: 2.61392
Epoch 31, Val Loss: 2.68359
Epoch 32, Val Loss: 2.68359
Epoch 33, Val Loss: 2.68359
Epoch 34, Val Loss: 2.68359
Epoch 35, Val Loss: 2.68359
Epoch 36, Val Loss: 2.68359
Epoch 37, Val Loss: 2.68359
Epoch 38, Val Loss: 2.68359
Epoch 39, Val Loss: 2.68359
Epoch 40, Val Loss: 2.68359
Epoch 41, Val Loss: 2.68359
Epoch 42, Val Loss: 2.68359
Epoch 43, Val Loss: 2.68359
Epoch 44, Val Loss: 2.68359
Epoch 45, Val Loss: 2.68359
Epoch 46, Val Loss: 2.68359
Epoch 47, Val Loss: 2.50708
Epoch 48, Val Loss: 2.47282
Epoch 49, Val Loss: 2.42935
Epoch 50, Val Loss: 2.48059
Epoch 51, Val Loss: 2.43825
Epoch 52, Val Loss: 2.43957
Epoch 53, Val Loss: 2.41074
Epoch 54, Val Loss: 2.45250
Epoch 55, Val Loss: 2.32728
Epoch 56, Val Loss: 2.35511
Epoch 57, Val Loss: 2.34610
Epoch 58, Val Loss: 2.36726
Epoch 59, Val Loss: 2.33753
Epoch 60, Val Loss: 2.34484
Epoch 61, Val Loss: 2.34801
Epoch 62, Val Loss: 2.33017
Epoch 63, Val Loss: 2.32777
Epoch 64, Val Loss: 2.30148
Epoch 65, Val Loss: 2.32038
Epoch 66, Val Loss: 2.29838
Epoch 67, Val Loss: 2.33666
Epoch 68, Val Loss: 2.35475
Epoch 69, Val Loss: 2.33545
Epoch 70, Val Loss: 2.36836
Epoch 71, Val Loss: 2.29768
Epoch 72, Val Loss: 2.32901
Epoch 73, Val Loss: 2.28744
Epoch 74, Val Loss: 2.33603
Epoch 75, Val Loss: 2.35637
Epoch 76, Val Loss: 2.33156
Epoch 77, Val Loss: 2.34147
Epoch 78, Val Loss: 2.38013
Epoch 79, Val Loss: 2.37557
Epoch 80, Val Loss: 2.36587
Epoch 81, Val Loss: 2.38422
Epoch 82, Val Loss: 2.36584
Epoch 83, Val Loss: 2.35284
Epoch 84, Val Loss: 2.36987
Epoch 85, Val Loss: 2.43456
Epoch 86, Val Loss: 2.35157
Epoch 87, Val Loss: 2.38111
Epoch 88, Val Loss: 2.35121
Epoch 89, Val Loss: 2.36551
Epoch 90, Val Loss: 2.37128
Epoch 91, Val Loss: 2.36779
Epoch 92, Val Loss: 2.44660
Epoch 93, Val Loss: 2.44527
Epoch 94, Val Loss: 2.40583
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 7.0288, 'Log Loss - std': 2.8321000000000005} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2900051943481827, 'alpha': 0.8784687314705584, 'K': 10, 'beta': 0.6597413212763086}
Fitted encoder
Epoch 0, Val Loss: 2.68010
Epoch 1, Val Loss: 2.68010
Epoch 2, Val Loss: 2.68010
Epoch 3, Val Loss: 2.68001
Epoch 4, Val Loss: 2.68001
Epoch 5, Val Loss: 2.68001
Epoch 6, Val Loss: 2.68001
Epoch 7, Val Loss: 2.68001
Epoch 8, Val Loss: 2.68001
Epoch 9, Val Loss: 2.68001
Epoch 10, Val Loss: 2.68001
Epoch 11, Val Loss: 2.68001
Epoch 12, Val Loss: 2.63383
Epoch 13, Val Loss: 2.68240
Epoch 14, Val Loss: 2.68240
Epoch 15, Val Loss: 2.68240
Epoch 16, Val Loss: 2.68240
Epoch 17, Val Loss: 2.68240
Epoch 18, Val Loss: 2.68240
Epoch 19, Val Loss: 2.68240
Epoch 20, Val Loss: 2.68240
Epoch 21, Val Loss: 2.68240
Epoch 22, Val Loss: 2.68240
Epoch 23, Val Loss: 2.68240
Epoch 24, Val Loss: 2.68240
Epoch 25, Val Loss: 2.68240
Epoch 26, Val Loss: 2.68240
Epoch 27, Val Loss: 2.68240
Epoch 28, Val Loss: 2.68240
Epoch 29, Val Loss: 2.68240
Epoch 30, Val Loss: 2.68240
Epoch 31, Val Loss: 2.68240
Epoch 32, Val Loss: 2.68295
Epoch 33, Val Loss: 2.68295
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.046666666666667, 'Log Loss - std': 2.723838965300425} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2900051943481827, 'alpha': 0.8784687314705584, 'K': 10, 'beta': 0.6597413212763086}
Fitted encoder
Epoch 0, Val Loss: 2.57457
Epoch 1, Val Loss: 2.68571
Epoch 2, Val Loss: 2.68571
Epoch 3, Val Loss: 2.68571
Epoch 4, Val Loss: 2.68571
Epoch 5, Val Loss: 2.68571
Epoch 6, Val Loss: 2.68571
Epoch 7, Val Loss: 2.68571
Epoch 8, Val Loss: 2.68571
Epoch 9, Val Loss: 2.68571
Epoch 10, Val Loss: 2.68506
Epoch 11, Val Loss: 2.68506
Epoch 12, Val Loss: 2.68506
Epoch 13, Val Loss: 2.68497
Epoch 14, Val Loss: 2.68497
Epoch 15, Val Loss: 2.68497
Epoch 16, Val Loss: 2.68497
Epoch 17, Val Loss: 2.68497
Epoch 18, Val Loss: 2.68708
Epoch 19, Val Loss: 2.68708
Epoch 20, Val Loss: 2.68708
Epoch 21, Val Loss: 2.68708
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.181375, 'Log Loss - std': 2.37042465327945} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2900051943481827, 'alpha': 0.8784687314705584, 'K': 10, 'beta': 0.6597413212763086}
Fitted encoder
Epoch 0, Val Loss: 2.61505
Epoch 1, Val Loss: 2.63849
Epoch 2, Val Loss: 2.68194
Epoch 3, Val Loss: 2.68194
Epoch 4, Val Loss: 2.68194
Epoch 5, Val Loss: 2.68194
Epoch 6, Val Loss: 2.68194
Epoch 7, Val Loss: 2.68194
Epoch 8, Val Loss: 2.68194
Epoch 9, Val Loss: 2.68194
Epoch 10, Val Loss: 2.68194
Epoch 11, Val Loss: 2.68534
Epoch 12, Val Loss: 2.68534
Epoch 13, Val Loss: 2.68534
Epoch 14, Val Loss: 2.68534
Epoch 15, Val Loss: 2.68534
Epoch 16, Val Loss: 2.68534
Epoch 17, Val Loss: 2.68534
Epoch 18, Val Loss: 2.67936
Epoch 19, Val Loss: 2.67936
Epoch 20, Val Loss: 2.67936
Epoch 21, Val Loss: 2.67936
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.53136, 'Log Loss - std': 2.232731159454716} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 42 finished with value: 8.53136 and parameters: {'p_m': 0.2900051943481827, 'alpha': 0.8784687314705584, 'K': 10, 'beta': 0.6597413212763086}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3355655869949305, 'alpha': 5.719445505012536, 'K': 10, 'beta': 1.2412622565564029}
Fitted encoder
Epoch 0, Val Loss: 2.35391
Epoch 1, Val Loss: 2.43207
Epoch 2, Val Loss: 2.51645
Epoch 3, Val Loss: 2.67302
Epoch 4, Val Loss: 2.67302
Epoch 5, Val Loss: 2.67302
Epoch 6, Val Loss: 2.67302
Epoch 7, Val Loss: 2.67302
Epoch 8, Val Loss: 2.67302
Epoch 9, Val Loss: 2.67302
Epoch 10, Val Loss: 2.67302
Epoch 11, Val Loss: 2.67302
Epoch 12, Val Loss: 2.67302
Epoch 13, Val Loss: 2.67302
Epoch 14, Val Loss: 2.67302
Epoch 15, Val Loss: 2.67302
Epoch 16, Val Loss: 2.67302
Epoch 17, Val Loss: 2.67302
Epoch 18, Val Loss: 2.67302
Epoch 19, Val Loss: 2.67302
Epoch 20, Val Loss: 2.67302
Epoch 21, Val Loss: 2.67302
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.0427, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3355655869949305, 'alpha': 5.719445505012536, 'K': 10, 'beta': 1.2412622565564029}
Fitted encoder
Epoch 0, Val Loss: 2.47004
Epoch 1, Val Loss: 2.48044
Epoch 2, Val Loss: 2.44649
Epoch 3, Val Loss: 2.46042
Epoch 4, Val Loss: 2.55822
Epoch 5, Val Loss: 2.49650
Epoch 6, Val Loss: 2.56444
Epoch 7, Val Loss: 2.46856
Epoch 8, Val Loss: 2.51285
Epoch 9, Val Loss: 2.46762
Epoch 10, Val Loss: 2.46442
Epoch 11, Val Loss: 2.48989
Epoch 12, Val Loss: 2.47376
Epoch 13, Val Loss: 2.46103
Epoch 14, Val Loss: 2.46482
Epoch 15, Val Loss: 2.47661
Epoch 16, Val Loss: 2.51306
Epoch 17, Val Loss: 2.51127
Epoch 18, Val Loss: 2.47828
Epoch 19, Val Loss: 2.46679
Epoch 20, Val Loss: 2.50372
Epoch 21, Val Loss: 2.47776
Epoch 22, Val Loss: 2.64749
Epoch 23, Val Loss: 2.67504
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.7911, 'Log Loss - std': 1.7484000000000002} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3355655869949305, 'alpha': 5.719445505012536, 'K': 10, 'beta': 1.2412622565564029}
Fitted encoder
Epoch 0, Val Loss: 2.39169
Epoch 1, Val Loss: 2.36253
Epoch 2, Val Loss: 2.34178
Epoch 3, Val Loss: 2.31344
Epoch 4, Val Loss: 2.39009
Epoch 5, Val Loss: 2.29284
Epoch 6, Val Loss: 2.30080
Epoch 7, Val Loss: 2.31791
Epoch 8, Val Loss: 2.32321
Epoch 9, Val Loss: 2.37819
Epoch 10, Val Loss: 2.31038
Epoch 11, Val Loss: 2.32966
Epoch 12, Val Loss: 2.29988
Epoch 13, Val Loss: 2.31681
Epoch 14, Val Loss: 2.34246
Epoch 15, Val Loss: 2.33728
Epoch 16, Val Loss: 2.33701
Epoch 17, Val Loss: 2.34069
Epoch 18, Val Loss: 2.36849
Epoch 19, Val Loss: 2.37295
Epoch 20, Val Loss: 2.32339
Epoch 21, Val Loss: 2.28217
Epoch 22, Val Loss: 2.29704
Epoch 23, Val Loss: 2.29132
Epoch 24, Val Loss: 2.28755
Epoch 25, Val Loss: 2.28584
Epoch 26, Val Loss: 2.28822
Epoch 27, Val Loss: 2.21616
Epoch 28, Val Loss: 2.16539
Epoch 29, Val Loss: 2.21371
Epoch 30, Val Loss: 2.14690
Epoch 31, Val Loss: 2.17201
Epoch 32, Val Loss: 2.21498
Epoch 33, Val Loss: 2.21547
Epoch 34, Val Loss: 2.15155
Epoch 35, Val Loss: 2.15982
Epoch 36, Val Loss: 2.16436
Epoch 37, Val Loss: 2.23407
Epoch 38, Val Loss: 2.26457
Epoch 39, Val Loss: 2.16133
Epoch 40, Val Loss: 2.17244
Epoch 41, Val Loss: 2.19450
Epoch 42, Val Loss: 2.19385
Epoch 43, Val Loss: 2.15890
Epoch 44, Val Loss: 2.16267
Epoch 45, Val Loss: 2.15373
Epoch 46, Val Loss: 2.18071
Epoch 47, Val Loss: 2.16653
Epoch 48, Val Loss: 2.20078
Epoch 49, Val Loss: 2.17677
Epoch 50, Val Loss: 2.26129
Epoch 51, Val Loss: 2.14943
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.796466666666667, 'Log Loss - std': 2.0041272353709374} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3355655869949305, 'alpha': 5.719445505012536, 'K': 10, 'beta': 1.2412622565564029}
Fitted encoder
Epoch 0, Val Loss: 2.42271
Epoch 1, Val Loss: 2.39433
Epoch 2, Val Loss: 2.53604
Epoch 3, Val Loss: 2.50894
Epoch 4, Val Loss: 2.45649
Epoch 5, Val Loss: 2.47809
Epoch 6, Val Loss: 2.43697
Epoch 7, Val Loss: 2.47188
Epoch 8, Val Loss: 2.45393
Epoch 9, Val Loss: 2.43044
Epoch 10, Val Loss: 2.40745
Epoch 11, Val Loss: 2.38655
Epoch 12, Val Loss: 2.40910
Epoch 13, Val Loss: 2.40382
Epoch 14, Val Loss: 2.46431
Epoch 15, Val Loss: 2.45180
Epoch 16, Val Loss: 2.36089
Epoch 17, Val Loss: 2.34713
Epoch 18, Val Loss: 2.40038
Epoch 19, Val Loss: 2.43266
Epoch 20, Val Loss: 2.34058
Epoch 21, Val Loss: 2.31714
Epoch 22, Val Loss: 2.32037
Epoch 23, Val Loss: 2.40136
Epoch 24, Val Loss: 2.32775
Epoch 25, Val Loss: 2.34587
Epoch 26, Val Loss: 2.33427
Epoch 27, Val Loss: 2.36358
Epoch 28, Val Loss: 2.36729
Epoch 29, Val Loss: 2.33354
Epoch 30, Val Loss: 2.31918
Epoch 31, Val Loss: 2.34639
Epoch 32, Val Loss: 2.31813
Epoch 33, Val Loss: 2.33572
Epoch 34, Val Loss: 2.30978
Epoch 35, Val Loss: 2.31319
Epoch 36, Val Loss: 2.31173
Epoch 37, Val Loss: 2.43590
Epoch 38, Val Loss: 2.36220
Epoch 39, Val Loss: 2.35233
Epoch 40, Val Loss: 2.30497
Epoch 41, Val Loss: 2.33488
Epoch 42, Val Loss: 2.38363
Epoch 43, Val Loss: 2.36064
Epoch 44, Val Loss: 2.31609
Epoch 45, Val Loss: 2.34000
Epoch 46, Val Loss: 2.33447
Epoch 47, Val Loss: 2.32164
Epoch 48, Val Loss: 2.31865
Epoch 49, Val Loss: 2.33693
Epoch 50, Val Loss: 2.32023
Epoch 51, Val Loss: 2.32997
Epoch 52, Val Loss: 2.31169
Epoch 53, Val Loss: 2.32636
Epoch 54, Val Loss: 2.34693
Epoch 55, Val Loss: 2.32551
Epoch 56, Val Loss: 2.30354
Epoch 57, Val Loss: 2.33614
Epoch 58, Val Loss: 2.34024
Epoch 59, Val Loss: 2.34223
Epoch 60, Val Loss: 2.34587
Epoch 61, Val Loss: 2.30866
Epoch 62, Val Loss: 2.30245
Epoch 63, Val Loss: 2.36934
Epoch 64, Val Loss: 2.30189
Epoch 65, Val Loss: 2.36225
Epoch 66, Val Loss: 2.29822
Epoch 67, Val Loss: 2.31465
Epoch 68, Val Loss: 2.32955
Epoch 69, Val Loss: 2.31281
Epoch 70, Val Loss: 2.36020
Epoch 71, Val Loss: 2.30743
Epoch 72, Val Loss: 2.30868
Epoch 73, Val Loss: 2.29755
Epoch 74, Val Loss: 2.29101
Epoch 75, Val Loss: 2.31623
Epoch 76, Val Loss: 2.32309
Epoch 77, Val Loss: 2.30954
Epoch 78, Val Loss: 2.31033
Epoch 79, Val Loss: 2.29639
Epoch 80, Val Loss: 2.29935
Epoch 81, Val Loss: 2.29285
Epoch 82, Val Loss: 2.30306
Epoch 83, Val Loss: 2.29924
Epoch 84, Val Loss: 2.31766
Epoch 85, Val Loss: 2.29567
Epoch 86, Val Loss: 2.32175
Epoch 87, Val Loss: 2.29678
Epoch 88, Val Loss: 2.30838
Epoch 89, Val Loss: 2.31530
Epoch 90, Val Loss: 2.31179
Epoch 91, Val Loss: 2.30066
Epoch 92, Val Loss: 2.38250
Epoch 93, Val Loss: 2.29079
Epoch 94, Val Loss: 2.32661
Epoch 95, Val Loss: 2.31041
Epoch 96, Val Loss: 2.30946
Epoch 97, Val Loss: 2.34297
Epoch 98, Val Loss: 2.31785
Epoch 99, Val Loss: 2.29823
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.8046, 'Log Loss - std': 1.7356822678704766} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3355655869949305, 'alpha': 5.719445505012536, 'K': 10, 'beta': 1.2412622565564029}
Fitted encoder
Epoch 0, Val Loss: 2.34017
Epoch 1, Val Loss: 2.33641
Epoch 2, Val Loss: 2.35405
Epoch 3, Val Loss: 2.33424
Epoch 4, Val Loss: 2.32576
Epoch 5, Val Loss: 2.31287
Epoch 6, Val Loss: 2.35722
Epoch 7, Val Loss: 2.39382
Epoch 8, Val Loss: 2.49674
Epoch 9, Val Loss: 2.49006
Epoch 10, Val Loss: 2.48491
Epoch 11, Val Loss: 2.49114
Epoch 12, Val Loss: 2.37379
Epoch 13, Val Loss: 2.37504
Epoch 14, Val Loss: 2.35414
Epoch 15, Val Loss: 2.33677
Epoch 16, Val Loss: 2.41174
Epoch 17, Val Loss: 2.35964
Epoch 18, Val Loss: 2.37109
Epoch 19, Val Loss: 2.40087
Epoch 20, Val Loss: 2.33932
Epoch 21, Val Loss: 2.34201
Epoch 22, Val Loss: 2.36596
Epoch 23, Val Loss: 2.33247
Epoch 24, Val Loss: 2.28640
Epoch 25, Val Loss: 2.30067
Epoch 26, Val Loss: 2.25337
Epoch 27, Val Loss: 2.23868
Epoch 28, Val Loss: 2.23424
Epoch 29, Val Loss: 2.27797
Epoch 30, Val Loss: 2.25899
Epoch 31, Val Loss: 2.21269
Epoch 32, Val Loss: 2.25021
Epoch 33, Val Loss: 2.25903
Epoch 34, Val Loss: 2.21469
Epoch 35, Val Loss: 2.28207
Epoch 36, Val Loss: 2.33392
Epoch 37, Val Loss: 2.33186
Epoch 38, Val Loss: 2.33925
Epoch 39, Val Loss: 2.32870
Epoch 40, Val Loss: 2.33469
Epoch 41, Val Loss: 2.33087
Epoch 42, Val Loss: 2.32517
Epoch 43, Val Loss: 2.35428
Epoch 44, Val Loss: 2.42029
Epoch 45, Val Loss: 2.35970
Epoch 46, Val Loss: 2.39075
Epoch 47, Val Loss: 2.36416
Epoch 48, Val Loss: 2.34114
Epoch 49, Val Loss: 2.32089
Epoch 50, Val Loss: 2.36237
Epoch 51, Val Loss: 2.32596
Epoch 52, Val Loss: 2.33224
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.59334, 'Log Loss - std': 1.6089118988931619} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 43 finished with value: 3.59334 and parameters: {'p_m': 0.3355655869949305, 'alpha': 5.719445505012536, 'K': 10, 'beta': 1.2412622565564029}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.22686040712165878, 'alpha': 3.6122385176561593, 'K': 10, 'beta': 2.023365998653599}
Fitted encoder
Epoch 0, Val Loss: 2.37454
Epoch 1, Val Loss: 2.28601
Epoch 2, Val Loss: 2.24282
Epoch 3, Val Loss: 2.24971
Epoch 4, Val Loss: 2.23411
Epoch 5, Val Loss: 2.23600
Epoch 6, Val Loss: 2.23644
Epoch 7, Val Loss: 2.25805
Epoch 8, Val Loss: 2.23763
Epoch 9, Val Loss: 2.25151
Epoch 10, Val Loss: 2.24127
Epoch 11, Val Loss: 2.29747
Epoch 12, Val Loss: 2.23813
Epoch 13, Val Loss: 2.24490
Epoch 14, Val Loss: 2.23888
Epoch 15, Val Loss: 2.22738
Epoch 16, Val Loss: 2.23944
Epoch 17, Val Loss: 2.24690
Epoch 18, Val Loss: 2.27036
Epoch 19, Val Loss: 2.22897
Epoch 20, Val Loss: 2.24434
Epoch 21, Val Loss: 2.26388
Epoch 22, Val Loss: 2.33191
Epoch 23, Val Loss: 2.25282
Epoch 24, Val Loss: 2.25705
Epoch 25, Val Loss: 2.25904
Epoch 26, Val Loss: 2.25493
Epoch 27, Val Loss: 2.21694
Epoch 28, Val Loss: 2.23988
Epoch 29, Val Loss: 2.27193
Epoch 30, Val Loss: 2.23552
Epoch 31, Val Loss: 2.21942
Epoch 32, Val Loss: 2.22597
Epoch 33, Val Loss: 2.22465
Epoch 34, Val Loss: 2.24271
Epoch 35, Val Loss: 2.25759
Epoch 36, Val Loss: 2.21323
Epoch 37, Val Loss: 2.21488
Epoch 38, Val Loss: 2.22236
Epoch 39, Val Loss: 2.22848
Epoch 40, Val Loss: 2.20552
Epoch 41, Val Loss: 2.21378
Epoch 42, Val Loss: 2.21498
Epoch 43, Val Loss: 2.22316
Epoch 44, Val Loss: 2.30468
Epoch 45, Val Loss: 2.22225
Epoch 46, Val Loss: 2.21681
Epoch 47, Val Loss: 2.24185
Epoch 48, Val Loss: 2.22235
Epoch 49, Val Loss: 2.23074
Epoch 50, Val Loss: 2.26189
Epoch 51, Val Loss: 2.25640
Epoch 52, Val Loss: 2.24321
Epoch 53, Val Loss: 2.21175
Epoch 54, Val Loss: 2.22058
Epoch 55, Val Loss: 2.24083
Epoch 56, Val Loss: 2.23666
Epoch 57, Val Loss: 2.22977
Epoch 58, Val Loss: 2.20263
Epoch 59, Val Loss: 2.21227
Epoch 60, Val Loss: 2.21054
Epoch 61, Val Loss: 2.29969
Epoch 62, Val Loss: 2.21157
Epoch 63, Val Loss: 2.27921
Epoch 64, Val Loss: 2.22844
Epoch 65, Val Loss: 2.21244
Epoch 66, Val Loss: 2.20300
Epoch 67, Val Loss: 2.23097
Epoch 68, Val Loss: 2.25909
Epoch 69, Val Loss: 2.23349
Epoch 70, Val Loss: 2.19761
Epoch 71, Val Loss: 2.25607
Epoch 72, Val Loss: 2.20563
Epoch 73, Val Loss: 2.21777
Epoch 74, Val Loss: 2.21827
Epoch 75, Val Loss: 2.26983
Epoch 76, Val Loss: 2.20573
Epoch 77, Val Loss: 2.24085
Epoch 78, Val Loss: 2.19934
Epoch 79, Val Loss: 2.21829
Epoch 80, Val Loss: 2.20267
Epoch 81, Val Loss: 2.23420
Epoch 82, Val Loss: 2.23391
Epoch 83, Val Loss: 2.21776
Epoch 84, Val Loss: 2.21515
Epoch 85, Val Loss: 2.23858
Epoch 86, Val Loss: 2.21517
Epoch 87, Val Loss: 2.22777
Epoch 88, Val Loss: 2.24323
Epoch 89, Val Loss: 2.20797
Epoch 90, Val Loss: 2.21697
Epoch 91, Val Loss: 2.23251
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.7284, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.22686040712165878, 'alpha': 3.6122385176561593, 'K': 10, 'beta': 2.023365998653599}
Fitted encoder
Epoch 0, Val Loss: 2.40104
Epoch 1, Val Loss: 2.36330
Epoch 2, Val Loss: 2.34032
Epoch 3, Val Loss: 2.35679
Epoch 4, Val Loss: 2.35952
Epoch 5, Val Loss: 2.30155
Epoch 6, Val Loss: 2.32307
Epoch 7, Val Loss: 2.33315
Epoch 8, Val Loss: 2.29872
Epoch 9, Val Loss: 2.30860
Epoch 10, Val Loss: 2.29987
Epoch 11, Val Loss: 2.40765
Epoch 12, Val Loss: 2.33485
Epoch 13, Val Loss: 2.30614
Epoch 14, Val Loss: 2.32281
Epoch 15, Val Loss: 2.28769
Epoch 16, Val Loss: 2.29599
Epoch 17, Val Loss: 2.29227
Epoch 18, Val Loss: 2.33384
Epoch 19, Val Loss: 2.28060
Epoch 20, Val Loss: 2.32328
Epoch 21, Val Loss: 2.29051
Epoch 22, Val Loss: 2.37886
Epoch 23, Val Loss: 2.28615
Epoch 24, Val Loss: 2.28783
Epoch 25, Val Loss: 2.29312
Epoch 26, Val Loss: 2.28872
Epoch 27, Val Loss: 2.29847
Epoch 28, Val Loss: 2.30149
Epoch 29, Val Loss: 2.33400
Epoch 30, Val Loss: 2.29742
Epoch 31, Val Loss: 2.28718
Epoch 32, Val Loss: 2.28296
Epoch 33, Val Loss: 2.32489
Epoch 34, Val Loss: 2.35300
Epoch 35, Val Loss: 2.29598
Epoch 36, Val Loss: 2.33071
Epoch 37, Val Loss: 2.28649
Epoch 38, Val Loss: 2.28957
Epoch 39, Val Loss: 2.28436
Epoch 40, Val Loss: 2.33770
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.1427, 'Log Loss - std': 0.4142999999999999} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.22686040712165878, 'alpha': 3.6122385176561593, 'K': 10, 'beta': 2.023365998653599}
Fitted encoder
Epoch 0, Val Loss: 2.33698
Epoch 1, Val Loss: 2.33968
Epoch 2, Val Loss: 2.47216
Epoch 3, Val Loss: 2.33958
Epoch 4, Val Loss: 2.29431
Epoch 5, Val Loss: 2.25325
Epoch 6, Val Loss: 2.27242
Epoch 7, Val Loss: 2.28189
Epoch 8, Val Loss: 2.34874
Epoch 9, Val Loss: 2.30463
Epoch 10, Val Loss: 2.30101
Epoch 11, Val Loss: 2.24250
Epoch 12, Val Loss: 2.26746
Epoch 13, Val Loss: 2.20559
Epoch 14, Val Loss: 2.26257
Epoch 15, Val Loss: 2.22686
Epoch 16, Val Loss: 2.25603
Epoch 17, Val Loss: 2.22875
Epoch 18, Val Loss: 2.26777
Epoch 19, Val Loss: 2.20915
Epoch 20, Val Loss: 2.29105
Epoch 21, Val Loss: 2.18114
Epoch 22, Val Loss: 2.22527
Epoch 23, Val Loss: 2.19289
Epoch 24, Val Loss: 2.21894
Epoch 25, Val Loss: 2.19554
Epoch 26, Val Loss: 2.19525
Epoch 27, Val Loss: 2.25458
Epoch 28, Val Loss: 2.20786
Epoch 29, Val Loss: 2.25708
Epoch 30, Val Loss: 2.31286
Epoch 31, Val Loss: 2.21197
Epoch 32, Val Loss: 2.22503
Epoch 33, Val Loss: 2.18496
Epoch 34, Val Loss: 2.18262
Epoch 35, Val Loss: 2.22287
Epoch 36, Val Loss: 2.21069
Epoch 37, Val Loss: 2.23433
Epoch 38, Val Loss: 2.17600
Epoch 39, Val Loss: 2.18299
Epoch 40, Val Loss: 2.20713
Epoch 41, Val Loss: 2.17812
Epoch 42, Val Loss: 2.19792
Epoch 43, Val Loss: 2.21064
Epoch 44, Val Loss: 2.21544
Epoch 45, Val Loss: 2.21491
Epoch 46, Val Loss: 2.21423
Epoch 47, Val Loss: 2.21287
Epoch 48, Val Loss: 2.20798
Epoch 49, Val Loss: 2.23505
Epoch 50, Val Loss: 2.18804
Epoch 51, Val Loss: 2.22666
Epoch 52, Val Loss: 2.19177
Epoch 53, Val Loss: 2.20611
Epoch 54, Val Loss: 2.21937
Epoch 55, Val Loss: 2.18199
Epoch 56, Val Loss: 2.20279
Epoch 57, Val Loss: 2.20128
Epoch 58, Val Loss: 2.24142
Epoch 59, Val Loss: 2.19023
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.710933333333333, 'Log Loss - std': 0.6980505489496365} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.22686040712165878, 'alpha': 3.6122385176561593, 'K': 10, 'beta': 2.023365998653599}
Fitted encoder
Epoch 0, Val Loss: 2.30660
Epoch 1, Val Loss: 2.26742
Epoch 2, Val Loss: 2.28152
Epoch 3, Val Loss: 2.25320
Epoch 4, Val Loss: 2.22262
Epoch 5, Val Loss: 2.27742
Epoch 6, Val Loss: 2.25201
Epoch 7, Val Loss: 2.26797
Epoch 8, Val Loss: 2.26025
Epoch 9, Val Loss: 2.22850
Epoch 10, Val Loss: 2.25108
Epoch 11, Val Loss: 2.25094
Epoch 12, Val Loss: 2.24188
Epoch 13, Val Loss: 2.27493
Epoch 14, Val Loss: 2.21771
Epoch 15, Val Loss: 2.22886
Epoch 16, Val Loss: 2.25078
Epoch 17, Val Loss: 2.22116
Epoch 18, Val Loss: 2.21387
Epoch 19, Val Loss: 2.29062
Epoch 20, Val Loss: 2.23323
Epoch 21, Val Loss: 2.23354
Epoch 22, Val Loss: 2.21658
Epoch 23, Val Loss: 2.20289
Epoch 24, Val Loss: 2.22637
Epoch 25, Val Loss: 2.21945
Epoch 26, Val Loss: 2.22185
Epoch 27, Val Loss: 2.23847
Epoch 28, Val Loss: 2.25087
Epoch 29, Val Loss: 2.34971
Epoch 30, Val Loss: 2.20093
Epoch 31, Val Loss: 2.19673
Epoch 32, Val Loss: 2.19602
Epoch 33, Val Loss: 2.22610
Epoch 34, Val Loss: 2.25684
Epoch 35, Val Loss: 2.18005
Epoch 36, Val Loss: 2.28326
Epoch 37, Val Loss: 2.17475
Epoch 38, Val Loss: 2.16269
Epoch 39, Val Loss: 2.19388
Epoch 40, Val Loss: 2.17381
Epoch 41, Val Loss: 2.18153
Epoch 42, Val Loss: 2.16663
Epoch 43, Val Loss: 2.29251
Epoch 44, Val Loss: 2.19352
Epoch 45, Val Loss: 2.22673
Epoch 46, Val Loss: 2.18901
Epoch 47, Val Loss: 2.17236
Epoch 48, Val Loss: 2.18465
Epoch 49, Val Loss: 2.19095
Epoch 50, Val Loss: 2.22008
Epoch 51, Val Loss: 2.17436
Epoch 52, Val Loss: 2.16634
Epoch 53, Val Loss: 2.21931
Epoch 54, Val Loss: 2.16622
Epoch 55, Val Loss: 2.22502
Epoch 56, Val Loss: 2.16684
Epoch 57, Val Loss: 2.16835
Epoch 58, Val Loss: 2.21746
Epoch 59, Val Loss: 2.19487
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.557975, 'Log Loss - std': 0.660033849037305} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.22686040712165878, 'alpha': 3.6122385176561593, 'K': 10, 'beta': 2.023365998653599}
Fitted encoder
Epoch 0, Val Loss: 2.49954
Epoch 1, Val Loss: 2.34694
Epoch 2, Val Loss: 2.34214
Epoch 3, Val Loss: 2.38159
Epoch 4, Val Loss: 2.32004
Epoch 5, Val Loss: 2.31617
Epoch 6, Val Loss: 2.26530
Epoch 7, Val Loss: 2.30925
Epoch 8, Val Loss: 2.32941
Epoch 9, Val Loss: 2.26521
Epoch 10, Val Loss: 2.25782
Epoch 11, Val Loss: 2.25417
Epoch 12, Val Loss: 2.25759
Epoch 13, Val Loss: 2.30305
Epoch 14, Val Loss: 2.28222
Epoch 15, Val Loss: 2.25808
Epoch 16, Val Loss: 2.24549
Epoch 17, Val Loss: 2.25741
Epoch 18, Val Loss: 2.24602
Epoch 19, Val Loss: 2.20579
Epoch 20, Val Loss: 2.21706
Epoch 21, Val Loss: 2.23879
Epoch 22, Val Loss: 2.20505
Epoch 23, Val Loss: 2.25422
Epoch 24, Val Loss: 2.21997
Epoch 25, Val Loss: 2.19975
Epoch 26, Val Loss: 2.18575
Epoch 27, Val Loss: 2.19533
Epoch 28, Val Loss: 2.20173
Epoch 29, Val Loss: 2.19487
Epoch 30, Val Loss: 2.22188
Epoch 31, Val Loss: 2.23447
Epoch 32, Val Loss: 2.19495
Epoch 33, Val Loss: 2.20375
Epoch 34, Val Loss: 2.27935
Epoch 35, Val Loss: 2.19437
Epoch 36, Val Loss: 2.19378
Epoch 37, Val Loss: 2.21658
Epoch 38, Val Loss: 2.24074
Epoch 39, Val Loss: 2.19032
Epoch 40, Val Loss: 2.21409
Epoch 41, Val Loss: 2.18532
Epoch 42, Val Loss: 2.18424
Epoch 43, Val Loss: 2.27982
Epoch 44, Val Loss: 2.18821
Epoch 45, Val Loss: 2.19470
Epoch 46, Val Loss: 2.18665
Epoch 47, Val Loss: 2.34821
Epoch 48, Val Loss: 2.19737
Epoch 49, Val Loss: 2.19055
Epoch 50, Val Loss: 2.19481
Epoch 51, Val Loss: 2.29075
Epoch 52, Val Loss: 2.18009
Epoch 53, Val Loss: 2.17882
Epoch 54, Val Loss: 2.18938
Epoch 55, Val Loss: 2.18381
Epoch 56, Val Loss: 2.17797
Epoch 57, Val Loss: 2.18555
Epoch 58, Val Loss: 2.18837
Epoch 59, Val Loss: 2.20650
Epoch 60, Val Loss: 2.19001
Epoch 61, Val Loss: 2.19676
Epoch 62, Val Loss: 2.19890
Epoch 63, Val Loss: 2.23244
Epoch 64, Val Loss: 2.19919
Epoch 65, Val Loss: 2.18106
Epoch 66, Val Loss: 2.19756
Epoch 67, Val Loss: 2.20445
Epoch 68, Val Loss: 2.19325
Epoch 69, Val Loss: 2.23561
Epoch 70, Val Loss: 2.19559
Epoch 71, Val Loss: 2.21805
Epoch 72, Val Loss: 2.18577
Epoch 73, Val Loss: 2.17555
Epoch 74, Val Loss: 2.19965
Epoch 75, Val Loss: 2.21207
Epoch 76, Val Loss: 2.20691
Epoch 77, Val Loss: 2.20051
Epoch 78, Val Loss: 2.28493
Epoch 79, Val Loss: 2.21269
Epoch 80, Val Loss: 2.18241
Epoch 81, Val Loss: 2.19722
Epoch 82, Val Loss: 2.18074
Epoch 83, Val Loss: 2.21108
Epoch 84, Val Loss: 2.20017
Epoch 85, Val Loss: 2.21353
Epoch 86, Val Loss: 2.20666
Epoch 87, Val Loss: 2.18515
Epoch 88, Val Loss: 2.21235
Epoch 89, Val Loss: 2.19755
Epoch 90, Val Loss: 2.19659
Epoch 91, Val Loss: 2.20367
Epoch 92, Val Loss: 2.26611
Epoch 93, Val Loss: 2.19074
Epoch 94, Val Loss: 2.17578
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 2.52638, 'Log Loss - std': 0.593724449218659} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 44 finished with value: 2.52638 and parameters: {'p_m': 0.22686040712165878, 'alpha': 3.6122385176561593, 'K': 10, 'beta': 2.023365998653599}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3957989355141534, 'alpha': 0.540155206232277, 'K': 10, 'beta': 0.11316780086421517}
Fitted encoder
Epoch 0, Val Loss: 2.56670
Epoch 1, Val Loss: 2.68396
Epoch 2, Val Loss: 2.68396
Epoch 3, Val Loss: 2.68396
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.68396
Epoch 8, Val Loss: 2.68203
Epoch 9, Val Loss: 2.68203
Epoch 10, Val Loss: 2.68203
Epoch 11, Val Loss: 2.68203
Epoch 12, Val Loss: 2.68203
Epoch 13, Val Loss: 2.68203
Epoch 14, Val Loss: 2.68203
Epoch 15, Val Loss: 2.68203
Epoch 16, Val Loss: 2.68203
Epoch 17, Val Loss: 2.68203
Epoch 18, Val Loss: 2.68203
Epoch 19, Val Loss: 2.68203
Epoch 20, Val Loss: 2.68460
Epoch 21, Val Loss: 2.68460
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.1126, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3957989355141534, 'alpha': 0.540155206232277, 'K': 10, 'beta': 0.11316780086421517}
Fitted encoder
Epoch 0, Val Loss: 2.68745
Epoch 1, Val Loss: 2.68745
Epoch 2, Val Loss: 2.68745
Epoch 3, Val Loss: 2.68745
Epoch 4, Val Loss: 2.68745
Epoch 5, Val Loss: 2.68745
Epoch 6, Val Loss: 2.68745
Epoch 7, Val Loss: 2.68745
Epoch 8, Val Loss: 2.68745
Epoch 9, Val Loss: 2.68745
Epoch 10, Val Loss: 2.68267
Epoch 11, Val Loss: 2.68267
Epoch 12, Val Loss: 2.68267
Epoch 13, Val Loss: 2.68267
Epoch 14, Val Loss: 2.68267
Epoch 15, Val Loss: 2.68267
Epoch 16, Val Loss: 2.68267
Epoch 17, Val Loss: 2.68543
Epoch 18, Val Loss: 2.68543
Epoch 19, Val Loss: 2.68543
Epoch 20, Val Loss: 2.68543
Epoch 21, Val Loss: 2.68644
Epoch 22, Val Loss: 2.68644
Epoch 23, Val Loss: 2.68644
Epoch 24, Val Loss: 2.68644
Epoch 25, Val Loss: 2.68543
Epoch 26, Val Loss: 2.68543
Epoch 27, Val Loss: 2.68543
Epoch 28, Val Loss: 2.68543
Epoch 29, Val Loss: 2.68543
Epoch 30, Val Loss: 2.68543
Epoch 31, Val Loss: 2.68543
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.3939, 'Log Loss - std': 1.2812999999999999} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3957989355141534, 'alpha': 0.540155206232277, 'K': 10, 'beta': 0.11316780086421517}
Fitted encoder
Epoch 0, Val Loss: 2.61906
Epoch 1, Val Loss: 2.68718
Epoch 2, Val Loss: 2.68718
Epoch 3, Val Loss: 2.68718
Epoch 4, Val Loss: 2.68718
Epoch 5, Val Loss: 2.68718
Epoch 6, Val Loss: 2.68718
Epoch 7, Val Loss: 2.68718
Epoch 8, Val Loss: 2.68718
Epoch 9, Val Loss: 2.68240
Epoch 10, Val Loss: 2.68240
Epoch 11, Val Loss: 2.68240
Epoch 12, Val Loss: 2.68240
Epoch 13, Val Loss: 2.68240
Epoch 14, Val Loss: 2.68240
Epoch 15, Val Loss: 2.68240
Epoch 16, Val Loss: 2.68479
Epoch 17, Val Loss: 2.68479
Epoch 18, Val Loss: 2.68479
Epoch 19, Val Loss: 2.68479
Epoch 20, Val Loss: 2.68479
Epoch 21, Val Loss: 2.68479
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.574766666666667, 'Log Loss - std': 1.0769920901391161} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3957989355141534, 'alpha': 0.540155206232277, 'K': 10, 'beta': 0.11316780086421517}
Fitted encoder
Epoch 0, Val Loss: 2.67734
Epoch 1, Val Loss: 2.67734
Epoch 2, Val Loss: 2.67734
Epoch 3, Val Loss: 2.67734
Epoch 4, Val Loss: 2.67734
Epoch 5, Val Loss: 2.67734
Epoch 6, Val Loss: 2.67881
Epoch 7, Val Loss: 2.67881
Epoch 8, Val Loss: 2.67881
Epoch 9, Val Loss: 2.68515
Epoch 10, Val Loss: 2.68515
Epoch 11, Val Loss: 2.68515
Epoch 12, Val Loss: 2.68515
Epoch 13, Val Loss: 2.68515
Epoch 14, Val Loss: 2.68515
Epoch 15, Val Loss: 2.68515
Epoch 16, Val Loss: 2.68515
Epoch 17, Val Loss: 2.68515
Epoch 18, Val Loss: 2.68515
Epoch 19, Val Loss: 2.68515
Epoch 20, Val Loss: 2.68515
Epoch 21, Val Loss: 2.68515
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.8344, 'Log Loss - std': 1.0354527391436077} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3957989355141534, 'alpha': 0.540155206232277, 'K': 10, 'beta': 0.11316780086421517}
Fitted encoder
Epoch 0, Val Loss: 2.68039
Epoch 1, Val Loss: 2.62273
Epoch 2, Val Loss: 2.68938
Epoch 3, Val Loss: 2.68938
Epoch 4, Val Loss: 2.68938
Epoch 5, Val Loss: 2.68938
Epoch 6, Val Loss: 2.68938
Epoch 7, Val Loss: 2.68938
Epoch 8, Val Loss: 2.68938
Epoch 9, Val Loss: 2.68938
Epoch 10, Val Loss: 2.68938
Epoch 11, Val Loss: 2.68938
Epoch 12, Val Loss: 2.68938
Epoch 13, Val Loss: 2.68938
Epoch 14, Val Loss: 2.68938
Epoch 15, Val Loss: 2.68938
Epoch 16, Val Loss: 2.68938
Epoch 17, Val Loss: 2.68938
Epoch 18, Val Loss: 2.68938
Epoch 19, Val Loss: 2.68938
Epoch 20, Val Loss: 2.68938
Epoch 21, Val Loss: 2.68938
Epoch 22, Val Loss: 2.60143
Epoch 23, Val Loss: 2.67348
Epoch 24, Val Loss: 2.67348
Epoch 25, Val Loss: 2.67348
Epoch 26, Val Loss: 2.67348
Epoch 27, Val Loss: 2.67348
Epoch 28, Val Loss: 2.67348
Epoch 29, Val Loss: 2.53765
Epoch 30, Val Loss: 2.68938
Epoch 31, Val Loss: 2.68938
Epoch 32, Val Loss: 2.68938
Epoch 33, Val Loss: 2.61576
Epoch 34, Val Loss: 2.62861
Epoch 35, Val Loss: 2.63194
Epoch 36, Val Loss: 2.62797
Epoch 37, Val Loss: 2.68350
Epoch 38, Val Loss: 2.68350
Epoch 39, Val Loss: 2.68350
Epoch 40, Val Loss: 2.68350
Epoch 41, Val Loss: 2.68350
Epoch 42, Val Loss: 2.68350
Epoch 43, Val Loss: 2.68350
Epoch 44, Val Loss: 2.68350
Epoch 45, Val Loss: 2.68350
Epoch 46, Val Loss: 2.68350
Epoch 47, Val Loss: 2.68350
Epoch 48, Val Loss: 2.68350
Epoch 49, Val Loss: 2.68350
Epoch 50, Val Loss: 2.68350
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.4726, 'Log Loss - std': 1.1752986258819502} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 45 finished with value: 9.4726 and parameters: {'p_m': 0.3957989355141534, 'alpha': 0.540155206232277, 'K': 10, 'beta': 0.11316780086421517}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.40304010747633934, 'alpha': 0.5636225548789691, 'K': 5, 'beta': 5.711137244678305}
Fitted encoder
Epoch 0, Val Loss: 2.24970
Epoch 1, Val Loss: 2.21374
Epoch 2, Val Loss: 2.24482
Epoch 3, Val Loss: 2.19988
Epoch 4, Val Loss: 2.24765
Epoch 5, Val Loss: 2.17222
Epoch 6, Val Loss: 2.21074
Epoch 7, Val Loss: 2.18810
Epoch 8, Val Loss: 2.16177
Epoch 9, Val Loss: 2.15157
Epoch 10, Val Loss: 2.18584
Epoch 11, Val Loss: 2.17692
Epoch 12, Val Loss: 2.17319
Epoch 13, Val Loss: 2.17948
Epoch 14, Val Loss: 2.20006
Epoch 15, Val Loss: 2.15762
Epoch 16, Val Loss: 2.14187
Epoch 17, Val Loss: 2.16972
Epoch 18, Val Loss: 2.16060
Epoch 19, Val Loss: 2.18950
Epoch 20, Val Loss: 2.23576
Epoch 21, Val Loss: 2.17230
Epoch 22, Val Loss: 2.17526
Epoch 23, Val Loss: 2.17168
Epoch 24, Val Loss: 2.16805
Epoch 25, Val Loss: 2.15359
Epoch 26, Val Loss: 2.14426
Epoch 27, Val Loss: 2.14298
Epoch 28, Val Loss: 2.20506
Epoch 29, Val Loss: 2.13706
Epoch 30, Val Loss: 2.14643
Epoch 31, Val Loss: 2.24192
Epoch 32, Val Loss: 2.15528
Epoch 33, Val Loss: 2.17381
Epoch 34, Val Loss: 2.18395
Epoch 35, Val Loss: 2.20701
Epoch 36, Val Loss: 2.18319
Epoch 37, Val Loss: 2.17240
Epoch 38, Val Loss: 2.14006
Epoch 39, Val Loss: 2.15183
Epoch 40, Val Loss: 2.13750
Epoch 41, Val Loss: 2.16101
Epoch 42, Val Loss: 2.20739
Epoch 43, Val Loss: 2.20363
Epoch 44, Val Loss: 2.18044
Epoch 45, Val Loss: 2.19534
Epoch 46, Val Loss: 2.17712
Epoch 47, Val Loss: 2.16456
Epoch 48, Val Loss: 2.15272
Epoch 49, Val Loss: 2.13614
Epoch 50, Val Loss: 2.16938
Epoch 51, Val Loss: 2.17032
Epoch 52, Val Loss: 2.16998
Epoch 53, Val Loss: 2.19477
Epoch 54, Val Loss: 2.17173
Epoch 55, Val Loss: 2.18900
Epoch 56, Val Loss: 2.17165
Epoch 57, Val Loss: 2.18903
Epoch 58, Val Loss: 2.15748
Epoch 59, Val Loss: 2.19335
Epoch 60, Val Loss: 2.20177
Epoch 61, Val Loss: 2.14762
Epoch 62, Val Loss: 2.15535
Epoch 63, Val Loss: 2.14809
Epoch 64, Val Loss: 2.14849
Epoch 65, Val Loss: 2.15522
Epoch 66, Val Loss: 2.24260
Epoch 67, Val Loss: 2.16587
Epoch 68, Val Loss: 2.16409
Epoch 69, Val Loss: 2.15203
Epoch 70, Val Loss: 2.21777
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.4806, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.40304010747633934, 'alpha': 0.5636225548789691, 'K': 5, 'beta': 5.711137244678305}
Fitted encoder
Epoch 0, Val Loss: 2.28801
Epoch 1, Val Loss: 2.28885
Epoch 2, Val Loss: 2.26173
Epoch 3, Val Loss: 2.24040
Epoch 4, Val Loss: 2.22418
Epoch 5, Val Loss: 2.20636
Epoch 6, Val Loss: 2.20623
Epoch 7, Val Loss: 2.21773
Epoch 8, Val Loss: 2.21024
Epoch 9, Val Loss: 2.20907
Epoch 10, Val Loss: 2.20309
Epoch 11, Val Loss: 2.19657
Epoch 12, Val Loss: 2.19534
Epoch 13, Val Loss: 2.20187
Epoch 14, Val Loss: 2.20960
Epoch 15, Val Loss: 2.18894
Epoch 16, Val Loss: 2.18480
Epoch 17, Val Loss: 2.18893
Epoch 18, Val Loss: 2.19785
Epoch 19, Val Loss: 2.22298
Epoch 20, Val Loss: 2.17802
Epoch 21, Val Loss: 2.24514
Epoch 22, Val Loss: 2.18327
Epoch 23, Val Loss: 2.17614
Epoch 24, Val Loss: 2.17323
Epoch 25, Val Loss: 2.19368
Epoch 26, Val Loss: 2.17643
Epoch 27, Val Loss: 2.18956
Epoch 28, Val Loss: 2.17284
Epoch 29, Val Loss: 2.17680
Epoch 30, Val Loss: 2.17117
Epoch 31, Val Loss: 2.18352
Epoch 32, Val Loss: 2.17549
Epoch 33, Val Loss: 2.17790
Epoch 34, Val Loss: 2.19198
Epoch 35, Val Loss: 2.16446
Epoch 36, Val Loss: 2.22139
Epoch 37, Val Loss: 2.19075
Epoch 38, Val Loss: 2.20813
Epoch 39, Val Loss: 2.18475
Epoch 40, Val Loss: 2.18535
Epoch 41, Val Loss: 2.20078
Epoch 42, Val Loss: 2.17964
Epoch 43, Val Loss: 2.16386
Epoch 44, Val Loss: 2.18884
Epoch 45, Val Loss: 2.18854
Epoch 46, Val Loss: 2.16574
Epoch 47, Val Loss: 2.18819
Epoch 48, Val Loss: 2.18603
Epoch 49, Val Loss: 2.21412
Epoch 50, Val Loss: 2.18745
Epoch 51, Val Loss: 2.22796
Epoch 52, Val Loss: 2.16330
Epoch 53, Val Loss: 2.20910
Epoch 54, Val Loss: 2.18969
Epoch 55, Val Loss: 2.17765
Epoch 56, Val Loss: 2.17976
Epoch 57, Val Loss: 2.17525
Epoch 58, Val Loss: 2.18487
Epoch 59, Val Loss: 2.22476
Epoch 60, Val Loss: 2.17802
Epoch 61, Val Loss: 2.17772
Epoch 62, Val Loss: 2.19425
Epoch 63, Val Loss: 2.21129
Epoch 64, Val Loss: 2.22827
Epoch 65, Val Loss: 2.17932
Epoch 66, Val Loss: 2.19739
Epoch 67, Val Loss: 2.17461
Epoch 68, Val Loss: 2.18383
Epoch 69, Val Loss: 2.18105
Epoch 70, Val Loss: 2.17095
Epoch 71, Val Loss: 2.17648
Epoch 72, Val Loss: 2.18847
Epoch 73, Val Loss: 2.19090
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.22595, 'Log Loss - std': 0.25464999999999993} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.40304010747633934, 'alpha': 0.5636225548789691, 'K': 5, 'beta': 5.711137244678305}
Fitted encoder
Epoch 0, Val Loss: 2.32515
Epoch 1, Val Loss: 2.24634
Epoch 2, Val Loss: 2.26903
Epoch 3, Val Loss: 2.22297
Epoch 4, Val Loss: 2.31247
Epoch 5, Val Loss: 2.19577
Epoch 6, Val Loss: 2.22334
Epoch 7, Val Loss: 2.18857
Epoch 8, Val Loss: 2.17578
Epoch 9, Val Loss: 2.20312
Epoch 10, Val Loss: 2.19591
Epoch 11, Val Loss: 2.18375
Epoch 12, Val Loss: 2.20191
Epoch 13, Val Loss: 2.23998
Epoch 14, Val Loss: 2.18885
Epoch 15, Val Loss: 2.18357
Epoch 16, Val Loss: 2.23485
Epoch 17, Val Loss: 2.17237
Epoch 18, Val Loss: 2.27846
Epoch 19, Val Loss: 2.17958
Epoch 20, Val Loss: 2.26984
Epoch 21, Val Loss: 2.35697
Epoch 22, Val Loss: 2.17994
Epoch 23, Val Loss: 2.26763
Epoch 24, Val Loss: 2.19843
Epoch 25, Val Loss: 2.18791
Epoch 26, Val Loss: 2.16958
Epoch 27, Val Loss: 2.24982
Epoch 28, Val Loss: 2.18007
Epoch 29, Val Loss: 2.24748
Epoch 30, Val Loss: 2.26561
Epoch 31, Val Loss: 2.16589
Epoch 32, Val Loss: 2.25133
Epoch 33, Val Loss: 2.20603
Epoch 34, Val Loss: 2.36823
Epoch 35, Val Loss: 2.19691
Epoch 36, Val Loss: 2.19652
Epoch 37, Val Loss: 2.24292
Epoch 38, Val Loss: 2.24523
Epoch 39, Val Loss: 2.19397
Epoch 40, Val Loss: 2.28408
Epoch 41, Val Loss: 2.22281
Epoch 42, Val Loss: 2.18941
Epoch 43, Val Loss: 2.23910
Epoch 44, Val Loss: 2.20647
Epoch 45, Val Loss: 2.18849
Epoch 46, Val Loss: 2.21873
Epoch 47, Val Loss: 2.17074
Epoch 48, Val Loss: 2.18777
Epoch 49, Val Loss: 2.22395
Epoch 50, Val Loss: 2.22684
Epoch 51, Val Loss: 2.20175
Epoch 52, Val Loss: 2.18408
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.4392000000000003, 'Log Loss - std': 0.3663088951508912} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.40304010747633934, 'alpha': 0.5636225548789691, 'K': 5, 'beta': 5.711137244678305}
Fitted encoder
Epoch 0, Val Loss: 2.34695
Epoch 1, Val Loss: 2.29006
Epoch 2, Val Loss: 2.26100
Epoch 3, Val Loss: 2.31817
Epoch 4, Val Loss: 2.25630
Epoch 5, Val Loss: 2.24541
Epoch 6, Val Loss: 2.28019
Epoch 7, Val Loss: 2.17498
Epoch 8, Val Loss: 2.21573
Epoch 9, Val Loss: 2.18592
Epoch 10, Val Loss: 2.25742
Epoch 11, Val Loss: 2.16876
Epoch 12, Val Loss: 2.16985
Epoch 13, Val Loss: 2.15375
Epoch 14, Val Loss: 2.26660
Epoch 15, Val Loss: 2.16125
Epoch 16, Val Loss: 2.27224
Epoch 17, Val Loss: 2.23793
Epoch 18, Val Loss: 2.16862
Epoch 19, Val Loss: 2.17490
Epoch 20, Val Loss: 2.19096
Epoch 21, Val Loss: 2.24371
Epoch 22, Val Loss: 2.19280
Epoch 23, Val Loss: 2.20874
Epoch 24, Val Loss: 2.14121
Epoch 25, Val Loss: 2.19784
Epoch 26, Val Loss: 2.20644
Epoch 27, Val Loss: 2.17952
Epoch 28, Val Loss: 2.14614
Epoch 29, Val Loss: 2.19454
Epoch 30, Val Loss: 2.16233
Epoch 31, Val Loss: 2.23263
Epoch 32, Val Loss: 2.20911
Epoch 33, Val Loss: 2.28530
Epoch 34, Val Loss: 2.16924
Epoch 35, Val Loss: 2.16926
Epoch 36, Val Loss: 2.16912
Epoch 37, Val Loss: 2.16420
Epoch 38, Val Loss: 2.30317
Epoch 39, Val Loss: 2.20490
Epoch 40, Val Loss: 2.14471
Epoch 41, Val Loss: 2.28784
Epoch 42, Val Loss: 2.13853
Epoch 43, Val Loss: 2.13260
Epoch 44, Val Loss: 2.16755
Epoch 45, Val Loss: 2.18992
Epoch 46, Val Loss: 2.15655
Epoch 47, Val Loss: 2.16984
Epoch 48, Val Loss: 2.21571
Epoch 49, Val Loss: 2.13672
Epoch 50, Val Loss: 2.15098
Epoch 51, Val Loss: 2.22371
Epoch 52, Val Loss: 2.19161
Epoch 53, Val Loss: 2.15302
Epoch 54, Val Loss: 2.16677
Epoch 55, Val Loss: 2.20741
Epoch 56, Val Loss: 2.14970
Epoch 57, Val Loss: 2.18171
Epoch 58, Val Loss: 2.22825
Epoch 59, Val Loss: 2.20357
Epoch 60, Val Loss: 2.34840
Epoch 61, Val Loss: 2.16443
Epoch 62, Val Loss: 2.40679
Epoch 63, Val Loss: 2.22391
Epoch 64, Val Loss: 2.22972
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.488525, 'Log Loss - std': 0.32853541951363474} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.40304010747633934, 'alpha': 0.5636225548789691, 'K': 5, 'beta': 5.711137244678305}
Fitted encoder
Epoch 0, Val Loss: 2.22682
Epoch 1, Val Loss: 2.26715
Epoch 2, Val Loss: 2.17622
Epoch 3, Val Loss: 2.18932
Epoch 4, Val Loss: 2.16607
Epoch 5, Val Loss: 2.17174
Epoch 6, Val Loss: 2.19587
Epoch 7, Val Loss: 2.19879
Epoch 8, Val Loss: 2.21957
Epoch 9, Val Loss: 2.23076
Epoch 10, Val Loss: 2.19983
Epoch 11, Val Loss: 2.19856
Epoch 12, Val Loss: 2.15433
Epoch 13, Val Loss: 2.20752
Epoch 14, Val Loss: 2.18773
Epoch 15, Val Loss: 2.20634
Epoch 16, Val Loss: 2.17167
Epoch 17, Val Loss: 2.16759
Epoch 18, Val Loss: 2.22472
Epoch 19, Val Loss: 2.19855
Epoch 20, Val Loss: 2.24131
Epoch 21, Val Loss: 2.22438
Epoch 22, Val Loss: 2.16421
Epoch 23, Val Loss: 2.19768
Epoch 24, Val Loss: 2.19816
Epoch 25, Val Loss: 2.22628
Epoch 26, Val Loss: 2.17396
Epoch 27, Val Loss: 2.18540
Epoch 28, Val Loss: 2.17426
Epoch 29, Val Loss: 2.16073
Epoch 30, Val Loss: 2.15604
Epoch 31, Val Loss: 2.17743
Epoch 32, Val Loss: 2.15288
Epoch 33, Val Loss: 2.20039
Epoch 34, Val Loss: 2.22052
Epoch 35, Val Loss: 2.19491
Epoch 36, Val Loss: 2.16264
Epoch 37, Val Loss: 2.19970
Epoch 38, Val Loss: 2.15278
Epoch 39, Val Loss: 2.16808
Epoch 40, Val Loss: 2.22890
Epoch 41, Val Loss: 2.16914
Epoch 42, Val Loss: 2.22089
Epoch 43, Val Loss: 2.17348
Epoch 44, Val Loss: 2.16086
Epoch 45, Val Loss: 2.16451
Epoch 46, Val Loss: 2.16543
Epoch 47, Val Loss: 2.20997
Epoch 48, Val Loss: 2.24225
Epoch 49, Val Loss: 2.19523
Epoch 50, Val Loss: 2.26522
Epoch 51, Val Loss: 2.13940
Epoch 52, Val Loss: 2.16694
Epoch 53, Val Loss: 2.15243
Epoch 54, Val Loss: 2.16570
Epoch 55, Val Loss: 2.18936
Epoch 56, Val Loss: 2.18458
Epoch 57, Val Loss: 2.17075
Epoch 58, Val Loss: 2.13920
Epoch 59, Val Loss: 2.17268
Epoch 60, Val Loss: 2.17870
Epoch 61, Val Loss: 2.15972
Epoch 62, Val Loss: 2.18668
Epoch 63, Val Loss: 2.18620
Epoch 64, Val Loss: 2.17890
Epoch 65, Val Loss: 2.17939
Epoch 66, Val Loss: 2.20978
Epoch 67, Val Loss: 2.18672
Epoch 68, Val Loss: 2.14517
Epoch 69, Val Loss: 2.17440
Epoch 70, Val Loss: 2.19873
Epoch 71, Val Loss: 2.14775
Epoch 72, Val Loss: 2.17559
Epoch 73, Val Loss: 2.17857
Epoch 74, Val Loss: 2.18534
Epoch 75, Val Loss: 2.16293
Epoch 76, Val Loss: 2.14373
Epoch 77, Val Loss: 2.17979
Epoch 78, Val Loss: 2.16885
Epoch 79, Val Loss: 2.18962
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.5516200000000002, 'Log Loss - std': 0.3198004590365686} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 46 finished with value: 1.5516200000000002 and parameters: {'p_m': 0.40304010747633934, 'alpha': 0.5636225548789691, 'K': 5, 'beta': 5.711137244678305}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2802390836557083, 'alpha': 1.2456260456319264, 'K': 10, 'beta': 7.201261951812437}
Fitted encoder
Epoch 0, Val Loss: 2.27342
Epoch 1, Val Loss: 2.28438
Epoch 2, Val Loss: 2.24870
Epoch 3, Val Loss: 2.22152
Epoch 4, Val Loss: 2.22925
Epoch 5, Val Loss: 2.19833
Epoch 6, Val Loss: 2.21556
Epoch 7, Val Loss: 2.19417
Epoch 8, Val Loss: 2.20476
Epoch 9, Val Loss: 2.19724
Epoch 10, Val Loss: 2.21907
Epoch 11, Val Loss: 2.22588
Epoch 12, Val Loss: 2.30410
Epoch 13, Val Loss: 2.18938
Epoch 14, Val Loss: 2.18415
Epoch 15, Val Loss: 2.19517
Epoch 16, Val Loss: 2.17359
Epoch 17, Val Loss: 2.23279
Epoch 18, Val Loss: 2.17341
Epoch 19, Val Loss: 2.19031
Epoch 20, Val Loss: 2.18932
Epoch 21, Val Loss: 2.27401
Epoch 22, Val Loss: 2.20613
Epoch 23, Val Loss: 2.19970
Epoch 24, Val Loss: 2.18823
Epoch 25, Val Loss: 2.17430
Epoch 26, Val Loss: 2.20385
Epoch 27, Val Loss: 2.17735
Epoch 28, Val Loss: 2.21667
Epoch 29, Val Loss: 2.24198
Epoch 30, Val Loss: 2.22810
Epoch 31, Val Loss: 2.17382
Epoch 32, Val Loss: 2.17146
Epoch 33, Val Loss: 2.18615
Epoch 34, Val Loss: 2.26345
Epoch 35, Val Loss: 2.19707
Epoch 36, Val Loss: 2.18842
Epoch 37, Val Loss: 2.22980
Epoch 38, Val Loss: 2.21311
Epoch 39, Val Loss: 2.24845
Epoch 40, Val Loss: 2.18915
Epoch 41, Val Loss: 2.22597
Epoch 42, Val Loss: 2.18012
Epoch 43, Val Loss: 2.21329
Epoch 44, Val Loss: 2.17308
Epoch 45, Val Loss: 2.18318
Epoch 46, Val Loss: 2.29067
Epoch 47, Val Loss: 2.20665
Epoch 48, Val Loss: 2.17250
Epoch 49, Val Loss: 2.16893
Epoch 50, Val Loss: 2.17645
Epoch 51, Val Loss: 2.24951
Epoch 52, Val Loss: 2.17175
Epoch 53, Val Loss: 2.25195
Epoch 54, Val Loss: 2.19216
Epoch 55, Val Loss: 2.18410
Epoch 56, Val Loss: 2.17462
Epoch 57, Val Loss: 2.21820
Epoch 58, Val Loss: 2.16553
Epoch 59, Val Loss: 2.19088
Epoch 60, Val Loss: 2.17708
Epoch 61, Val Loss: 2.18409
Epoch 62, Val Loss: 2.16967
Epoch 63, Val Loss: 2.17766
Epoch 64, Val Loss: 2.20146
Epoch 65, Val Loss: 2.17823
Epoch 66, Val Loss: 2.20131
Epoch 67, Val Loss: 2.18390
Epoch 68, Val Loss: 2.18632
Epoch 69, Val Loss: 2.20752
Epoch 70, Val Loss: 2.18475
Epoch 71, Val Loss: 2.18875
Epoch 72, Val Loss: 2.32223
Epoch 73, Val Loss: 2.21347
Epoch 74, Val Loss: 2.21382
Epoch 75, Val Loss: 2.18177
Epoch 76, Val Loss: 2.22385
Epoch 77, Val Loss: 2.22452
Epoch 78, Val Loss: 2.18507
Epoch 79, Val Loss: 2.19204
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.5149, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2802390836557083, 'alpha': 1.2456260456319264, 'K': 10, 'beta': 7.201261951812437}
Fitted encoder
Epoch 0, Val Loss: 2.24008
Epoch 1, Val Loss: 2.24021
Epoch 2, Val Loss: 2.24206
Epoch 3, Val Loss: 2.18156
Epoch 4, Val Loss: 2.21523
Epoch 5, Val Loss: 2.16388
Epoch 6, Val Loss: 2.20924
Epoch 7, Val Loss: 2.18630
Epoch 8, Val Loss: 2.17587
Epoch 9, Val Loss: 2.16359
Epoch 10, Val Loss: 2.16345
Epoch 11, Val Loss: 2.17319
Epoch 12, Val Loss: 2.20656
Epoch 13, Val Loss: 2.16106
Epoch 14, Val Loss: 2.15810
Epoch 15, Val Loss: 2.16546
Epoch 16, Val Loss: 2.15998
Epoch 17, Val Loss: 2.19512
Epoch 18, Val Loss: 2.15229
Epoch 19, Val Loss: 2.18607
Epoch 20, Val Loss: 2.15381
Epoch 21, Val Loss: 2.15370
Epoch 22, Val Loss: 2.15919
Epoch 23, Val Loss: 2.19459
Epoch 24, Val Loss: 2.15651
Epoch 25, Val Loss: 2.15956
Epoch 26, Val Loss: 2.14008
Epoch 27, Val Loss: 2.16107
Epoch 28, Val Loss: 2.19787
Epoch 29, Val Loss: 2.16402
Epoch 30, Val Loss: 2.23027
Epoch 31, Val Loss: 2.19516
Epoch 32, Val Loss: 2.20776
Epoch 33, Val Loss: 2.17229
Epoch 34, Val Loss: 2.25623
Epoch 35, Val Loss: 2.23631
Epoch 36, Val Loss: 2.17006
Epoch 37, Val Loss: 2.18762
Epoch 38, Val Loss: 2.15374
Epoch 39, Val Loss: 2.16666
Epoch 40, Val Loss: 2.15459
Epoch 41, Val Loss: 2.16529
Epoch 42, Val Loss: 2.19702
Epoch 43, Val Loss: 2.16479
Epoch 44, Val Loss: 2.15307
Epoch 45, Val Loss: 2.18442
Epoch 46, Val Loss: 2.17630
Epoch 47, Val Loss: 2.16687
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.43655, 'Log Loss - std': 0.07834999999999992} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2802390836557083, 'alpha': 1.2456260456319264, 'K': 10, 'beta': 7.201261951812437}
Fitted encoder
Epoch 0, Val Loss: 2.27837
Epoch 1, Val Loss: 2.19254
Epoch 2, Val Loss: 2.22660
Epoch 3, Val Loss: 2.20385
Epoch 4, Val Loss: 2.16009
Epoch 5, Val Loss: 2.21230
Epoch 6, Val Loss: 2.15894
Epoch 7, Val Loss: 2.18289
Epoch 8, Val Loss: 2.20560
Epoch 9, Val Loss: 2.17054
Epoch 10, Val Loss: 2.18736
Epoch 11, Val Loss: 2.16166
Epoch 12, Val Loss: 2.16792
Epoch 13, Val Loss: 2.16544
Epoch 14, Val Loss: 2.17621
Epoch 15, Val Loss: 2.20473
Epoch 16, Val Loss: 2.15278
Epoch 17, Val Loss: 2.23463
Epoch 18, Val Loss: 2.18276
Epoch 19, Val Loss: 2.17086
Epoch 20, Val Loss: 2.19095
Epoch 21, Val Loss: 2.16441
Epoch 22, Val Loss: 2.14208
Epoch 23, Val Loss: 2.15406
Epoch 24, Val Loss: 2.18508
Epoch 25, Val Loss: 2.18118
Epoch 26, Val Loss: 2.18280
Epoch 27, Val Loss: 2.19404
Epoch 28, Val Loss: 2.18733
Epoch 29, Val Loss: 2.17232
Epoch 30, Val Loss: 2.17903
Epoch 31, Val Loss: 2.15474
Epoch 32, Val Loss: 2.31354
Epoch 33, Val Loss: 2.16732
Epoch 34, Val Loss: 2.16162
Epoch 35, Val Loss: 2.19502
Epoch 36, Val Loss: 2.19530
Epoch 37, Val Loss: 2.15049
Epoch 38, Val Loss: 2.16672
Epoch 39, Val Loss: 2.20208
Epoch 40, Val Loss: 2.17244
Epoch 41, Val Loss: 2.17393
Epoch 42, Val Loss: 2.15964
Epoch 43, Val Loss: 2.19013
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.4056, 'Log Loss - std': 0.07751313867123859} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2802390836557083, 'alpha': 1.2456260456319264, 'K': 10, 'beta': 7.201261951812437}
Fitted encoder
Epoch 0, Val Loss: 2.28754
Epoch 1, Val Loss: 2.22027
Epoch 2, Val Loss: 2.23825
Epoch 3, Val Loss: 2.20649
Epoch 4, Val Loss: 2.22683
Epoch 5, Val Loss: 2.19962
Epoch 6, Val Loss: 2.18410
Epoch 7, Val Loss: 2.20301
Epoch 8, Val Loss: 2.21027
Epoch 9, Val Loss: 2.21842
Epoch 10, Val Loss: 2.17056
Epoch 11, Val Loss: 2.20024
Epoch 12, Val Loss: 2.17171
Epoch 13, Val Loss: 2.16094
Epoch 14, Val Loss: 2.19354
Epoch 15, Val Loss: 2.21518
Epoch 16, Val Loss: 2.15868
Epoch 17, Val Loss: 2.16646
Epoch 18, Val Loss: 2.17684
Epoch 19, Val Loss: 2.18223
Epoch 20, Val Loss: 2.17487
Epoch 21, Val Loss: 2.19424
Epoch 22, Val Loss: 2.22899
Epoch 23, Val Loss: 2.17315
Epoch 24, Val Loss: 2.16802
Epoch 25, Val Loss: 2.17173
Epoch 26, Val Loss: 2.22138
Epoch 27, Val Loss: 2.16071
Epoch 28, Val Loss: 2.15857
Epoch 29, Val Loss: 2.16484
Epoch 30, Val Loss: 2.16290
Epoch 31, Val Loss: 2.16278
Epoch 32, Val Loss: 2.16401
Epoch 33, Val Loss: 2.16710
Epoch 34, Val Loss: 2.19484
Epoch 35, Val Loss: 2.16262
Epoch 36, Val Loss: 2.20845
Epoch 37, Val Loss: 2.15715
Epoch 38, Val Loss: 2.16767
Epoch 39, Val Loss: 2.19074
Epoch 40, Val Loss: 2.17574
Epoch 41, Val Loss: 2.16797
Epoch 42, Val Loss: 2.18844
Epoch 43, Val Loss: 2.18470
Epoch 44, Val Loss: 2.18351
Epoch 45, Val Loss: 2.23073
Epoch 46, Val Loss: 2.20656
Epoch 47, Val Loss: 2.20720
Epoch 48, Val Loss: 2.15270
Epoch 49, Val Loss: 2.18565
Epoch 50, Val Loss: 2.16131
Epoch 51, Val Loss: 2.18497
Epoch 52, Val Loss: 2.17148
Epoch 53, Val Loss: 2.23660
Epoch 54, Val Loss: 2.17530
Epoch 55, Val Loss: 2.16214
Epoch 56, Val Loss: 2.16979
Epoch 57, Val Loss: 2.17391
Epoch 58, Val Loss: 2.16090
Epoch 59, Val Loss: 2.17266
Epoch 60, Val Loss: 2.17836
Epoch 61, Val Loss: 2.17984
Epoch 62, Val Loss: 2.17997
Epoch 63, Val Loss: 2.17266
Epoch 64, Val Loss: 2.17479
Epoch 65, Val Loss: 2.16381
Epoch 66, Val Loss: 2.18703
Epoch 67, Val Loss: 2.15545
Epoch 68, Val Loss: 2.18530
Epoch 69, Val Loss: 2.19403
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.3532250000000001, 'Log Loss - std': 0.11285227899781199} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.2802390836557083, 'alpha': 1.2456260456319264, 'K': 10, 'beta': 7.201261951812437}
Fitted encoder
Epoch 0, Val Loss: 2.37685
Epoch 1, Val Loss: 2.27792
Epoch 2, Val Loss: 2.29058
Epoch 3, Val Loss: 2.24871
Epoch 4, Val Loss: 2.22166
Epoch 5, Val Loss: 2.20782
Epoch 6, Val Loss: 2.22666
Epoch 7, Val Loss: 2.17816
Epoch 8, Val Loss: 2.22340
Epoch 9, Val Loss: 2.22438
Epoch 10, Val Loss: 2.24348
Epoch 11, Val Loss: 2.23335
Epoch 12, Val Loss: 2.19332
Epoch 13, Val Loss: 2.18881
Epoch 14, Val Loss: 2.20148
Epoch 15, Val Loss: 2.19579
Epoch 16, Val Loss: 2.19822
Epoch 17, Val Loss: 2.19963
Epoch 18, Val Loss: 2.25834
Epoch 19, Val Loss: 2.21363
Epoch 20, Val Loss: 2.25930
Epoch 21, Val Loss: 2.16190
Epoch 22, Val Loss: 2.20565
Epoch 23, Val Loss: 2.21855
Epoch 24, Val Loss: 2.24616
Epoch 25, Val Loss: 2.22778
Epoch 26, Val Loss: 2.26227
Epoch 27, Val Loss: 2.21524
Epoch 28, Val Loss: 2.16845
Epoch 29, Val Loss: 2.16126
Epoch 30, Val Loss: 2.19956
Epoch 31, Val Loss: 2.25739
Epoch 32, Val Loss: 2.19144
Epoch 33, Val Loss: 2.20333
Epoch 34, Val Loss: 2.21634
Epoch 35, Val Loss: 2.21566
Epoch 36, Val Loss: 2.16948
Epoch 37, Val Loss: 2.28956
Epoch 38, Val Loss: 2.19120
Epoch 39, Val Loss: 2.16927
Epoch 40, Val Loss: 2.16824
Epoch 41, Val Loss: 2.18988
Epoch 42, Val Loss: 2.18899
Epoch 43, Val Loss: 2.18899
Epoch 44, Val Loss: 2.16578
Epoch 45, Val Loss: 2.16750
Epoch 46, Val Loss: 2.35534
Epoch 47, Val Loss: 2.17682
Epoch 48, Val Loss: 2.16163
Epoch 49, Val Loss: 2.17677
Epoch 50, Val Loss: 2.17217
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.3749200000000001, 'Log Loss - std': 0.10986902020132883} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 47 finished with value: 1.3749200000000001 and parameters: {'p_m': 0.2802390836557083, 'alpha': 1.2456260456319264, 'K': 10, 'beta': 7.201261951812437}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3863588632512621, 'alpha': 1.7276546745062162, 'K': 15, 'beta': 1.5602093842520712}
Fitted encoder
Epoch 0, Val Loss: 2.32369
Epoch 1, Val Loss: 2.38351
Epoch 2, Val Loss: 2.35358
Epoch 3, Val Loss: 2.37672
Epoch 4, Val Loss: 2.32429
Epoch 5, Val Loss: 2.40155
Epoch 6, Val Loss: 2.25328
Epoch 7, Val Loss: 2.41424
Epoch 8, Val Loss: 2.41798
Epoch 9, Val Loss: 2.40072
Epoch 10, Val Loss: 2.38642
Epoch 11, Val Loss: 2.44234
Epoch 12, Val Loss: 2.48354
Epoch 13, Val Loss: 2.50416
Epoch 14, Val Loss: 2.48646
Epoch 15, Val Loss: 2.50192
Epoch 16, Val Loss: 2.51707
Epoch 17, Val Loss: 2.57078
Epoch 18, Val Loss: 2.49684
Epoch 19, Val Loss: 2.51147
Epoch 20, Val Loss: 2.53348
Epoch 21, Val Loss: 2.68497
Epoch 22, Val Loss: 2.68497
Epoch 23, Val Loss: 2.68497
Epoch 24, Val Loss: 2.68497
Epoch 25, Val Loss: 2.68497
Epoch 26, Val Loss: 2.68497
Epoch 27, Val Loss: 2.68497
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.581, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3863588632512621, 'alpha': 1.7276546745062162, 'K': 15, 'beta': 1.5602093842520712}
Fitted encoder
Epoch 0, Val Loss: 2.35278
Epoch 1, Val Loss: 2.40095
Epoch 2, Val Loss: 2.41866
Epoch 3, Val Loss: 2.38404
Epoch 4, Val Loss: 2.40507
Epoch 5, Val Loss: 2.55871
Epoch 6, Val Loss: 2.29752
Epoch 7, Val Loss: 2.36710
Epoch 8, Val Loss: 2.37017
Epoch 9, Val Loss: 2.37547
Epoch 10, Val Loss: 2.37363
Epoch 11, Val Loss: 2.36815
Epoch 12, Val Loss: 2.35997
Epoch 13, Val Loss: 2.32067
Epoch 14, Val Loss: 2.42977
Epoch 15, Val Loss: 2.32156
Epoch 16, Val Loss: 2.33708
Epoch 17, Val Loss: 2.32569
Epoch 18, Val Loss: 2.33784
Epoch 19, Val Loss: 2.33428
Epoch 20, Val Loss: 2.30936
Epoch 21, Val Loss: 2.30995
Epoch 22, Val Loss: 2.30586
Epoch 23, Val Loss: 2.30600
Epoch 24, Val Loss: 2.38088
Epoch 25, Val Loss: 2.31396
Epoch 26, Val Loss: 2.31982
Epoch 27, Val Loss: 2.31388
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.4507, 'Log Loss - std': 0.13030000000000008} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3863588632512621, 'alpha': 1.7276546745062162, 'K': 15, 'beta': 1.5602093842520712}
Fitted encoder
Epoch 0, Val Loss: 2.48406
Epoch 1, Val Loss: 2.43952
Epoch 2, Val Loss: 2.35832
Epoch 3, Val Loss: 2.47698
Epoch 4, Val Loss: 2.28052
Epoch 5, Val Loss: 2.37261
Epoch 6, Val Loss: 2.41402
Epoch 7, Val Loss: 2.44979
Epoch 8, Val Loss: 2.39666
Epoch 9, Val Loss: 2.42530
Epoch 10, Val Loss: 2.33425
Epoch 11, Val Loss: 2.68286
Epoch 12, Val Loss: 2.68295
Epoch 13, Val Loss: 2.68295
Epoch 14, Val Loss: 2.68295
Epoch 15, Val Loss: 2.68295
Epoch 16, Val Loss: 2.68295
Epoch 17, Val Loss: 2.68295
Epoch 18, Val Loss: 2.68295
Epoch 19, Val Loss: 2.68295
Epoch 20, Val Loss: 2.68295
Epoch 21, Val Loss: 2.68295
Epoch 22, Val Loss: 2.68295
Epoch 23, Val Loss: 2.67964
Epoch 24, Val Loss: 2.67964
Epoch 25, Val Loss: 2.67964
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.204, 'Log Loss - std': 0.3647471818488344} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3863588632512621, 'alpha': 1.7276546745062162, 'K': 15, 'beta': 1.5602093842520712}
Fitted encoder
Epoch 0, Val Loss: 2.47684
Epoch 1, Val Loss: 2.41718
Epoch 2, Val Loss: 2.41016
Epoch 3, Val Loss: 2.40830
Epoch 4, Val Loss: 2.42951
Epoch 5, Val Loss: 2.45057
Epoch 6, Val Loss: 2.40159
Epoch 7, Val Loss: 2.41042
Epoch 8, Val Loss: 2.43702
Epoch 9, Val Loss: 2.42255
Epoch 10, Val Loss: 2.41265
Epoch 11, Val Loss: 2.40821
Epoch 12, Val Loss: 2.39566
Epoch 13, Val Loss: 2.43288
Epoch 14, Val Loss: 2.40632
Epoch 15, Val Loss: 2.39657
Epoch 16, Val Loss: 2.41314
Epoch 17, Val Loss: 2.43020
Epoch 18, Val Loss: 2.39652
Epoch 19, Val Loss: 2.43627
Epoch 20, Val Loss: 2.28849
Epoch 21, Val Loss: 2.30229
Epoch 22, Val Loss: 2.28019
Epoch 23, Val Loss: 2.26923
Epoch 24, Val Loss: 2.31220
Epoch 25, Val Loss: 2.26028
Epoch 26, Val Loss: 2.25701
Epoch 27, Val Loss: 2.27657
Epoch 28, Val Loss: 2.31527
Epoch 29, Val Loss: 2.29480
Epoch 30, Val Loss: 2.28023
Epoch 31, Val Loss: 2.27802
Epoch 32, Val Loss: 2.26282
Epoch 33, Val Loss: 2.28714
Epoch 34, Val Loss: 2.25906
Epoch 35, Val Loss: 2.26789
Epoch 36, Val Loss: 2.27843
Epoch 37, Val Loss: 2.27688
Epoch 38, Val Loss: 2.30362
Epoch 39, Val Loss: 2.29631
Epoch 40, Val Loss: 2.27916
Epoch 41, Val Loss: 2.30762
Epoch 42, Val Loss: 2.28853
Epoch 43, Val Loss: 2.25292
Epoch 44, Val Loss: 2.26553
Epoch 45, Val Loss: 2.26503
Epoch 46, Val Loss: 2.28461
Epoch 47, Val Loss: 2.26088
Epoch 48, Val Loss: 2.25619
Epoch 49, Val Loss: 2.27856
Epoch 50, Val Loss: 2.28726
Epoch 51, Val Loss: 2.25723
Epoch 52, Val Loss: 2.30305
Epoch 53, Val Loss: 2.28037
Epoch 54, Val Loss: 2.26724
Epoch 55, Val Loss: 2.27657
Epoch 56, Val Loss: 2.29456
Epoch 57, Val Loss: 2.27966
Epoch 58, Val Loss: 2.30393
Epoch 59, Val Loss: 2.28070
Epoch 60, Val Loss: 2.26613
Epoch 61, Val Loss: 2.27219
Epoch 62, Val Loss: 2.28512
Epoch 63, Val Loss: 2.26819
Epoch 64, Val Loss: 2.35885
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.203125, 'Log Loss - std': 0.3158839610917275} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.3863588632512621, 'alpha': 1.7276546745062162, 'K': 15, 'beta': 1.5602093842520712}
Fitted encoder
Epoch 0, Val Loss: 2.68148
Epoch 1, Val Loss: 2.68148
Epoch 2, Val Loss: 2.68148
Epoch 3, Val Loss: 2.68148
Epoch 4, Val Loss: 2.68148
Epoch 5, Val Loss: 2.68148
Epoch 6, Val Loss: 2.68148
Epoch 7, Val Loss: 2.68148
Epoch 8, Val Loss: 2.68148
Epoch 9, Val Loss: 2.68148
Epoch 10, Val Loss: 2.68148
Epoch 11, Val Loss: 2.68148
Epoch 12, Val Loss: 2.68148
Epoch 13, Val Loss: 2.68148
Epoch 14, Val Loss: 2.68148
Epoch 15, Val Loss: 2.68148
Epoch 16, Val Loss: 2.68148
Epoch 17, Val Loss: 2.68148
Epoch 18, Val Loss: 2.66889
Epoch 19, Val Loss: 2.68148
Epoch 20, Val Loss: 2.68148
Epoch 21, Val Loss: 2.68148
Epoch 22, Val Loss: 2.68148
Epoch 23, Val Loss: 2.68148
Epoch 24, Val Loss: 2.68148
Epoch 25, Val Loss: 2.68148
Epoch 26, Val Loss: 2.68148
Epoch 27, Val Loss: 2.68148
Epoch 28, Val Loss: 2.68148
Epoch 29, Val Loss: 2.68552
Epoch 30, Val Loss: 2.68552
Epoch 31, Val Loss: 2.68552
Epoch 32, Val Loss: 2.68552
Epoch 33, Val Loss: 2.68552
Epoch 34, Val Loss: 2.68552
Epoch 35, Val Loss: 2.68552
Epoch 36, Val Loss: 2.68552
Epoch 37, Val Loss: 2.68552
Epoch 38, Val Loss: 2.68552
Epoch 39, Val Loss: 2.68552
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.66552, 'Log Loss - std': 2.938404785865964} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 48 finished with value: 4.66552 and parameters: {'p_m': 0.3863588632512621, 'alpha': 1.7276546745062162, 'K': 15, 'beta': 1.5602093842520712}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.34080159983394614, 'alpha': 2.4705533008089704, 'K': 20, 'beta': 8.933121147286453}
Fitted encoder
Epoch 0, Val Loss: 2.33531
Epoch 1, Val Loss: 2.31504
Epoch 2, Val Loss: 2.26741
Epoch 3, Val Loss: 2.26813
Epoch 4, Val Loss: 2.34750
Epoch 5, Val Loss: 2.23113
Epoch 6, Val Loss: 2.20263
Epoch 7, Val Loss: 2.24735
Epoch 8, Val Loss: 2.22264
Epoch 9, Val Loss: 2.25149
Epoch 10, Val Loss: 2.20815
Epoch 11, Val Loss: 2.19534
Epoch 12, Val Loss: 2.17489
Epoch 13, Val Loss: 2.20407
Epoch 14, Val Loss: 2.20854
Epoch 15, Val Loss: 2.21992
Epoch 16, Val Loss: 2.20681
Epoch 17, Val Loss: 2.18033
Epoch 18, Val Loss: 2.19095
Epoch 19, Val Loss: 2.19630
Epoch 20, Val Loss: 2.20070
Epoch 21, Val Loss: 2.17508
Epoch 22, Val Loss: 2.19761
Epoch 23, Val Loss: 2.18723
Epoch 24, Val Loss: 2.18045
Epoch 25, Val Loss: 2.31227
Epoch 26, Val Loss: 2.23624
Epoch 27, Val Loss: 2.39442
Epoch 28, Val Loss: 2.18769
Epoch 29, Val Loss: 2.18862
Epoch 30, Val Loss: 2.18404
Epoch 31, Val Loss: 2.21338
Epoch 32, Val Loss: 2.19557
Epoch 33, Val Loss: 2.19463
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.1571, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.34080159983394614, 'alpha': 2.4705533008089704, 'K': 20, 'beta': 8.933121147286453}
Fitted encoder
Epoch 0, Val Loss: 2.39010
Epoch 1, Val Loss: 2.33836
Epoch 2, Val Loss: 2.32242
Epoch 3, Val Loss: 2.27594
Epoch 4, Val Loss: 2.26277
Epoch 5, Val Loss: 2.29171
Epoch 6, Val Loss: 2.28278
Epoch 7, Val Loss: 2.25800
Epoch 8, Val Loss: 2.26899
Epoch 9, Val Loss: 2.25938
Epoch 10, Val Loss: 2.27043
Epoch 11, Val Loss: 2.22781
Epoch 12, Val Loss: 2.25516
Epoch 13, Val Loss: 2.28365
Epoch 14, Val Loss: 2.22721
Epoch 15, Val Loss: 2.24287
Epoch 16, Val Loss: 2.21159
Epoch 17, Val Loss: 2.21510
Epoch 18, Val Loss: 2.28634
Epoch 19, Val Loss: 2.27093
Epoch 20, Val Loss: 2.23046
Epoch 21, Val Loss: 2.23061
Epoch 22, Val Loss: 2.20164
Epoch 23, Val Loss: 2.16321
Epoch 24, Val Loss: 2.17614
Epoch 25, Val Loss: 2.18472
Epoch 26, Val Loss: 2.20116
Epoch 27, Val Loss: 2.17593
Epoch 28, Val Loss: 2.17067
Epoch 29, Val Loss: 2.16723
Epoch 30, Val Loss: 2.21083
Epoch 31, Val Loss: 2.17088
Epoch 32, Val Loss: 2.15973
Epoch 33, Val Loss: 2.18631
Epoch 34, Val Loss: 2.16692
Epoch 35, Val Loss: 2.20050
Epoch 36, Val Loss: 2.22873
Epoch 37, Val Loss: 2.23392
Epoch 38, Val Loss: 2.24470
Epoch 39, Val Loss: 2.20688
Epoch 40, Val Loss: 2.18069
Epoch 41, Val Loss: 2.25198
Epoch 42, Val Loss: 2.26135
Epoch 43, Val Loss: 2.25917
Epoch 44, Val Loss: 2.26976
Epoch 45, Val Loss: 2.25019
Epoch 46, Val Loss: 2.24917
Epoch 47, Val Loss: 2.27270
Epoch 48, Val Loss: 2.24627
Epoch 49, Val Loss: 2.23137
Epoch 50, Val Loss: 2.23251
Epoch 51, Val Loss: 2.23768
Epoch 52, Val Loss: 2.23636
Epoch 53, Val Loss: 2.22918
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.11875, 'Log Loss - std': 0.038349999999999995} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.34080159983394614, 'alpha': 2.4705533008089704, 'K': 20, 'beta': 8.933121147286453}
Fitted encoder
Epoch 0, Val Loss: 2.32557
Epoch 1, Val Loss: 2.32886
Epoch 2, Val Loss: 2.29707
Epoch 3, Val Loss: 2.29104
Epoch 4, Val Loss: 2.27362
Epoch 5, Val Loss: 2.31162
Epoch 6, Val Loss: 2.24713
Epoch 7, Val Loss: 2.25739
Epoch 8, Val Loss: 2.29404
Epoch 9, Val Loss: 2.23243
Epoch 10, Val Loss: 2.25191
Epoch 11, Val Loss: 2.22860
Epoch 12, Val Loss: 2.30938
Epoch 13, Val Loss: 2.24280
Epoch 14, Val Loss: 2.24666
Epoch 15, Val Loss: 2.23103
Epoch 16, Val Loss: 2.23587
Epoch 17, Val Loss: 2.24089
Epoch 18, Val Loss: 2.20098
Epoch 19, Val Loss: 2.22858
Epoch 20, Val Loss: 2.19586
Epoch 21, Val Loss: 2.22153
Epoch 22, Val Loss: 2.21569
Epoch 23, Val Loss: 2.26373
Epoch 24, Val Loss: 2.22109
Epoch 25, Val Loss: 2.22859
Epoch 26, Val Loss: 2.24525
Epoch 27, Val Loss: 2.24802
Epoch 28, Val Loss: 2.19343
Epoch 29, Val Loss: 2.21981
Epoch 30, Val Loss: 2.24184
Epoch 31, Val Loss: 2.21978
Epoch 32, Val Loss: 2.19735
Epoch 33, Val Loss: 2.25927
Epoch 34, Val Loss: 2.22838
Epoch 35, Val Loss: 2.18183
Epoch 36, Val Loss: 2.22947
Epoch 37, Val Loss: 2.18432
Epoch 38, Val Loss: 2.18983
Epoch 39, Val Loss: 2.21534
Epoch 40, Val Loss: 2.23148
Epoch 41, Val Loss: 2.33325
Epoch 42, Val Loss: 2.19154
Epoch 43, Val Loss: 2.17348
Epoch 44, Val Loss: 2.20403
Epoch 45, Val Loss: 2.19738
Epoch 46, Val Loss: 2.20541
Epoch 47, Val Loss: 2.21331
Epoch 48, Val Loss: 2.27646
Epoch 49, Val Loss: 2.20725
Epoch 50, Val Loss: 2.18350
Epoch 51, Val Loss: 2.24917
Epoch 52, Val Loss: 2.20907
Epoch 53, Val Loss: 2.30866
Epoch 54, Val Loss: 2.21067
Epoch 55, Val Loss: 2.20989
Epoch 56, Val Loss: 2.21963
Epoch 57, Val Loss: 2.24985
Epoch 58, Val Loss: 2.24038
Epoch 59, Val Loss: 2.20571
Epoch 60, Val Loss: 2.24819
Epoch 61, Val Loss: 2.21147
Epoch 62, Val Loss: 2.23604
Epoch 63, Val Loss: 2.21727
Epoch 64, Val Loss: 2.20210
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.0502666666666667, 'Log Loss - std': 0.1017861265377338} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.34080159983394614, 'alpha': 2.4705533008089704, 'K': 20, 'beta': 8.933121147286453}
Fitted encoder
Epoch 0, Val Loss: 2.28312
Epoch 1, Val Loss: 2.22098
Epoch 2, Val Loss: 2.18278
Epoch 3, Val Loss: 2.19712
Epoch 4, Val Loss: 2.20236
Epoch 5, Val Loss: 2.17608
Epoch 6, Val Loss: 2.18638
Epoch 7, Val Loss: 2.20043
Epoch 8, Val Loss: 2.21623
Epoch 9, Val Loss: 2.21151
Epoch 10, Val Loss: 2.17371
Epoch 11, Val Loss: 2.26894
Epoch 12, Val Loss: 2.17933
Epoch 13, Val Loss: 2.15397
Epoch 14, Val Loss: 2.32447
Epoch 15, Val Loss: 2.17611
Epoch 16, Val Loss: 2.17115
Epoch 17, Val Loss: 2.16069
Epoch 18, Val Loss: 2.17234
Epoch 19, Val Loss: 2.17891
Epoch 20, Val Loss: 2.22115
Epoch 21, Val Loss: 2.21800
Epoch 22, Val Loss: 2.19122
Epoch 23, Val Loss: 2.21821
Epoch 24, Val Loss: 2.16140
Epoch 25, Val Loss: 2.15678
Epoch 26, Val Loss: 2.17042
Epoch 27, Val Loss: 2.17123
Epoch 28, Val Loss: 2.20001
Epoch 29, Val Loss: 2.28142
Epoch 30, Val Loss: 2.25213
Epoch 31, Val Loss: 2.16208
Epoch 32, Val Loss: 2.18930
Epoch 33, Val Loss: 2.16434
Epoch 34, Val Loss: 2.18640
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.090875, 'Log Loss - std': 0.11277154727589754} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.34080159983394614, 'alpha': 2.4705533008089704, 'K': 20, 'beta': 8.933121147286453}
Fitted encoder
Epoch 0, Val Loss: 2.26564
Epoch 1, Val Loss: 2.19349
Epoch 2, Val Loss: 2.20751
Epoch 3, Val Loss: 2.17871
Epoch 4, Val Loss: 2.18795
Epoch 5, Val Loss: 2.21756
Epoch 6, Val Loss: 2.18354
Epoch 7, Val Loss: 2.18057
Epoch 8, Val Loss: 2.28091
Epoch 9, Val Loss: 2.22097
Epoch 10, Val Loss: 2.22902
Epoch 11, Val Loss: 2.17287
Epoch 12, Val Loss: 2.24993
Epoch 13, Val Loss: 2.21756
Epoch 14, Val Loss: 2.16962
Epoch 15, Val Loss: 2.20602
Epoch 16, Val Loss: 2.17424
Epoch 17, Val Loss: 2.16793
Epoch 18, Val Loss: 2.23915
Epoch 19, Val Loss: 2.16597
Epoch 20, Val Loss: 2.23806
Epoch 21, Val Loss: 2.19658
Epoch 22, Val Loss: 2.21370
Epoch 23, Val Loss: 2.18917
Epoch 24, Val Loss: 2.16335
Epoch 25, Val Loss: 2.17850
Epoch 26, Val Loss: 2.31236
Epoch 27, Val Loss: 2.17320
Epoch 28, Val Loss: 2.15107
Epoch 29, Val Loss: 2.18653
Epoch 30, Val Loss: 2.23334
Epoch 31, Val Loss: 2.14055
Epoch 32, Val Loss: 2.24010
Epoch 33, Val Loss: 2.16551
Epoch 34, Val Loss: 2.14786
Epoch 35, Val Loss: 2.13282
Epoch 36, Val Loss: 2.18385
Epoch 37, Val Loss: 2.16815
Epoch 38, Val Loss: 2.15765
Epoch 39, Val Loss: 2.19673
Epoch 40, Val Loss: 2.21308
Epoch 41, Val Loss: 2.15732
Epoch 42, Val Loss: 2.17301
Epoch 43, Val Loss: 2.39457
Epoch 44, Val Loss: 2.19838
Epoch 45, Val Loss: 2.19366
Epoch 46, Val Loss: 2.15326
Epoch 47, Val Loss: 2.12959
Epoch 48, Val Loss: 2.19444
Epoch 49, Val Loss: 2.16877
Epoch 50, Val Loss: 2.13973
Epoch 51, Val Loss: 2.19539
Epoch 52, Val Loss: 2.15735
Epoch 53, Val Loss: 2.14722
Epoch 54, Val Loss: 2.20952
Epoch 55, Val Loss: 2.14550
Epoch 56, Val Loss: 2.19658
Epoch 57, Val Loss: 2.20468
Epoch 58, Val Loss: 2.14273
Epoch 59, Val Loss: 2.16740
Epoch 60, Val Loss: 2.15453
Epoch 61, Val Loss: 2.15893
Epoch 62, Val Loss: 2.20401
Epoch 63, Val Loss: 2.17114
Epoch 64, Val Loss: 2.16764
Epoch 65, Val Loss: 2.16514
Epoch 66, Val Loss: 2.16892
Epoch 67, Val Loss: 2.22476
Epoch 68, Val Loss: 2.15078
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.18722, 'Log Loss - std': 0.21749338748568886} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 49 finished with value: 1.18722 and parameters: {'p_m': 0.34080159983394614, 'alpha': 2.4705533008089704, 'K': 20, 'beta': 8.933121147286453}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.44866015947475163, 'alpha': 0.535745957614292, 'K': 10, 'beta': 9.965952098744932}
Fitted encoder
Epoch 0, Val Loss: 2.33014
Epoch 1, Val Loss: 2.28334
Epoch 2, Val Loss: 2.31177
Epoch 3, Val Loss: 2.30766
Epoch 4, Val Loss: 2.31390
Epoch 5, Val Loss: 2.30145
Epoch 6, Val Loss: 2.31110
Epoch 7, Val Loss: 2.28517
Epoch 8, Val Loss: 2.25937
Epoch 9, Val Loss: 2.31907
Epoch 10, Val Loss: 2.30088
Epoch 11, Val Loss: 2.29054
Epoch 12, Val Loss: 2.27200
Epoch 13, Val Loss: 2.28713
Epoch 14, Val Loss: 2.26325
Epoch 15, Val Loss: 2.25900
Epoch 16, Val Loss: 2.33574
Epoch 17, Val Loss: 2.28072
Epoch 18, Val Loss: 2.28772
Epoch 19, Val Loss: 2.28687
Epoch 20, Val Loss: 2.28873
Epoch 21, Val Loss: 2.27150
Epoch 22, Val Loss: 2.24549
Epoch 23, Val Loss: 2.24629
Epoch 24, Val Loss: 2.28581
Epoch 25, Val Loss: 2.25174
Epoch 26, Val Loss: 2.22814
Epoch 27, Val Loss: 2.24247
Epoch 28, Val Loss: 2.22173
Epoch 29, Val Loss: 2.23957
Epoch 30, Val Loss: 2.22149
Epoch 31, Val Loss: 2.18274
Epoch 32, Val Loss: 2.18641
Epoch 33, Val Loss: 2.19738
Epoch 34, Val Loss: 2.17732
Epoch 35, Val Loss: 2.19574
Epoch 36, Val Loss: 2.26208
Epoch 37, Val Loss: 2.21470
Epoch 38, Val Loss: 2.25162
Epoch 39, Val Loss: 2.22352
Epoch 40, Val Loss: 2.20368
Epoch 41, Val Loss: 2.23277
Epoch 42, Val Loss: 2.22098
Epoch 43, Val Loss: 2.16711
Epoch 44, Val Loss: 2.18966
Epoch 45, Val Loss: 2.19873
Epoch 46, Val Loss: 2.27152
Epoch 47, Val Loss: 2.30076
Epoch 48, Val Loss: 2.23403
Epoch 49, Val Loss: 2.23466
Epoch 50, Val Loss: 2.22297
Epoch 51, Val Loss: 2.22648
Epoch 52, Val Loss: 2.23960
Epoch 53, Val Loss: 2.21457
Epoch 54, Val Loss: 2.16359
Epoch 55, Val Loss: 2.20284
Epoch 56, Val Loss: 2.18441
Epoch 57, Val Loss: 2.18070
Epoch 58, Val Loss: 2.20670
Epoch 59, Val Loss: 2.21336
Epoch 60, Val Loss: 2.28876
Epoch 61, Val Loss: 2.15383
Epoch 62, Val Loss: 2.18110
Epoch 63, Val Loss: 2.18567
Epoch 64, Val Loss: 2.20898
Epoch 65, Val Loss: 2.26046
Epoch 66, Val Loss: 2.19747
Epoch 67, Val Loss: 2.32484
Epoch 68, Val Loss: 2.20456
Epoch 69, Val Loss: 2.30237
Epoch 70, Val Loss: 2.18117
Epoch 71, Val Loss: 2.30657
Epoch 72, Val Loss: 2.29471
Epoch 73, Val Loss: 2.21390
Epoch 74, Val Loss: 2.20679
Epoch 75, Val Loss: 2.24984
Epoch 76, Val Loss: 2.25757
Epoch 77, Val Loss: 2.27955
Epoch 78, Val Loss: 2.26972
Epoch 79, Val Loss: 2.27450
Epoch 80, Val Loss: 2.26784
Epoch 81, Val Loss: 2.29038
Epoch 82, Val Loss: 2.29449
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.1625, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.44866015947475163, 'alpha': 0.535745957614292, 'K': 10, 'beta': 9.965952098744932}
Fitted encoder
Epoch 0, Val Loss: 2.26685
Epoch 1, Val Loss: 2.22112
Epoch 2, Val Loss: 2.28562
Epoch 3, Val Loss: 2.20211
Epoch 4, Val Loss: 2.22409
Epoch 5, Val Loss: 2.18368
Epoch 6, Val Loss: 2.26536
Epoch 7, Val Loss: 2.14878
Epoch 8, Val Loss: 2.16422
Epoch 9, Val Loss: 2.25981
Epoch 10, Val Loss: 2.21979
Epoch 11, Val Loss: 2.17386
Epoch 12, Val Loss: 2.16507
Epoch 13, Val Loss: 2.21806
Epoch 14, Val Loss: 2.18186
Epoch 15, Val Loss: 2.17144
Epoch 16, Val Loss: 2.18347
Epoch 17, Val Loss: 2.17009
Epoch 18, Val Loss: 2.17761
Epoch 19, Val Loss: 2.22758
Epoch 20, Val Loss: 2.17656
Epoch 21, Val Loss: 2.17984
Epoch 22, Val Loss: 2.20332
Epoch 23, Val Loss: 2.29397
Epoch 24, Val Loss: 2.16615
Epoch 25, Val Loss: 2.15219
Epoch 26, Val Loss: 2.14969
Epoch 27, Val Loss: 2.24636
Epoch 28, Val Loss: 2.15384
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.2737500000000002, 'Log Loss - std': 0.11124999999999996} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.44866015947475163, 'alpha': 0.535745957614292, 'K': 10, 'beta': 9.965952098744932}
Fitted encoder
Epoch 0, Val Loss: 2.27239
Epoch 1, Val Loss: 2.21632
Epoch 2, Val Loss: 2.24089
Epoch 3, Val Loss: 2.21907
Epoch 4, Val Loss: 2.30369
Epoch 5, Val Loss: 2.26019
Epoch 6, Val Loss: 2.21643
Epoch 7, Val Loss: 2.23919
Epoch 8, Val Loss: 2.26941
Epoch 9, Val Loss: 2.18599
Epoch 10, Val Loss: 2.19412
Epoch 11, Val Loss: 2.20960
Epoch 12, Val Loss: 2.20402
Epoch 13, Val Loss: 2.18706
Epoch 14, Val Loss: 2.22606
Epoch 15, Val Loss: 2.17189
Epoch 16, Val Loss: 2.17101
Epoch 17, Val Loss: 2.19224
Epoch 18, Val Loss: 2.18631
Epoch 19, Val Loss: 2.16498
Epoch 20, Val Loss: 2.21685
Epoch 21, Val Loss: 2.29710
Epoch 22, Val Loss: 2.18940
Epoch 23, Val Loss: 2.17518
Epoch 24, Val Loss: 2.18052
Epoch 25, Val Loss: 2.19173
Epoch 26, Val Loss: 2.17591
Epoch 27, Val Loss: 2.28040
Epoch 28, Val Loss: 2.20398
Epoch 29, Val Loss: 2.20259
Epoch 30, Val Loss: 2.21406
Epoch 31, Val Loss: 2.38478
Epoch 32, Val Loss: 2.17227
Epoch 33, Val Loss: 2.18066
Epoch 34, Val Loss: 2.20191
Epoch 35, Val Loss: 2.17672
Epoch 36, Val Loss: 2.22821
Epoch 37, Val Loss: 2.20687
Epoch 38, Val Loss: 2.19718
Epoch 39, Val Loss: 2.23153
Epoch 40, Val Loss: 2.19712
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.4141333333333332, 'Log Loss - std': 0.21832545023936678} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.44866015947475163, 'alpha': 0.535745957614292, 'K': 10, 'beta': 9.965952098744932}
Fitted encoder
Epoch 0, Val Loss: 2.36594
Epoch 1, Val Loss: 2.31091
Epoch 2, Val Loss: 2.29797
Epoch 3, Val Loss: 2.29149
Epoch 4, Val Loss: 2.30654
Epoch 5, Val Loss: 2.27981
Epoch 6, Val Loss: 2.28612
Epoch 7, Val Loss: 2.28842
Epoch 8, Val Loss: 2.28140
Epoch 9, Val Loss: 2.30526
Epoch 10, Val Loss: 2.27092
Epoch 11, Val Loss: 2.27765
Epoch 12, Val Loss: 2.27362
Epoch 13, Val Loss: 2.26379
Epoch 14, Val Loss: 2.27238
Epoch 15, Val Loss: 2.26083
Epoch 16, Val Loss: 2.24697
Epoch 17, Val Loss: 2.25521
Epoch 18, Val Loss: 2.30402
Epoch 19, Val Loss: 2.25749
Epoch 20, Val Loss: 2.25449
Epoch 21, Val Loss: 2.26442
Epoch 22, Val Loss: 2.26625
Epoch 23, Val Loss: 2.25200
Epoch 24, Val Loss: 2.27605
Epoch 25, Val Loss: 2.25466
Epoch 26, Val Loss: 2.24579
Epoch 27, Val Loss: 2.26498
Epoch 28, Val Loss: 2.27335
Epoch 29, Val Loss: 2.25258
Epoch 30, Val Loss: 2.29243
Epoch 31, Val Loss: 2.25853
Epoch 32, Val Loss: 2.26684
Epoch 33, Val Loss: 2.28419
Epoch 34, Val Loss: 2.32523
Epoch 35, Val Loss: 2.25904
Epoch 36, Val Loss: 2.28270
Epoch 37, Val Loss: 2.29656
Epoch 38, Val Loss: 2.28921
Epoch 39, Val Loss: 2.29707
Epoch 40, Val Loss: 2.24456
Epoch 41, Val Loss: 2.25045
Epoch 42, Val Loss: 2.28748
Epoch 43, Val Loss: 2.26762
Epoch 44, Val Loss: 2.25943
Epoch 45, Val Loss: 2.31526
Epoch 46, Val Loss: 2.37465
Epoch 47, Val Loss: 2.26942
Epoch 48, Val Loss: 2.26205
Epoch 49, Val Loss: 2.25928
Epoch 50, Val Loss: 2.27193
Epoch 51, Val Loss: 2.28672
Epoch 52, Val Loss: 2.26055
Epoch 53, Val Loss: 2.25922
Epoch 54, Val Loss: 2.26100
Epoch 55, Val Loss: 2.24980
Epoch 56, Val Loss: 2.23916
Epoch 57, Val Loss: 2.27510
Epoch 58, Val Loss: 2.26126
Epoch 59, Val Loss: 2.29494
Epoch 60, Val Loss: 2.27039
Epoch 61, Val Loss: 2.25396
Epoch 62, Val Loss: 2.28280
Epoch 63, Val Loss: 2.25936
Epoch 64, Val Loss: 2.24441
Epoch 65, Val Loss: 2.28990
Epoch 66, Val Loss: 2.27747
Epoch 67, Val Loss: 2.30024
Epoch 68, Val Loss: 2.28072
Epoch 69, Val Loss: 2.26152
Epoch 70, Val Loss: 2.27034
Epoch 71, Val Loss: 2.26575
Epoch 72, Val Loss: 2.24145
Epoch 73, Val Loss: 2.32664
Epoch 74, Val Loss: 2.27189
Epoch 75, Val Loss: 2.25344
Epoch 76, Val Loss: 2.28045
Epoch 77, Val Loss: 2.30113
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.421275, 'Log Loss - std': 0.18947958168362097} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.44866015947475163, 'alpha': 0.535745957614292, 'K': 10, 'beta': 9.965952098744932}
Fitted encoder
Epoch 0, Val Loss: 2.42871
Epoch 1, Val Loss: 2.39534
Epoch 2, Val Loss: 2.41734
Epoch 3, Val Loss: 2.37523
Epoch 4, Val Loss: 2.34288
Epoch 5, Val Loss: 2.31616
Epoch 6, Val Loss: 2.32009
Epoch 7, Val Loss: 2.25077
Epoch 8, Val Loss: 2.23899
Epoch 9, Val Loss: 2.22387
Epoch 10, Val Loss: 2.21074
Epoch 11, Val Loss: 2.22619
Epoch 12, Val Loss: 2.21268
Epoch 13, Val Loss: 2.19787
Epoch 14, Val Loss: 2.20390
Epoch 15, Val Loss: 2.21146
Epoch 16, Val Loss: 2.20451
Epoch 17, Val Loss: 2.19386
Epoch 18, Val Loss: 2.21301
Epoch 19, Val Loss: 2.20210
Epoch 20, Val Loss: 2.19820
Epoch 21, Val Loss: 2.19310
Epoch 22, Val Loss: 2.17368
Epoch 23, Val Loss: 2.19863
Epoch 24, Val Loss: 2.20522
Epoch 25, Val Loss: 2.18545
Epoch 26, Val Loss: 2.18756
Epoch 27, Val Loss: 2.18745
Epoch 28, Val Loss: 2.20608
Epoch 29, Val Loss: 2.19245
Epoch 30, Val Loss: 2.17044
Epoch 31, Val Loss: 2.19680
Epoch 32, Val Loss: 2.16673
Epoch 33, Val Loss: 2.24314
Epoch 34, Val Loss: 2.23039
Epoch 35, Val Loss: 2.24881
Epoch 36, Val Loss: 2.21973
Epoch 37, Val Loss: 2.22720
Epoch 38, Val Loss: 2.22215
Epoch 39, Val Loss: 2.23711
Epoch 40, Val Loss: 2.23359
Epoch 41, Val Loss: 2.22097
Epoch 42, Val Loss: 2.23700
Epoch 43, Val Loss: 2.22329
Epoch 44, Val Loss: 2.16450
Epoch 45, Val Loss: 2.15215
Epoch 46, Val Loss: 2.16166
Epoch 47, Val Loss: 2.17527
Epoch 48, Val Loss: 2.23335
Epoch 49, Val Loss: 2.19251
Epoch 50, Val Loss: 2.28925
Epoch 51, Val Loss: 2.19687
Epoch 52, Val Loss: 2.21050
Epoch 53, Val Loss: 2.19915
Epoch 54, Val Loss: 2.24678
Epoch 55, Val Loss: 2.22333
Epoch 56, Val Loss: 2.22107
Epoch 57, Val Loss: 2.18888
Epoch 58, Val Loss: 2.17138
Epoch 59, Val Loss: 2.26406
Epoch 60, Val Loss: 2.22223
Epoch 61, Val Loss: 2.16953
Epoch 62, Val Loss: 2.22506
Epoch 63, Val Loss: 2.15773
Epoch 64, Val Loss: 2.16585
Epoch 65, Val Loss: 2.17902
Epoch 66, Val Loss: 2.20774
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 1.32634, 'Log Loss - std': 0.25450466871945593} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 50 finished with value: 1.32634 and parameters: {'p_m': 0.44866015947475163, 'alpha': 0.535745957614292, 'K': 10, 'beta': 9.965952098744932}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5181772251535091, 'alpha': 1.1519642315153924, 'K': 10, 'beta': 0.3901111811507232}
Fitted encoder
Epoch 0, Val Loss: 2.59839
Epoch 1, Val Loss: 2.68396
Epoch 2, Val Loss: 2.68396
Epoch 3, Val Loss: 2.68396
Epoch 4, Val Loss: 2.68396
Epoch 5, Val Loss: 2.68396
Epoch 6, Val Loss: 2.68396
Epoch 7, Val Loss: 2.68396
Epoch 8, Val Loss: 2.68396
Epoch 9, Val Loss: 2.68396
Epoch 10, Val Loss: 2.68396
Epoch 11, Val Loss: 2.68396
Epoch 12, Val Loss: 2.68249
Epoch 13, Val Loss: 2.68249
Epoch 14, Val Loss: 2.68249
Epoch 15, Val Loss: 2.68249
Epoch 16, Val Loss: 2.68249
Epoch 17, Val Loss: 2.68249
Epoch 18, Val Loss: 2.68249
Epoch 19, Val Loss: 2.68249
Epoch 20, Val Loss: 2.68249
Epoch 21, Val Loss: 2.67302
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.5976, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5181772251535091, 'alpha': 1.1519642315153924, 'K': 10, 'beta': 0.3901111811507232}
Fitted encoder
Epoch 0, Val Loss: 2.65842
Epoch 1, Val Loss: 2.68267
Epoch 2, Val Loss: 2.68267
Epoch 3, Val Loss: 2.68267
Epoch 4, Val Loss: 2.68267
Epoch 5, Val Loss: 2.68267
Epoch 6, Val Loss: 2.68253
Epoch 7, Val Loss: 2.68727
Epoch 8, Val Loss: 2.68727
Epoch 9, Val Loss: 2.68727
Epoch 10, Val Loss: 2.68727
Epoch 11, Val Loss: 2.68727
Epoch 12, Val Loss: 2.68727
Epoch 13, Val Loss: 2.68727
Epoch 14, Val Loss: 2.68727
Epoch 15, Val Loss: 2.68727
Epoch 16, Val Loss: 2.68727
Epoch 17, Val Loss: 2.68727
Epoch 18, Val Loss: 2.68727
Epoch 19, Val Loss: 2.68727
Epoch 20, Val Loss: 2.68359
Epoch 21, Val Loss: 2.68359
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.9922, 'Log Loss - std': 0.3945999999999996} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5181772251535091, 'alpha': 1.1519642315153924, 'K': 10, 'beta': 0.3901111811507232}
Fitted encoder
Epoch 0, Val Loss: 2.54589
Epoch 1, Val Loss: 2.51203
Epoch 2, Val Loss: 2.55029
Epoch 3, Val Loss: 2.53111
Epoch 4, Val Loss: 2.68019
Epoch 5, Val Loss: 2.68001
Epoch 6, Val Loss: 2.68001
Epoch 7, Val Loss: 2.68001
Epoch 8, Val Loss: 2.68001
Epoch 9, Val Loss: 2.68001
Epoch 10, Val Loss: 2.68001
Epoch 11, Val Loss: 2.67707
Epoch 12, Val Loss: 2.67707
Epoch 13, Val Loss: 2.67707
Epoch 14, Val Loss: 2.67707
Epoch 15, Val Loss: 2.67707
Epoch 16, Val Loss: 2.68479
Epoch 17, Val Loss: 2.68479
Epoch 18, Val Loss: 2.68479
Epoch 19, Val Loss: 2.68479
Epoch 20, Val Loss: 2.68479
Epoch 21, Val Loss: 2.68479
Epoch 22, Val Loss: 2.68295
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.153933333333333, 'Log Loss - std': 1.2284901772320178} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5181772251535091, 'alpha': 1.1519642315153924, 'K': 10, 'beta': 0.3901111811507232}
Fitted encoder
Epoch 0, Val Loss: 2.67881
Epoch 1, Val Loss: 2.67881
Epoch 2, Val Loss: 2.67881
Epoch 3, Val Loss: 2.67881
Epoch 4, Val Loss: 2.67881
Epoch 5, Val Loss: 2.67881
Epoch 6, Val Loss: 2.67881
Epoch 7, Val Loss: 2.68276
Epoch 8, Val Loss: 2.68276
Epoch 9, Val Loss: 2.68276
Epoch 10, Val Loss: 2.68276
Epoch 11, Val Loss: 2.68276
Epoch 12, Val Loss: 2.68276
Epoch 13, Val Loss: 2.68276
Epoch 14, Val Loss: 2.68276
Epoch 15, Val Loss: 2.68276
Epoch 16, Val Loss: 2.68276
Epoch 17, Val Loss: 2.68276
Epoch 18, Val Loss: 2.67734
Epoch 19, Val Loss: 2.67734
Epoch 20, Val Loss: 2.67734
Epoch 21, Val Loss: 2.67734
Epoch 22, Val Loss: 2.67734
Epoch 23, Val Loss: 2.68571
Epoch 24, Val Loss: 2.68571
Epoch 25, Val Loss: 2.68571
Epoch 26, Val Loss: 2.68571
Epoch 27, Val Loss: 2.68497
Epoch 28, Val Loss: 2.68497
Epoch 29, Val Loss: 2.68497
Epoch 30, Val Loss: 2.68571
Epoch 31, Val Loss: 2.68571
Epoch 32, Val Loss: 2.68571
Epoch 33, Val Loss: 2.68571
Epoch 34, Val Loss: 2.68571
Epoch 35, Val Loss: 2.68571
Epoch 36, Val Loss: 2.68571
Epoch 37, Val Loss: 2.68571
Epoch 38, Val Loss: 2.68571
Epoch 39, Val Loss: 2.68571
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.518775, 'Log Loss - std': 1.237424507545814} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5181772251535091, 'alpha': 1.1519642315153924, 'K': 10, 'beta': 0.3901111811507232}
Fitted encoder
Epoch 0, Val Loss: 2.60678
Epoch 1, Val Loss: 2.67348
Epoch 2, Val Loss: 2.67348
Epoch 3, Val Loss: 2.67348
Epoch 4, Val Loss: 2.68534
Epoch 5, Val Loss: 2.68534
Epoch 6, Val Loss: 2.68534
Epoch 7, Val Loss: 2.68534
Epoch 8, Val Loss: 2.68534
Epoch 9, Val Loss: 2.68534
Epoch 10, Val Loss: 2.68534
Epoch 11, Val Loss: 2.68534
Epoch 12, Val Loss: 2.68534
Epoch 13, Val Loss: 2.68534
Epoch 14, Val Loss: 2.68534
Epoch 15, Val Loss: 2.68534
Epoch 16, Val Loss: 2.68534
Epoch 17, Val Loss: 2.68534
Epoch 18, Val Loss: 2.68534
Epoch 19, Val Loss: 2.68534
Epoch 20, Val Loss: 2.68534
Epoch 21, Val Loss: 2.68534
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.59146, 'Log Loss - std': 1.1162920614247867} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 51 finished with value: 9.59146 and parameters: {'p_m': 0.5181772251535091, 'alpha': 1.1519642315153924, 'K': 10, 'beta': 0.3901111811507232}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.16786960799285117, 'alpha': 1.1185919533698632, 'K': 10, 'beta': 0.5515807785956471}
Fitted encoder
Epoch 0, Val Loss: 2.68368
Epoch 1, Val Loss: 2.68368
Epoch 2, Val Loss: 2.68368
Epoch 3, Val Loss: 2.68368
Epoch 4, Val Loss: 2.61695
Epoch 5, Val Loss: 2.68534
Epoch 6, Val Loss: 2.68534
Epoch 7, Val Loss: 2.68534
Epoch 8, Val Loss: 2.68534
Epoch 9, Val Loss: 2.68534
Epoch 10, Val Loss: 2.68249
Epoch 11, Val Loss: 2.68249
Epoch 12, Val Loss: 2.68249
Epoch 13, Val Loss: 2.68249
Epoch 14, Val Loss: 2.68249
Epoch 15, Val Loss: 2.68249
Epoch 16, Val Loss: 2.68249
Epoch 17, Val Loss: 2.68249
Epoch 18, Val Loss: 2.68249
Epoch 19, Val Loss: 2.68249
Epoch 20, Val Loss: 2.68249
Epoch 21, Val Loss: 2.68249
Epoch 22, Val Loss: 2.68249
Epoch 23, Val Loss: 2.68396
Epoch 24, Val Loss: 2.68396
Epoch 25, Val Loss: 2.68396
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.6982, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.16786960799285117, 'alpha': 1.1185919533698632, 'K': 10, 'beta': 0.5515807785956471}
Fitted encoder
Epoch 0, Val Loss: 2.68543
Epoch 1, Val Loss: 2.68543
Epoch 2, Val Loss: 2.68543
Epoch 3, Val Loss: 2.68350
Epoch 4, Val Loss: 2.68350
Epoch 5, Val Loss: 2.68350
Epoch 6, Val Loss: 2.68350
Epoch 7, Val Loss: 2.68350
Epoch 8, Val Loss: 2.68350
Epoch 9, Val Loss: 2.68350
Epoch 10, Val Loss: 2.68350
Epoch 11, Val Loss: 2.68350
Epoch 12, Val Loss: 2.68350
Epoch 13, Val Loss: 2.68515
Epoch 14, Val Loss: 2.68515
Epoch 15, Val Loss: 2.68515
Epoch 16, Val Loss: 2.68515
Epoch 17, Val Loss: 2.68515
Epoch 18, Val Loss: 2.68515
Epoch 19, Val Loss: 2.68515
Epoch 20, Val Loss: 2.68727
Epoch 21, Val Loss: 2.68727
Epoch 22, Val Loss: 2.68727
Epoch 23, Val Loss: 2.68727
Epoch 24, Val Loss: 2.68727
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.1915, 'Log Loss - std': 2.4932999999999996} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.16786960799285117, 'alpha': 1.1185919533698632, 'K': 10, 'beta': 0.5515807785956471}
Fitted encoder
Epoch 0, Val Loss: 2.68874
Epoch 1, Val Loss: 2.68001
Epoch 2, Val Loss: 2.68001
Epoch 3, Val Loss: 2.68001
Epoch 4, Val Loss: 2.68001
Epoch 5, Val Loss: 2.68001
Epoch 6, Val Loss: 2.68718
Epoch 7, Val Loss: 2.68718
Epoch 8, Val Loss: 2.68718
Epoch 9, Val Loss: 2.68718
Epoch 10, Val Loss: 2.68718
Epoch 11, Val Loss: 2.68718
Epoch 12, Val Loss: 2.68718
Epoch 13, Val Loss: 2.68718
Epoch 14, Val Loss: 2.68718
Epoch 15, Val Loss: 2.68718
Epoch 16, Val Loss: 2.68718
Epoch 17, Val Loss: 2.68718
Epoch 18, Val Loss: 2.68718
Epoch 19, Val Loss: 2.68718
Epoch 20, Val Loss: 2.68460
Epoch 21, Val Loss: 2.68460
Epoch 22, Val Loss: 2.68460
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.009099999999998, 'Log Loss - std': 2.341218225625283} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.16786960799285117, 'alpha': 1.1185919533698632, 'K': 10, 'beta': 0.5515807785956471}
Fitted encoder
Epoch 0, Val Loss: 2.67881
Epoch 1, Val Loss: 2.68451
Epoch 2, Val Loss: 2.68451
Epoch 3, Val Loss: 2.68451
Epoch 4, Val Loss: 2.68451
Epoch 5, Val Loss: 2.68451
Epoch 6, Val Loss: 2.68451
Epoch 7, Val Loss: 2.68451
Epoch 8, Val Loss: 2.68451
Epoch 9, Val Loss: 2.68451
Epoch 10, Val Loss: 2.68451
Epoch 11, Val Loss: 2.68727
Epoch 12, Val Loss: 2.68727
Epoch 13, Val Loss: 2.68727
Epoch 14, Val Loss: 2.68727
Epoch 15, Val Loss: 2.68727
Epoch 16, Val Loss: 2.68727
Epoch 17, Val Loss: 2.68727
Epoch 18, Val Loss: 2.68727
Epoch 19, Val Loss: 2.68727
Epoch 20, Val Loss: 2.68727
Epoch 21, Val Loss: 2.68727
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 9.438925, 'Log Loss - std': 2.159913349390433} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.16786960799285117, 'alpha': 1.1185919533698632, 'K': 10, 'beta': 0.5515807785956471}
Fitted encoder
Epoch 0, Val Loss: 2.68745
Epoch 1, Val Loss: 2.68745
Epoch 2, Val Loss: 2.68745
Epoch 3, Val Loss: 2.68745
Epoch 4, Val Loss: 2.68745
Epoch 5, Val Loss: 2.68745
Epoch 6, Val Loss: 2.68745
Epoch 7, Val Loss: 2.68745
Epoch 8, Val Loss: 2.68194
Epoch 9, Val Loss: 2.68194
Epoch 10, Val Loss: 2.68194
Epoch 11, Val Loss: 2.68194
Epoch 12, Val Loss: 2.68194
Epoch 13, Val Loss: 2.68194
Epoch 14, Val Loss: 2.68194
Epoch 15, Val Loss: 2.68194
Epoch 16, Val Loss: 2.68194
Epoch 17, Val Loss: 2.68194
Epoch 18, Val Loss: 2.68194
Epoch 19, Val Loss: 2.68194
Epoch 20, Val Loss: 2.68194
Epoch 21, Val Loss: 2.67936
Epoch 22, Val Loss: 2.67936
Epoch 23, Val Loss: 2.67936
Epoch 24, Val Loss: 2.67936
Epoch 25, Val Loss: 2.56102
Epoch 26, Val Loss: 2.51613
Epoch 27, Val Loss: 2.44798
Epoch 28, Val Loss: 2.43289
Epoch 29, Val Loss: 2.43285
Epoch 30, Val Loss: 2.44173
Epoch 31, Val Loss: 2.43817
Epoch 32, Val Loss: 2.44218
Epoch 33, Val Loss: 2.44388
Epoch 34, Val Loss: 2.43015
Epoch 35, Val Loss: 2.42404
Epoch 36, Val Loss: 2.43048
Epoch 37, Val Loss: 2.43235
Epoch 38, Val Loss: 2.43882
Epoch 39, Val Loss: 2.43410
Epoch 40, Val Loss: 2.43899
Epoch 41, Val Loss: 2.44283
Epoch 42, Val Loss: 2.38529
Epoch 43, Val Loss: 2.39778
Epoch 44, Val Loss: 2.35914
Epoch 45, Val Loss: 2.40154
Epoch 46, Val Loss: 2.32709
Epoch 47, Val Loss: 2.33499
Epoch 48, Val Loss: 2.36699
Epoch 49, Val Loss: 2.36894
Epoch 50, Val Loss: 2.33921
Epoch 51, Val Loss: 2.36642
Epoch 52, Val Loss: 2.37260
Epoch 53, Val Loss: 2.34509
Epoch 54, Val Loss: 2.36800
Epoch 55, Val Loss: 2.33247
Epoch 56, Val Loss: 2.35994
Epoch 57, Val Loss: 2.34287
Epoch 58, Val Loss: 2.33569
Epoch 59, Val Loss: 2.34240
Epoch 60, Val Loss: 2.37035
Epoch 61, Val Loss: 2.43984
Epoch 62, Val Loss: 2.31363
Epoch 63, Val Loss: 2.36967
Epoch 64, Val Loss: 2.33664
Epoch 65, Val Loss: 2.36084
Epoch 66, Val Loss: 2.48164
Epoch 67, Val Loss: 2.39256
Epoch 68, Val Loss: 2.35172
Epoch 69, Val Loss: 2.26725
Epoch 70, Val Loss: 2.26349
Epoch 71, Val Loss: 2.33225
Epoch 72, Val Loss: 2.36271
Epoch 73, Val Loss: 2.28402
Epoch 74, Val Loss: 2.27151
Epoch 75, Val Loss: 2.34456
Epoch 76, Val Loss: 2.30075
Epoch 77, Val Loss: 2.39746
Epoch 78, Val Loss: 2.41690
Epoch 79, Val Loss: 2.30565
Epoch 80, Val Loss: 2.32139
Epoch 81, Val Loss: 2.27762
Epoch 82, Val Loss: 2.31384
Epoch 83, Val Loss: 2.28341
Epoch 84, Val Loss: 2.42248
Epoch 85, Val Loss: 2.27828
Epoch 86, Val Loss: 2.31758
Epoch 87, Val Loss: 2.28378
Epoch 88, Val Loss: 2.25460
Epoch 89, Val Loss: 2.26551
Epoch 90, Val Loss: 2.25698
Epoch 91, Val Loss: 2.25763
Epoch 92, Val Loss: 2.34106
Epoch 93, Val Loss: 2.36074
Epoch 94, Val Loss: 2.45546
Epoch 95, Val Loss: 2.36850
Epoch 96, Val Loss: 2.40799
Epoch 97, Val Loss: 2.44519
Epoch 98, Val Loss: 2.41928
Epoch 99, Val Loss: 2.41867
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.34918, 'Log Loss - std': 2.9124486607664} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 52 finished with value: 8.34918 and parameters: {'p_m': 0.16786960799285117, 'alpha': 1.1185919533698632, 'K': 10, 'beta': 0.5515807785956471}. Best is trial 34 with value: 10.662.
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5803398045583036, 'alpha': 1.478950102542934, 'K': 10, 'beta': 1.0061250079497206}
Fitted encoder
Epoch 0, Val Loss: 2.44257
Epoch 1, Val Loss: 2.60388
Epoch 2, Val Loss: 2.67284
Epoch 3, Val Loss: 2.67302
Epoch 4, Val Loss: 2.67302
Epoch 5, Val Loss: 2.67302
Epoch 6, Val Loss: 2.67302
Epoch 7, Val Loss: 2.67302
Epoch 8, Val Loss: 2.67330
Epoch 9, Val Loss: 2.67302
Epoch 10, Val Loss: 2.67302
Epoch 11, Val Loss: 2.67302
Epoch 12, Val Loss: 2.67302
Epoch 13, Val Loss: 2.68203
Epoch 14, Val Loss: 2.68203
Epoch 15, Val Loss: 2.68203
Epoch 16, Val Loss: 2.68203
Epoch 17, Val Loss: 2.68203
Epoch 18, Val Loss: 2.68203
Epoch 19, Val Loss: 2.68203
Epoch 20, Val Loss: 2.68203
Epoch 21, Val Loss: 2.68203
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 5.3129, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5803398045583036, 'alpha': 1.478950102542934, 'K': 10, 'beta': 1.0061250079497206}
Fitted encoder
Epoch 0, Val Loss: 2.35280
Epoch 1, Val Loss: 2.37710
Epoch 2, Val Loss: 2.34853
Epoch 3, Val Loss: 2.38329
Epoch 4, Val Loss: 2.40030
Epoch 5, Val Loss: 2.36658
Epoch 6, Val Loss: 2.38784
Epoch 7, Val Loss: 2.35906
Epoch 8, Val Loss: 2.31201
Epoch 9, Val Loss: 2.39389
Epoch 10, Val Loss: 2.32586
Epoch 11, Val Loss: 2.34586
Epoch 12, Val Loss: 2.32800
Epoch 13, Val Loss: 2.34034
Epoch 14, Val Loss: 2.37934
Epoch 15, Val Loss: 2.32249
Epoch 16, Val Loss: 2.32555
Epoch 17, Val Loss: 2.30912
Epoch 18, Val Loss: 2.44784
Epoch 19, Val Loss: 2.28695
Epoch 20, Val Loss: 2.30885
Epoch 21, Val Loss: 2.32419
Epoch 22, Val Loss: 2.32535
Epoch 23, Val Loss: 2.33719
Epoch 24, Val Loss: 2.26832
Epoch 25, Val Loss: 2.27218
Epoch 26, Val Loss: 2.35897
Epoch 27, Val Loss: 2.33344
Epoch 28, Val Loss: 2.33830
Epoch 29, Val Loss: 2.34533
Epoch 30, Val Loss: 2.32397
Epoch 31, Val Loss: 2.29881
Epoch 32, Val Loss: 2.32830
Epoch 33, Val Loss: 2.31256
Epoch 34, Val Loss: 2.29104
Epoch 35, Val Loss: 2.26660
Epoch 36, Val Loss: 2.32987
Epoch 37, Val Loss: 2.29370
Epoch 38, Val Loss: 2.26978
Epoch 39, Val Loss: 2.31701
Epoch 40, Val Loss: 2.29919
Epoch 41, Val Loss: 2.26703
Epoch 42, Val Loss: 2.27325
Epoch 43, Val Loss: 2.31052
Epoch 44, Val Loss: 2.39800
Epoch 45, Val Loss: 2.23533
Epoch 46, Val Loss: 2.27614
Epoch 47, Val Loss: 2.25912
Epoch 48, Val Loss: 2.28882
Epoch 49, Val Loss: 2.24868
Epoch 50, Val Loss: 2.21548
Epoch 51, Val Loss: 2.23702
Epoch 52, Val Loss: 2.25304
Epoch 53, Val Loss: 2.30514
Epoch 54, Val Loss: 2.24309
Epoch 55, Val Loss: 2.27523
Epoch 56, Val Loss: 2.30732
Epoch 57, Val Loss: 2.22256
Epoch 58, Val Loss: 2.24236
Epoch 59, Val Loss: 2.28014
Epoch 60, Val Loss: 2.22416
Epoch 61, Val Loss: 2.24623
Epoch 62, Val Loss: 2.21070
Epoch 63, Val Loss: 2.25411
Epoch 64, Val Loss: 2.21620
Epoch 65, Val Loss: 2.29094
Epoch 66, Val Loss: 2.28396
Epoch 67, Val Loss: 2.26832
Epoch 68, Val Loss: 2.26149
Epoch 69, Val Loss: 2.22491
Epoch 70, Val Loss: 2.21888
Epoch 71, Val Loss: 2.23390
Epoch 72, Val Loss: 2.27668
Epoch 73, Val Loss: 2.22652
Epoch 74, Val Loss: 2.23262
Epoch 75, Val Loss: 2.23985
Epoch 76, Val Loss: 2.24669
Epoch 77, Val Loss: 2.21851
Epoch 78, Val Loss: 2.22965
Epoch 79, Val Loss: 2.22700
Epoch 80, Val Loss: 2.24122
Epoch 81, Val Loss: 2.25633
Epoch 82, Val Loss: 2.28241
Epoch 83, Val Loss: 2.21981
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.28265, 'Log Loss - std': 1.0302499999999999} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5803398045583036, 'alpha': 1.478950102542934, 'K': 10, 'beta': 1.0061250079497206}
Fitted encoder
Epoch 0, Val Loss: 2.45885
Epoch 1, Val Loss: 2.49733
Epoch 2, Val Loss: 2.36749
Epoch 3, Val Loss: 2.63921
Epoch 4, Val Loss: 2.63874
Epoch 5, Val Loss: 2.63886
Epoch 6, Val Loss: 2.63889
Epoch 7, Val Loss: 2.63891
Epoch 8, Val Loss: 2.63888
Epoch 9, Val Loss: 2.63892
Epoch 10, Val Loss: 2.63893
Epoch 11, Val Loss: 2.63907
Epoch 12, Val Loss: 2.63904
Epoch 13, Val Loss: 2.63904
Epoch 14, Val Loss: 2.68295
Epoch 15, Val Loss: 2.68295
Epoch 16, Val Loss: 2.68295
Epoch 17, Val Loss: 2.68295
Epoch 18, Val Loss: 2.68295
Epoch 19, Val Loss: 2.68295
Epoch 20, Val Loss: 2.68295
Epoch 21, Val Loss: 2.68717
Epoch 22, Val Loss: 2.68368
Epoch 23, Val Loss: 2.68368
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 4.569733333333334, 'Log Loss - std': 0.9340469593238994} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5803398045583036, 'alpha': 1.478950102542934, 'K': 10, 'beta': 1.0061250079497206}
Fitted encoder
Epoch 0, Val Loss: 2.66780
Epoch 1, Val Loss: 2.53731
Epoch 2, Val Loss: 2.68558
Epoch 3, Val Loss: 2.43166
Epoch 4, Val Loss: 2.41939
Epoch 5, Val Loss: 2.33372
Epoch 6, Val Loss: 2.41775
Epoch 7, Val Loss: 2.31969
Epoch 8, Val Loss: 2.37672
Epoch 9, Val Loss: 2.36902
Epoch 10, Val Loss: 2.34685
Epoch 11, Val Loss: 2.33448
Epoch 12, Val Loss: 2.35028
Epoch 13, Val Loss: 2.32142
Epoch 14, Val Loss: 2.36699
Epoch 15, Val Loss: 2.42822
Epoch 16, Val Loss: 2.30876
Epoch 17, Val Loss: 2.33322
Epoch 18, Val Loss: 2.52076
Epoch 19, Val Loss: 2.39394
Epoch 20, Val Loss: 2.40981
Epoch 21, Val Loss: 2.44847
Epoch 22, Val Loss: 2.42431
Epoch 23, Val Loss: 2.43993
Epoch 24, Val Loss: 2.39643
Epoch 25, Val Loss: 2.27585
Epoch 26, Val Loss: 2.33834
Epoch 27, Val Loss: 2.33032
Epoch 28, Val Loss: 2.61286
Epoch 29, Val Loss: 2.35510
Epoch 30, Val Loss: 2.32079
Epoch 31, Val Loss: 2.64310
Epoch 32, Val Loss: 2.27490
Epoch 33, Val Loss: 2.36611
Epoch 34, Val Loss: 2.30761
Epoch 35, Val Loss: 2.27293
Epoch 36, Val Loss: 2.35937
Epoch 37, Val Loss: 2.29888
Epoch 38, Val Loss: 2.38777
Epoch 39, Val Loss: 2.37871
Epoch 40, Val Loss: 2.36269
Epoch 41, Val Loss: 2.40528
Epoch 42, Val Loss: 2.35435
Epoch 43, Val Loss: 2.42498
Epoch 44, Val Loss: 2.42947
Epoch 45, Val Loss: 2.44521
Epoch 46, Val Loss: 2.54187
Epoch 47, Val Loss: 2.40428
Epoch 48, Val Loss: 2.45821
Epoch 49, Val Loss: 2.34609
Epoch 50, Val Loss: 2.36608
Epoch 51, Val Loss: 2.36231
Epoch 52, Val Loss: 2.34408
Epoch 53, Val Loss: 2.42702
Epoch 54, Val Loss: 2.37994
Epoch 55, Val Loss: 2.35703
Epoch 56, Val Loss: 2.26692
Epoch 57, Val Loss: 2.26888
Epoch 58, Val Loss: 2.28993
Epoch 59, Val Loss: 2.23470
Epoch 60, Val Loss: 2.24902
Epoch 61, Val Loss: 2.25797
Epoch 62, Val Loss: 2.24375
Epoch 63, Val Loss: 2.34959
Epoch 64, Val Loss: 2.25428
Epoch 65, Val Loss: 2.27905
Epoch 66, Val Loss: 2.36912
Epoch 67, Val Loss: 2.20161
Epoch 68, Val Loss: 2.25213
Epoch 69, Val Loss: 2.17845
Epoch 70, Val Loss: 2.24716
Epoch 71, Val Loss: 2.24401
Epoch 72, Val Loss: 2.18940
Epoch 73, Val Loss: 2.21941
Epoch 74, Val Loss: 2.24070
Epoch 75, Val Loss: 2.20010
Epoch 76, Val Loss: 2.20377
Epoch 77, Val Loss: 2.18580
Epoch 78, Val Loss: 2.26516
Epoch 79, Val Loss: 2.25024
Epoch 80, Val Loss: 2.27655
Epoch 81, Val Loss: 2.29543
Epoch 82, Val Loss: 2.31847
Epoch 83, Val Loss: 2.23376
Epoch 84, Val Loss: 2.23978
Epoch 85, Val Loss: 2.23664
Epoch 86, Val Loss: 2.26578
Epoch 87, Val Loss: 2.29887
Epoch 88, Val Loss: 2.26643
Epoch 89, Val Loss: 2.24969
Epoch 90, Val Loss: 2.20953
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.988875, 'Log Loss - std': 1.290938419087061} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.5803398045583036, 'alpha': 1.478950102542934, 'K': 10, 'beta': 1.0061250079497206}
Fitted encoder
Epoch 0, Val Loss: 2.37226
Epoch 1, Val Loss: 2.39333
Epoch 2, Val Loss: 2.30247
Epoch 3, Val Loss: 2.40873
Epoch 4, Val Loss: 2.42888
Epoch 5, Val Loss: 2.37949
Epoch 6, Val Loss: 2.39761
Epoch 7, Val Loss: 2.34516
Epoch 8, Val Loss: 2.34233
Epoch 9, Val Loss: 2.37344
Epoch 10, Val Loss: 2.35538
Epoch 11, Val Loss: 2.36119
Epoch 12, Val Loss: 2.50335
Epoch 13, Val Loss: 2.32793
Epoch 14, Val Loss: 2.36220
Epoch 15, Val Loss: 2.35162
Epoch 16, Val Loss: 2.36699
Epoch 17, Val Loss: 2.35197
Epoch 18, Val Loss: 2.39605
Epoch 19, Val Loss: 2.49650
Epoch 20, Val Loss: 2.41515
Epoch 21, Val Loss: 2.33087
Epoch 22, Val Loss: 2.29156
Epoch 23, Val Loss: 2.34737
Epoch 24, Val Loss: 2.35606
Epoch 25, Val Loss: 2.50023
Epoch 26, Val Loss: 2.32009
Epoch 27, Val Loss: 2.31676
Epoch 28, Val Loss: 2.32686
Epoch 29, Val Loss: 2.35420
Epoch 30, Val Loss: 2.33839
Epoch 31, Val Loss: 2.32387
Epoch 32, Val Loss: 2.34902
Epoch 33, Val Loss: 2.33029
Epoch 34, Val Loss: 2.34759
Epoch 35, Val Loss: 2.40079
Epoch 36, Val Loss: 2.36375
Epoch 37, Val Loss: 2.31798
Epoch 38, Val Loss: 2.24645
Epoch 39, Val Loss: 2.24700
Epoch 40, Val Loss: 2.21711
Epoch 41, Val Loss: 2.21820
Epoch 42, Val Loss: 2.21247
Epoch 43, Val Loss: 2.24792
Epoch 44, Val Loss: 2.22334
Epoch 45, Val Loss: 2.19780
Epoch 46, Val Loss: 2.21272
Epoch 47, Val Loss: 2.21283
Epoch 48, Val Loss: 2.34408
Epoch 49, Val Loss: 2.29734
Epoch 50, Val Loss: 2.22333
Epoch 51, Val Loss: 2.24156
Epoch 52, Val Loss: 2.25442
Epoch 53, Val Loss: 2.20156
Epoch 54, Val Loss: 2.22994
Epoch 55, Val Loss: 2.25487
Epoch 56, Val Loss: 2.21326
Epoch 57, Val Loss: 2.22557
Epoch 58, Val Loss: 2.21275
Epoch 59, Val Loss: 2.25031
Epoch 60, Val Loss: 2.24382
Epoch 61, Val Loss: 2.31897
Epoch 62, Val Loss: 2.20078
Epoch 63, Val Loss: 2.23161
Epoch 64, Val Loss: 2.21490
Epoch 65, Val Loss: 2.21305
Epoch 66, Val Loss: 2.19719
Epoch 67, Val Loss: 2.26464
Epoch 68, Val Loss: 2.20001
Epoch 69, Val Loss: 2.20234
Epoch 70, Val Loss: 2.25594
Epoch 71, Val Loss: 2.21997
Epoch 72, Val Loss: 2.19687
Epoch 73, Val Loss: 2.22120
Epoch 74, Val Loss: 2.27168
Epoch 75, Val Loss: 2.26467
Epoch 76, Val Loss: 2.23439
Epoch 77, Val Loss: 2.19094
Epoch 78, Val Loss: 2.22428
Epoch 79, Val Loss: 2.29985
Epoch 80, Val Loss: 2.21282
Epoch 81, Val Loss: 2.25303
Epoch 82, Val Loss: 2.21235
Epoch 83, Val Loss: 2.22378
Epoch 84, Val Loss: 2.22426
Epoch 85, Val Loss: 2.22375
Epoch 86, Val Loss: 2.22674
Epoch 87, Val Loss: 2.21756
Epoch 88, Val Loss: 2.44051
Epoch 89, Val Loss: 2.24730
Epoch 90, Val Loss: 2.27995
Epoch 91, Val Loss: 2.28254
Epoch 92, Val Loss: 2.21595
Epoch 93, Val Loss: 2.19420
Epoch 94, Val Loss: 2.23126
Epoch 95, Val Loss: 2.22379
Epoch 96, Val Loss: 2.19819
Epoch 97, Val Loss: 2.21770
Epoch 98, Val Loss: 2.27133
Early stopping applies.
State of save is False b4 loss saving
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 3.74246, 'Log Loss - std': 1.2554278196694542} 
 

Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 53 finished with value: 3.74246 and parameters: {'p_m': 0.5803398045583036, 'alpha': 1.478950102542934, 'K': 10, 'beta': 1.0061250079497206}. Best is trial 34 with value: 10.662.
Best parameters After Trials: {'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Parameters saved to YAML file!!!
In get_device
On Device: cuda
Fold 1
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 'Ideal' 'E' 'SI2' -0.17767576091934348]
 [-1.236976378485391 'Premium' 'E' 'SI1' -1.3637394355688461]
 [-1.069224675734413 'Premium' 'I' 'VS2' 0.45024030213039123]
 [-1.1740694899537742 'Very Good' 'J' 'VVS2' 0.7293141079302727]
 [-1.1740694899537742 'Very Good' 'I' 'VVS1' 0.3804718506804196]
 [-1.1321315642660297 'Very Good' 'H' 'SI1' 0.10139804488053805]
 [-1.2160074156415188 'Fair' 'E' 'VS2' 2.3339884912795954]
 [-1.1950384527976465 'Very Good' 'H' 'VS1' -1.6428132413687278]
 [-1.0482557128905408 'Good' 'J' 'SI1' 1.5665355253299222]
 [-1.1950384527976465 'Ideal' 'J' 'VS1' 0.7293141079302727]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1950384527976465 5 6 2 -0.17767576091934348 -1.0997679290240274
  -1.5847483029459433 -1.5624470539339794 -1.5635817068251905]
 [-1.236976378485391 4 6 3 -1.3637394355688461 1.5843835902987453
  -1.6380368496537203 -1.6869504169773575 -1.7324417222907198]
 [-1.069224675734413 4 2 4 0.45024030213039123 0.24230783063735892
  -1.3627126916635395 -1.3401196199279468 -1.2821483477159754]
 [-1.1740694899537742 3 1 6 0.7293141079302727 -0.20505075591643654
  -1.5936297273972397 -1.580233248654462 -1.493223367047887]
 [-1.1740694899537742 3 2 7 0.3804718506804196 -0.20505075591643654
  -1.5847483029459433 -1.5624470539339794 -1.5072950350033474]
 [-1.1321315642660297 3 3 3 0.10139804488053805 -1.0997679290240274
  -1.4781712095303894 -1.4468367882508424 -1.4228650272705832]
 [-1.2160074156415188 1 6 4 2.3339884912795954 1.5843835902987453
  -1.6557996985563126 -1.7403090011388052 -1.4791516990924258]
 [-1.1950384527976465 3 3 5 -1.6428132413687278 1.5843835902987453
  -1.5403411806894627 -1.5001953724122905 -1.6198683786470336]
 [-1.0482557128905408 2 1 3 1.5665355253299222 -1.0997679290240274
  -1.318305569407059 -1.2956541331267404 -1.1414316681613677]
 [-1.1950384527976465 5 1 5 0.7293141079302727 -0.652409342470232
  -1.6025111518485355 -1.6335918328159098 -1.5213667029588085]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.54558
Epoch 1, Val Loss: 2.68442
Epoch 2, Val Loss: 2.68442
Epoch 3, Val Loss: 2.68442
Epoch 4, Val Loss: 2.68442
Epoch 5, Val Loss: 2.68442
Epoch 6, Val Loss: 2.68442
Epoch 7, Val Loss: 2.68442
Epoch 8, Val Loss: 2.68442
Epoch 9, Val Loss: 2.68442
Epoch 10, Val Loss: 2.68368
Epoch 11, Val Loss: 2.68368
Epoch 12, Val Loss: 2.68368
Epoch 13, Val Loss: 2.68368
Epoch 14, Val Loss: 2.68368
Epoch 15, Val Loss: 2.68368
Epoch 16, Val Loss: 2.68368
Epoch 17, Val Loss: 2.68368
Epoch 18, Val Loss: 2.68368
Epoch 19, Val Loss: 2.68368
Epoch 20, Val Loss: 2.68368
Epoch 21, Val Loss: 2.68368
Early stopping applies.
State of save is True b4 loss saving
Log file exists at: output/VIME/Diamonds/logging/loss_0.txt
File name : output/VIME/Diamonds/logging/loss_0.txt . The file was saved
Log file exists at: output/VIME/Diamonds/logging/val_loss_0.txt
File name : output/VIME/Diamonds/logging/val_loss_0.txt . The file was saved
Saved Losses and Regularization
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.6121, 'Log Loss - std': 0.0} 
 

Fold 2
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 'Premium' 'E' 'SI1' -1.3617245236890496]
 [-1.1991826034964022 'Good' 'E' 'VS1' -3.3871902928108906]
 [-1.0725306248271413 'Premium' 'I' 'VS2' 0.4542103037994991]
 [-1.0303132986040544 'Good' 'J' 'SI2' 1.08280312869938]
 [-1.1780739403848586 'Very Good' 'J' 'VVS2' 0.73358489264389]
 [-1.1780739403848586 'Very Good' 'I' 'VVS1' 0.38436665658840014]
 [-1.1358566141617716 'Very Good' 'H' 'SI1' 0.10499206774400914]
 [-1.2202912666079455 'Fair' 'E' 'VS2' 2.339988778499142]
 [-1.1991826034964022 'Very Good' 'H' 'VS1' -1.6410991125334407]
 [-1.051421961715598 'Good' 'J' 'SI1' 1.571708659177068]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.241399929719489 4 6 3 -1.3617245236890496 1.5949518123380095
  -1.6437879201752599 -1.6514473425787888 -1.7685832176092422]
 [-1.1991826034964022 2 6 5 -3.3871902928108906 3.3941876961159525
  -1.5010019420077028 -1.4510608771835314 -1.7685832176092422]
 [-1.0725306248271413 4 2 4 0.4542103037994991 0.24552489950455236
  -1.3671400874756174 -1.3116615969085696 -1.307955447116008]
 [-1.0303132986040544 2 1 2 1.08280312869938 0.24552489950455236
  -1.242202356579005 -1.2071121367023494 -1.135220033181045]
 [-1.1780739403848586 3 1 6 0.73358489264389 -0.20428407143993338
  -1.5991673019978982 -1.5468978823725676 -1.5238747145347116]
 [-1.1780739403848586 3 2 7 0.38436665658840014 -0.20428407143993338
  -1.5902431783624258 -1.5294729723381975 -1.5382693323626249]
 [-1.1358566141617716 3 3 3 0.10499206774400914 -1.1039020133289048
  -1.4831536947367576 -1.416211057114791 -1.4519016253951438]
 [-1.2202912666079455 1 6 4 2.339988778499142 1.5949518123380095
  -1.6616361674462046 -1.7037220726818993 -1.5094800967067976]
 [-1.1991826034964022 3 3 5 -1.6410991125334407 1.5949518123380095
  -1.5456225601850642 -1.4684857872179018 -1.6534262749859334]
 [-1.051421961715598 2 1 3 1.571708659177068 -1.1039020133289048
  -1.3225194692982558 -1.2680993218226444 -1.164009268836872]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.68543
Epoch 1, Val Loss: 2.68543
Epoch 2, Val Loss: 2.68543
Epoch 3, Val Loss: 2.68543
Epoch 4, Val Loss: 2.68543
Epoch 5, Val Loss: 2.68543
Epoch 6, Val Loss: 2.68543
Epoch 7, Val Loss: 2.68543
Epoch 8, Val Loss: 2.68543
Epoch 9, Val Loss: 2.68543
Epoch 10, Val Loss: 2.68543
Epoch 11, Val Loss: 2.68350
Epoch 12, Val Loss: 2.68350
Epoch 13, Val Loss: 2.68350
Epoch 14, Val Loss: 2.68350
Epoch 15, Val Loss: 2.68350
Epoch 16, Val Loss: 2.68350
Epoch 17, Val Loss: 2.68727
Epoch 18, Val Loss: 2.68727
Epoch 19, Val Loss: 2.68727
Epoch 20, Val Loss: 2.68727
Epoch 21, Val Loss: 2.68727
Epoch 22, Val Loss: 2.68727
Epoch 23, Val Loss: 2.33901
Epoch 24, Val Loss: 2.30652
Epoch 25, Val Loss: 2.31316
Epoch 26, Val Loss: 2.30029
Epoch 27, Val Loss: 2.32392
Epoch 28, Val Loss: 2.34009
Epoch 29, Val Loss: 2.28421
Epoch 30, Val Loss: 2.30049
Epoch 31, Val Loss: 2.45725
Epoch 32, Val Loss: 2.34186
Epoch 33, Val Loss: 2.33283
Epoch 34, Val Loss: 2.34129
Epoch 35, Val Loss: 2.36569
Epoch 36, Val Loss: 2.27006
Epoch 37, Val Loss: 2.33252
Epoch 38, Val Loss: 2.30839
Epoch 39, Val Loss: 2.27650
Epoch 40, Val Loss: 2.34562
Epoch 41, Val Loss: 2.27408
Epoch 42, Val Loss: 2.33559
Epoch 43, Val Loss: 2.33156
Epoch 44, Val Loss: 2.27645
Epoch 45, Val Loss: 2.33766
Epoch 46, Val Loss: 2.29139
Epoch 47, Val Loss: 2.24411
Epoch 48, Val Loss: 2.28664
Epoch 49, Val Loss: 2.34182
Epoch 50, Val Loss: 2.26328
Epoch 51, Val Loss: 2.26584
Epoch 52, Val Loss: 2.26500
Epoch 53, Val Loss: 2.31311
Epoch 54, Val Loss: 2.25490
Epoch 55, Val Loss: 2.27665
Epoch 56, Val Loss: 2.27851
Epoch 57, Val Loss: 2.29468
Epoch 58, Val Loss: 2.35112
Epoch 59, Val Loss: 2.31747
Epoch 60, Val Loss: 2.25384
Epoch 61, Val Loss: 2.25430
Epoch 62, Val Loss: 2.25943
Epoch 63, Val Loss: 2.28344
Epoch 64, Val Loss: 2.27141
Epoch 65, Val Loss: 2.24887
Epoch 66, Val Loss: 2.29661
Epoch 67, Val Loss: 2.33802
Epoch 68, Val Loss: 2.25327
Early stopping applies.
State of save is True b4 loss saving
Log file exists at: output/VIME/Diamonds/logging/loss_1.txt
File name : output/VIME/Diamonds/logging/loss_1.txt . The file was saved
Log file exists at: output/VIME/Diamonds/logging/val_loss_1.txt
File name : output/VIME/Diamonds/logging/val_loss_1.txt . The file was saved
Saved Losses and Regularization
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 6.31175, 'Log Loss - std': 2.30035} 
 

Fold 3
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 'Ideal' 'E' 'SI2' -0.17299106375200937]
 [-1.2431374791872112 'Premium' 'E' 'SI1' -1.358384470113667]
 [-1.2007760315615899 'Good' 'E' 'VS1' -3.380526163318843]
 [-1.0736916886847254 'Premium' 'I' 'VS2' 0.45457015138063084]
 [-1.031330241059104 'Good' 'J' 'SI2' 1.082131366513271]
 [-1.179595307748779 'Very Good' 'J' 'VVS2' 0.733486246995137]
 [-1.179595307748779 'Very Good' 'I' 'VVS1' 0.38484112747700305]
 [-1.2219567553744004 'Fair' 'E' 'VS2' 2.3372537967785516]
 [-1.2007760315615899 'Very Good' 'H' 'VS1' -1.6373005657281732]
 [-1.0525109648719149 'Good' 'J' 'SI1' 1.5702345338386605]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007760315615899 5 6 2 -0.17299106375200937 -1.0991811176282293
  -1.5887751661204468 -1.52741996295235 -1.5654913782973074]
 [-1.2431374791872112 4 6 3 -1.358384470113667 1.580885495554982
  -1.642349354189251 -1.6494018572095064 -1.7351080246385664]
 [-1.2007760315615899 2 6 5 -3.380526163318843 3.367596571010456
  -1.4994848526724398 -1.449003030929892 -1.7351080246385664]
 [-1.0736916886847254 4 2 4 0.45457015138063084 0.2408521889633763
  -1.3655493825004286 -1.309595151778856 -1.282796967728543]
 [-1.031330241059104 2 1 2 1.082131366513271 0.2408521889633763
  -1.2405429436732185 -1.2050392424155796 -1.113180321387284]
 [-1.179595307748779 3 1 6 0.733486246995137 -0.20582557990049227
  -1.5977041974652477 -1.5448459478462293 -1.4948177756551164]
 [-1.179595307748779 3 2 7 0.38484112747700305 -0.20582557990049227
  -1.5887751661204468 -1.52741996295235 -1.5089524961835543]
 [-1.2219567553744004 1 6 4 2.3372537967785516 1.580885495554982
  -1.6602074168788525 -1.701679811891145 -1.4806830551266779]
 [-1.2007760315615899 3 3 5 -1.6373005657281732 1.580885495554982
  -1.5441300093964432 -1.4664290158237718 -1.6220302604110604]
 [-1.0525109648719149 2 1 3 1.5702345338386605 -1.0991811176282293
  -1.320904225776425 -1.2660301895441572 -1.1414497624441604]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.67707
Epoch 1, Val Loss: 2.67707
Epoch 2, Val Loss: 2.67707
Epoch 3, Val Loss: 2.67707
Epoch 4, Val Loss: 2.67707
Epoch 5, Val Loss: 2.67707
Epoch 6, Val Loss: 2.67707
Epoch 7, Val Loss: 2.67707
Epoch 8, Val Loss: 2.68396
Epoch 9, Val Loss: 2.68396
Epoch 10, Val Loss: 2.68396
Epoch 11, Val Loss: 2.68396
Epoch 12, Val Loss: 2.68396
Epoch 13, Val Loss: 2.68396
Epoch 14, Val Loss: 2.68396
Epoch 15, Val Loss: 2.68396
Epoch 16, Val Loss: 2.68396
Epoch 17, Val Loss: 2.68396
Epoch 18, Val Loss: 2.68396
Epoch 19, Val Loss: 2.68396
Epoch 20, Val Loss: 2.68396
Epoch 21, Val Loss: 2.68396
Early stopping applies.
State of save is True b4 loss saving
Log file exists at: output/VIME/Diamonds/logging/loss_2.txt
File name : output/VIME/Diamonds/logging/loss_2.txt . The file was saved
Log file exists at: output/VIME/Diamonds/logging/val_loss_2.txt
File name : output/VIME/Diamonds/logging/val_loss_2.txt . The file was saved
Saved Losses and Regularization
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 7.777266666666667, 'Log Loss - std': 2.7970016593170306} 
 

Fold 4
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 'Ideal' 'E' 'SI2' -0.17623676016550302]
 [-1.2007693433003284 'Good' 'E' 'VS1' -3.3952118794129094]
 [-1.0318275851408616 'Good' 'J' 'SI2' 1.0833621995400016]
 [-1.1796516235303949 'Very Good' 'J' 'VVS2' 0.7334735996218053]
 [-1.1374161839905281 'Very Good' 'H' 'SI1' 0.10367411976905298]
 [-1.2007693433003284 'Very Good' 'H' 'VS1' -1.6457688798219283]
 [-1.0529453049107949 'Good' 'J' 'SI1' 1.5732062394254782]
 [-1.2007693433003284 'Ideal' 'J' 'VS1' 0.7334735996218053]
 [-1.2218870630702616 'Premium' 'F' 'SI1' -0.9459916799855358]
 [-1.2641225026101284 'Premium' 'E' 'SI2' -1.0859471199528112]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.2007693433003284 5 6 2 -0.17623676016550302 -1.1001014896248056
  -1.5915444854651115 -1.5301186577850108 -1.5696115327877844]
 [-1.2007693433003284 2 6 5 -3.3952118794129094 3.3772680777522917
  -1.5023022126050385 -1.4517413942698225 -1.739235168570439]
 [-1.0318275851408616 2 1 2 1.0833621995400016 0.2431093805883235
  -1.2434996213108258 -1.2079010188892378 -1.1172818373673723]
 [-1.1796516235303949 3 1 6 0.7334735996218053 -0.20462757614938623
  -1.600468712751119 -1.5475358274550528 -1.4989350178783452]
 [-1.1374161839905281 3 3 3 0.10367411976905298 -1.1001014896248056
  -1.4844537580330235 -1.416907054929739 -1.428258502968906]
 [-1.2007693433003284 3 3 5 -1.6457688798219283 1.5863202508014527
  -1.5469233490350751 -1.4691585639398648 -1.6261527447153359]
 [-1.0529453049107949 2 1 3 1.5732062394254782 -1.1001014896248056
  -1.3238176668848918 -1.2688611127343836 -1.1455524433311481]
 [-1.2007693433003284 5 1 5 0.7334735996218053 -0.652364532887096
  -1.6093929400371263 -1.5997873364651782 -1.527205623842121]
 [-1.2218870630702616 4 5 3 -0.9459916799855358 1.5863202508014527
  -1.6540140764671631 -1.6520388454753037 -1.7109645626066634]
 [-1.2641225026101284 4 6 2 -1.0859471199528112 2.0340572075391625
  -1.7343321220412289 -1.7304161089904915 -1.7957763804979907]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.67881
Epoch 1, Val Loss: 2.67881
Epoch 2, Val Loss: 2.67881
Epoch 3, Val Loss: 2.67881
Epoch 4, Val Loss: 2.67881
Epoch 5, Val Loss: 2.67881
Epoch 6, Val Loss: 2.67881
Epoch 7, Val Loss: 2.67881
Epoch 8, Val Loss: 2.67881
Epoch 9, Val Loss: 2.67881
Epoch 10, Val Loss: 2.67881
Epoch 11, Val Loss: 2.67881
Epoch 12, Val Loss: 2.67881
Epoch 13, Val Loss: 2.67881
Epoch 14, Val Loss: 2.67881
Epoch 15, Val Loss: 2.67881
Epoch 16, Val Loss: 2.67881
Epoch 17, Val Loss: 2.67881
Epoch 18, Val Loss: 2.67881
Epoch 19, Val Loss: 2.67881
Epoch 20, Val Loss: 2.67881
Epoch 21, Val Loss: 2.67946
Early stopping applies.
State of save is True b4 loss saving
Log file exists at: output/VIME/Diamonds/logging/loss_3.txt
File name : output/VIME/Diamonds/logging/loss_3.txt . The file was saved
Log file exists at: output/VIME/Diamonds/logging/val_loss_3.txt
File name : output/VIME/Diamonds/logging/val_loss_3.txt . The file was saved
Saved Losses and Regularization
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.5151, 'Log Loss - std': 2.7387237529550146} 
 

Fold 5
num_features : 9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
BEFORE ANY ENCODING
num_features :9
num_classes : 1
cat_idx : [0]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [2]
bin_alt : None 


X shape : (43152, 9)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


AFTER SEPARATING CATEGORICALS AND NUMERICALS
Numerical Index V1 : [0, 4, 5, 6, 7, 8]
Cat Dims V1 : [6, 8, 9]
Cat Idx V1 : [1, 2, 3] 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 


Scaling the data...
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After OHE
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 'Ideal' 'E' 'SI2' -0.16918805719128635]
 [-1.2373782800036142 'Premium' 'E' 'SI1' -1.354043921120755]
 [-1.1951587568816937 'Good' 'E' 'VS1' -3.375268630176903]
 [-1.0685001875159332 'Premium' 'I' 'VS2' 0.4580885766537244]
 [-1.0262806643940128 'Good' 'J' 'SI2' 1.085365210498735]
 [-1.1740489953207336 'Very Good' 'I' 'VVS1' 0.3883911728931665]
 [-1.1318294721988134 'Very Good' 'H' 'SI1' 0.10960155785094007]
 [-1.2162685184426538 'Fair' 'E' 'VS2' 2.3399184781887565]
 [-1.1951587568816937 'Ideal' 'J' 'VS1' 0.7368781916959508]
 [-1.2162685184426538 'Premium' 'F' 'SI1' -0.9358594985574128]] 
 
 
Val : (43152, 9) 
 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
After ORDINAL
Numerical Index V2 : [0, 4, 5, 6, 7, 8] 


OHE Idx : None


Ordinal Idx V2: [1, 2, 3]


Cat Dims V2 : [6, 8, 9]
Cat Idx V2 : [1, 2, 3] 
 

Train: [[-1.1951587568816937 5 6 2 -0.16918805719128635 -1.095468028782346
  -1.5839349366235063 -1.5322976251522233 -1.56187701865597]
 [-1.2373782800036142 4 6 3 -1.354043921120755 1.5812091849357435
  -1.6374236122792667 -1.6548711768767947 -1.731354397531372]
 [-1.1951587568816937 2 6 5 -3.375268630176903 3.3656606607478032
  -1.4947871438639058 -1.4535003419007129 -1.731354397531372]
 [-1.0685001875159332 4 2 4 0.4580885766537244 0.24287057807669882
  -1.3610654547245045 -1.313416282786917 -1.2794147205303008]
 [-1.0262806643940128 2 1 2 1.085365210498735 0.24287057807669882
  -1.236258544861064 -1.2083532384515707 -1.1099373416548988]
 [-1.1740489953207336 3 2 7 0.3883911728931665 -0.2032422908763161
  -1.5839349366235063 -1.5322976251522233 -1.5053845590308361]
 [-1.1318294721988134 3 3 3 0.10960155785094007 -1.095468028782346
  -1.4769575853119854 -1.418479327122264 -1.4206458695931359]
 [-1.2162685184426538 1 6 4 2.3399184781887565 1.5812091849357435
  -1.6552531708311868 -1.7074026990444682 -1.4771383292182692]
 [-1.1951587568816937 5 1 5 0.7368781916959508 -0.649355159829331
  -1.6017644951754264 -1.602339654709121 -1.51950767393712]
 [-1.2162685184426538 4 5 3 -0.9358594985574128 1.5812091849357435
  -1.646338391555227 -1.6548711768767947 -1.7031081677188051]] 
 
 
Val : (43152, 9) 
 

FINISHED ENCODING
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
num_features :9
num_classes : 1
cat_idx : [1, 2, 3]
nominal_idx : None
ordinal_idx : [1, 2, 3]
num_idx : None
cat_dims : [6, 8, 9]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Number of Classes B4 Bin Verifier: 14
Unique values in y_train: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
Unique values in y_test: (array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12.,
       13.]), 14)
MAX : 13 , Max diff : 1, LEN : 14 , BINS : 14
VERIFY SHIFT
Train after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Test after shift : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13], Length : 14
Number of Classes After Bin Verifier: 14
In get_device
On Device: cuda
{'p_m': 0.20832777474756226, 'alpha': 3.563299246825732, 'K': 10, 'beta': 0.15752439579445252}
Fitted encoder
Epoch 0, Val Loss: 2.68534
Epoch 1, Val Loss: 2.68534
Epoch 2, Val Loss: 2.68534
Epoch 3, Val Loss: 2.68534
Epoch 4, Val Loss: 2.68534
Epoch 5, Val Loss: 2.68534
Epoch 6, Val Loss: 2.68534
Epoch 7, Val Loss: 2.68534
Epoch 8, Val Loss: 2.68534
Epoch 9, Val Loss: 2.68534
Epoch 10, Val Loss: 2.68534
Epoch 11, Val Loss: 2.68534
Epoch 12, Val Loss: 2.68534
Epoch 13, Val Loss: 2.68534
Epoch 14, Val Loss: 2.68534
Epoch 15, Val Loss: 2.68534
Epoch 16, Val Loss: 2.68535
Epoch 17, Val Loss: 2.68534
Epoch 18, Val Loss: 2.68534
Epoch 19, Val Loss: 2.68534
Epoch 20, Val Loss: 2.68534
Epoch 21, Val Loss: 2.68534
Early stopping applies.
State of save is True b4 loss saving
Log file exists at: output/VIME/Diamonds/logging/loss_4.txt
File name : output/VIME/Diamonds/logging/loss_4.txt . The file was saved
Log file exists at: output/VIME/Diamonds/logging/val_loss_4.txt
File name : output/VIME/Diamonds/logging/val_loss_4.txt . The file was saved
Saved Losses and Regularization
B4 Evaluation
Number of classes : 14
Unique y_true : [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13] 

Prediction shape : (10788,)
Probabilities shape : (10788, 14) 

After Evaluation
{'Log Loss - mean': 8.953320000000001, 'Log Loss - std': 2.6016597221004902} 
 

Saving model.....
Results After CV: {'Log Loss - mean': 8.953320000000001, 'Log Loss - std': 2.6016597221004902}
Train time: 720.1412838551972
Inference time: 0.25464324839413166
Finished cross validation
Loss path :output/VIME/Diamonds/logging/
Plots saved successfully!
