 Panda Version: 2.0.3
Namespace(batch_size=128, cat_dims=None, cat_idx=None, config='config/black_friday.yml', data_parallel=False, dataset='Black_Friday', direction='minimize', dropna_idx=None, early_stopping_rounds=20, epochs=100, gpu_ids=[0, 1], logging_period=100, miss_cat_idx=None, miss_num_idx=None, model_name='NODE', n_trials=7, nominal_idx=[0, 2, 3, 5, 6, 7, 8], num_classes=1, num_features=9, num_idx=None, num_splits=5, objective='regression', one_hot_encode=True, optimize_hyperparameters=True, ordinal_encode=True, ordinal_idx=[1], scale=True, seed=221, shuffle=True, target_encode=False, use_gpu=True, val_batch_size=256)
Start hyperparameter optimization
 Panda Version: 2.0.3
Loading dataset Black_Friday...
Dataset loaded! 

X b4 encoding : ['F' '0-17' 10 'A' 2 0 1 6 14] 

(166821, 9)
Data Type of X: <class 'numpy.ndarray'>
Nominal Idx: [0, 2, 3, 5, 6, 7, 8]
Ordinal Idx: [1]
Cat Dims: None 
 

Normonal Idx: [0, 2, 3, 5, 6, 7, 8]
Cat Idx Part II: [0, 1, 2, 3, 5, 6, 7, 8] 
ENDE 
 

X after Nominal Encoding: ['F' '0-17' 10 'A' 2 0 1 6 14] 
 

Scaling the data...
X after Scaling: ['F' '0-17' 10 'A' 0.1076520112629123 0 1 6 14] 
 

Ordinal Idx: [0]
One Hot Encoding...
X after One Hot Encoding: ['0-17' 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0
 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0
 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0
 0.1076520112629123] 
 

args.num_features: 71
args.cat_idx: [0]
Cat Dims: [8]
New Shape: (166821, 71)
True 
 

A new study created in RDB with name: NODE_Black_Friday
In get_device
On: cuda
On Device: cuda
In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:28:54/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_avg.pth
Loss 157333696.00000
Val MSE: 161683920.00000
Val Loss: 161683920.00000
Saved logs/Black_Friday_2025.01.21_11:28:54/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:28:54/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_avg.pth
Loss 150020736.00000
Val MSE: 161681712.00000
Val Loss: 161681712.00000
Saved logs/Black_Friday_2025.01.21_11:28:54/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:28:54/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_avg.pth
Loss 156821808.00000
Val MSE: 161684256.00000
Val Loss: 161684256.00000
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 161681712.00000
Loaded logs/Black_Friday_2025.01.21_11:28:54/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_0.pt
Saved output/NODE/Black_Friday/models/m_0.pt
Saved Losses
{'MSE - mean': 161681705.54576144, 'MSE - std': 0.0, 'R2 - mean': -5.329186230252196, 'R2 - std': 0.0} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:29:57/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_avg.pth
Loss 150080320.00000
Val MSE: 162377200.00000
Val Loss: 162377200.00000
Saved logs/Black_Friday_2025.01.21_11:29:57/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:29:57/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_avg.pth
Loss 171586656.00000
Val MSE: 162374000.00000
Val Loss: 162374000.00000
Saved logs/Black_Friday_2025.01.21_11:29:57/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:29:57/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_avg.pth
Loss 159113760.00000
Val MSE: 162376320.00000
Val Loss: 162376320.00000
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 162374000.00000
Loaded logs/Black_Friday_2025.01.21_11:29:57/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_1.pt
Saved output/NODE/Black_Friday/models/m_1.pt
Saved Losses
{'MSE - mean': 162027846.36585402, 'MSE - std': 346140.82009258866, 'R2 - mean': -5.305583842631753, 'R2 - std': 0.0236023876204432} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:31:01/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_avg.pth
Loss 169109760.00000
Val MSE: 162332608.00000
Val Loss: 162332608.00000
Saved logs/Black_Friday_2025.01.21_11:31:01/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:31:01/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_avg.pth
Loss 161190144.00000
Val MSE: 162329632.00000
Val Loss: 162329632.00000
Saved logs/Black_Friday_2025.01.21_11:31:01/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:31:01/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_avg.pth
Loss 154546496.00000
Val MSE: 162332320.00000
Val Loss: 162332320.00000
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 162329632.00000
Loaded logs/Black_Friday_2025.01.21_11:31:01/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_2.pt
Saved output/NODE/Black_Friday/models/m_2.pt
Saved Losses
{'MSE - mean': 162128443.1607383, 'MSE - std': 316409.66352428845, 'R2 - mean': -5.300888876333858, 'R2 - std': 0.02038301297650802} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:32:06/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_avg.pth
Loss 170255360.00000
Val MSE: 160478384.00000
Val Loss: 160478384.00000
Saved logs/Black_Friday_2025.01.21_11:32:06/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:32:06/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_avg.pth
Loss 176528256.00000
Val MSE: 160475872.00000
Val Loss: 160475872.00000
Saved logs/Black_Friday_2025.01.21_11:32:06/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:32:06/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_avg.pth
Loss 175915504.00000
Val MSE: 160478768.00000
Val Loss: 160478768.00000
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 160475872.00000
Loaded logs/Black_Friday_2025.01.21_11:32:06/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_3.pt
Saved output/NODE/Black_Friday/models/m_3.pt
Saved Losses
{'MSE - mean': 161715299.21863097, 'MSE - std': 766257.1742428461, 'R2 - mean': -5.276567929018403, 'R2 - std': 0.045674126685290424} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:33:08/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_avg.pth
Loss 163873088.00000
Val MSE: 161663264.00000
Val Loss: 161663264.00000
Saved logs/Black_Friday_2025.01.21_11:33:08/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:33:08/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_avg.pth
Loss 177511248.00000
Val MSE: 161660176.00000
Val Loss: 161660176.00000
Saved logs/Black_Friday_2025.01.21_11:33:08/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:33:08/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_avg.pth
Loss 157569504.00000
Val MSE: 161663264.00000
Val Loss: 161663264.00000
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 161660176.00000
Loaded logs/Black_Friday_2025.01.21_11:33:08/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_4.pt
Saved output/NODE/Black_Friday/models/m_4.pt
Saved Losses
{'MSE - mean': 161704276.77386084, 'MSE - std': 685715.7011602898, 'R2 - mean': -5.260975451146829, 'R2 - std': 0.05139457309359711} 
 

Saving model.....
Results After CV: {'MSE - mean': 161704276.77386084, 'MSE - std': 685715.7011602898, 'R2 - mean': -5.260975451146829, 'R2 - std': 0.05139457309359711}
Train time: 49.26759461399999
Inference time: 3.35648614319999
Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 0 finished with value: 161704276.77386084 and parameters: {'num_layers': 4, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 0 with value: 161704276.77386084.
In get_device
On: cuda
On Device: cuda
In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:34:14/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_avg.pth
Loss 167351296.00000
Val MSE: 161690608.00000
Val Loss: 161690608.00000
Saved logs/Black_Friday_2025.01.21_11:34:14/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:34:14/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_avg.pth
Loss 164155600.00000
Val MSE: 161687248.00000
Val Loss: 161687248.00000
Saved logs/Black_Friday_2025.01.21_11:34:14/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:34:14/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_avg.pth
Loss 144922384.00000
Val MSE: 161691168.00000
Val Loss: 161691168.00000
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 161687248.00000
Loaded logs/Black_Friday_2025.01.21_11:34:14/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_0.pt
Saved output/NODE/Black_Friday/models/m_0.pt
Saved Losses
{'MSE - mean': 161687254.79559118, 'MSE - std': 0.0, 'R2 - mean': -5.329403460986447, 'R2 - std': 0.0} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:34:38/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_avg.pth
Loss 163164128.00000
Val MSE: 162382256.00000
Val Loss: 162382256.00000
Saved logs/Black_Friday_2025.01.21_11:34:38/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:34:38/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_avg.pth
Loss 145577440.00000
Val MSE: 162379152.00000
Val Loss: 162379152.00000
Saved logs/Black_Friday_2025.01.21_11:34:38/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:34:38/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_avg.pth
Loss 159317920.00000
Val MSE: 162382064.00000
Val Loss: 162382064.00000
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 162379152.00000
Loaded logs/Black_Friday_2025.01.21_11:34:38/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_1.pt
Saved output/NODE/Black_Friday/models/m_1.pt
Saved Losses
{'MSE - mean': 162033198.35386246, 'MSE - std': 345943.5582713038, 'R2 - mean': -5.30579217192127, 'R2 - std': 0.023611289065176955} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:35:03/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_avg.pth
Loss 173483824.00000
Val MSE: 162337616.00000
Val Loss: 162337616.00000
Saved logs/Black_Friday_2025.01.21_11:35:03/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:35:03/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_avg.pth
Loss 169867392.00000
Val MSE: 162334656.00000
Val Loss: 162334656.00000
Saved logs/Black_Friday_2025.01.21_11:35:03/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:35:03/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_avg.pth
Loss 172276592.00000
Val MSE: 162337840.00000
Val Loss: 162337840.00000
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 162334656.00000
Loaded logs/Black_Friday_2025.01.21_11:35:03/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_2.pt
Saved output/NODE/Black_Friday/models/m_2.pt
Saved Losses
{'MSE - mean': 162133687.23607734, 'MSE - std': 316197.1872695944, 'R2 - mean': -5.301092723409757, 'R2 - std': 0.02039194972297388} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:35:26/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_avg.pth
Loss 157780560.00000
Val MSE: 160483504.00000
Val Loss: 160483504.00000
Saved logs/Black_Friday_2025.01.21_11:35:26/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:35:26/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_avg.pth
Loss 172621968.00000
Val MSE: 160480272.00000
Val Loss: 160480272.00000
Saved logs/Black_Friday_2025.01.21_11:35:26/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:35:26/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_avg.pth
Loss 165255984.00000
Val MSE: 160483376.00000
Val Loss: 160483376.00000
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 160480272.00000
Loaded logs/Black_Friday_2025.01.21_11:35:26/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_3.pt
Saved output/NODE/Black_Friday/models/m_3.pt
Saved Losses
{'MSE - mean': 161720331.64972445, 'MSE - std': 766533.7684899031, 'R2 - mean': -5.276763313461832, 'R2 - std': 0.04569063662689296} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:35:48/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_avg.pth
Loss 162640032.00000
Val MSE: 161668416.00000
Val Loss: 161668416.00000
Saved logs/Black_Friday_2025.01.21_11:35:48/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:35:48/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_avg.pth
Loss 168030272.00000
Val MSE: 161665504.00000
Val Loss: 161665504.00000
Saved logs/Black_Friday_2025.01.21_11:35:48/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:35:48/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_avg.pth
Loss 151463856.00000
Val MSE: 161668768.00000
Val Loss: 161668768.00000
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 161665504.00000
Loaded logs/Black_Friday_2025.01.21_11:35:48/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_4.pt
Saved output/NODE/Black_Friday/models/m_4.pt
Saved Losses
{'MSE - mean': 161709367.1084071, 'MSE - std': 685959.2548056069, 'R2 - mean': -5.261172571048985, 'R2 - std': 0.05140420621147305} 
 

Saving model.....
Results After CV: {'MSE - mean': 161709367.1084071, 'MSE - std': 685959.2548056069, 'R2 - mean': -5.261172571048985, 'R2 - std': 0.05140420621147305}
Train time: 15.213355279400002
Inference time: 1.1985105253999904
Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 1 finished with value: 161709367.1084071 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 2}. Best is trial 0 with value: 161704276.77386084.
In get_device
On: cuda
On Device: cuda
In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:36:12/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_avg.pth
Loss 157338832.00000
Val MSE: 161689056.00000
Val Loss: 161689056.00000
Saved logs/Black_Friday_2025.01.21_11:36:12/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:36:12/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_avg.pth
Loss 150018976.00000
Val MSE: 161686432.00000
Val Loss: 161686432.00000
Saved logs/Black_Friday_2025.01.21_11:36:12/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:36:12/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_avg.pth
Loss 156816512.00000
Val MSE: 161689952.00000
Val Loss: 161689952.00000
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 161686432.00000
Loaded logs/Black_Friday_2025.01.21_11:36:12/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_0.pt
Saved output/NODE/Black_Friday/models/m_0.pt
Saved Losses
{'MSE - mean': 161686439.05558372, 'MSE - std': 0.0, 'R2 - mean': -5.329371528057454, 'R2 - std': 0.0} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:37:12/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_avg.pth
Loss 150085152.00000
Val MSE: 162382224.00000
Val Loss: 162382224.00000
Saved logs/Black_Friday_2025.01.21_11:37:12/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:37:12/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_avg.pth
Loss 171585760.00000
Val MSE: 162379984.00000
Val Loss: 162379984.00000
Saved logs/Black_Friday_2025.01.21_11:37:12/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:37:12/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_avg.pth
Loss 159108464.00000
Val MSE: 162383120.00000
Val Loss: 162383120.00000
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 162379984.00000
Loaded logs/Black_Friday_2025.01.21_11:37:12/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_1.pt
Saved output/NODE/Black_Friday/models/m_1.pt
Saved Losses
{'MSE - mean': 162033214.9031868, 'MSE - std': 346775.84760308266, 'R2 - mean': -5.305792625539782, 'R2 - std': 0.02357890251767225} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:38:07/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_avg.pth
Loss 169114976.00000
Val MSE: 162337664.00000
Val Loss: 162337664.00000
Saved logs/Black_Friday_2025.01.21_11:38:07/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:38:07/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_avg.pth
Loss 161189312.00000
Val MSE: 162335648.00000
Val Loss: 162335648.00000
Saved logs/Black_Friday_2025.01.21_11:38:07/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:38:07/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_avg.pth
Loss 154541120.00000
Val MSE: 162338032.00000
Val Loss: 162338032.00000
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 162335648.00000
Loaded logs/Black_Friday_2025.01.21_11:38:07/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_2.pt
Saved output/NODE/Black_Friday/models/m_2.pt
Saved Losses
{'MSE - mean': 162134026.1161015, 'MSE - std': 317009.13806896115, 'R2 - mean': -5.3011057323739275, 'R2 - std': 0.020361164776477026} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:39:06/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_avg.pth
Loss 170260608.00000
Val MSE: 160483408.00000
Val Loss: 160483408.00000
Saved logs/Black_Friday_2025.01.21_11:39:06/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:39:06/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_avg.pth
Loss 176527488.00000
Val MSE: 160480976.00000
Val Loss: 160480976.00000
Saved logs/Black_Friday_2025.01.21_11:39:06/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:39:06/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_avg.pth
Loss 175909792.00000
Val MSE: 160483776.00000
Val Loss: 160483776.00000
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 160480976.00000
Loaded logs/Black_Friday_2025.01.21_11:39:06/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_3.pt
Saved output/NODE/Black_Friday/models/m_3.pt
Saved Losses
{'MSE - mean': 161720761.42111915, 'MSE - std': 766638.2586141565, 'R2 - mean': -5.2767798588918655, 'R2 - std': 0.04567468812468237} 
 

In get_device
On: cuda
On Device: cuda
Saved logs/Black_Friday_2025.01.21_11:40:02/checkpoint_temp_100.pth
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_avg.pth
Loss 163878336.00000
Val MSE: 161668416.00000
Val Loss: 161668416.00000
Saved logs/Black_Friday_2025.01.21_11:40:02/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_temp_100.pth
Saved logs/Black_Friday_2025.01.21_11:40:02/checkpoint_temp_200.pth
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_avg.pth
Loss 177510336.00000
Val MSE: 161665840.00000
Val Loss: 161665840.00000
Saved logs/Black_Friday_2025.01.21_11:40:02/checkpoint_best.pth
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_temp_200.pth
Saved logs/Black_Friday_2025.01.21_11:40:02/checkpoint_temp_300.pth
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_avg.pth
Loss 157564480.00000
Val MSE: 161668784.00000
Val Loss: 161668784.00000
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_temp_300.pth
BREAK. There is no improvment for 120 steps
Best step:  200
Best Val Loss: 161665840.00000
Loaded logs/Black_Friday_2025.01.21_11:40:02/checkpoint_best.pth
Saving at output/NODE/Black_Friday/models/m_4.pt
Saved output/NODE/Black_Friday/models/m_4.pt
Saved Losses
{'MSE - mean': 161709775.14910832, 'MSE - std': 686054.056432539, 'R2 - mean': -5.261188269945356, 'R2 - std': 0.051393893525761875} 
 

Saving model.....
Results After CV: {'MSE - mean': 161709775.14910832, 'MSE - std': 686054.056432539, 'R2 - mean': -5.261188269945356, 'R2 - std': 0.051393893525761875}
Train time: 44.789504771199994
Inference time: 2.9201585027999952
Finished cross validation
Hyperparam was saved!!! Hurrah!!!
Trial 2 finished with value: 161709775.14910832 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 0 with value: 161704276.77386084.
In get_device
On: cuda
On Device: cuda
In get_device
On: cuda
On Device: cuda
Trial 3 failed with parameters: {'num_layers': 2, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 2} because of the following error: OutOfMemoryError('CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.12 GiB is free. Including non-PyTorch memory, this process has 678.00 MiB memory in use. Of the allocated memory 320.18 MiB is allocated by PyTorch, and 223.82 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF').
Traceback (most recent call last):
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "train.py", line 134, in __call__
    sc, time = cross_validation(model, self.X, self.y, self.args, visual=False)
  File "train.py", line 46, in cross_validation
    loss_history, val_loss_history = curr_model.fit(X_train, y_train, X_test, y_test)  # X_val, y_val)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node.py", line 64, in fit
    res = self.model(torch.as_tensor(data.X_train[:1000], device=self.device))
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/arch.py", line 31, in forward
    h = layer(layer_inp)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/nn_utils.py", line 221, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/odst.py", line 98, in forward
    bin_matches = torch.einsum('btds,dcs->btdc', bins, self.bin_codes_1hot)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/functional.py", line 377, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.12 GiB is free. Including non-PyTorch memory, this process has 678.00 MiB memory in use. Of the allocated memory 320.18 MiB is allocated by PyTorch, and 223.82 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Trial 3 failed with value None.
