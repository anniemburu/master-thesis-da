[I 2025-01-23 02:12:08,785] A new study created in RDB with name: NODE_Brazillian_Houses
[I 2025-01-23 04:25:59,954] Trial 0 finished with value: 301764794.80898273 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 06:51:28,764] Trial 1 finished with value: 301809490.2928333 and parameters: {'num_layers': 4, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 10:09:11,961] Trial 2 finished with value: 301781401.63039833 and parameters: {'num_layers': 8, 'total_tree_count': 2048, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 11:54:55,999] Trial 3 finished with value: 301809490.2928333 and parameters: {'num_layers': 4, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 12:45:52,729] Trial 4 finished with value: 301794016.52063394 and parameters: {'num_layers': 4, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 14:07:11,811] Trial 5 finished with value: 301778068.50271815 and parameters: {'num_layers': 2, 'total_tree_count': 2048, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 16:16:12,758] Trial 6 finished with value: 301781401.63039833 and parameters: {'num_layers': 8, 'total_tree_count': 2048, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 0 with value: 301764794.80898273.
[I 2025-01-23 17:33:15,971] Trial 7 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-23 18:46:58,487] Trial 8 finished with value: 301778068.50271815 and parameters: {'num_layers': 2, 'total_tree_count': 2048, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-23 20:03:19,408] Trial 9 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-23 20:59:21,499] Trial 10 finished with value: 301774729.6640917 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-23 22:15:16,612] Trial 11 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-23 23:32:41,237] Trial 12 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 00:49:02,489] Trial 13 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 02:05:05,707] Trial 14 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 03:21:05,295] Trial 15 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 04:37:08,166] Trial 16 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 05:33:18,184] Trial 17 finished with value: 301774729.6640917 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 06:19:20,166] Trial 18 finished with value: 301767089.9815414 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 07:46:26,428] Trial 19 finished with value: 301762341.76241124 and parameters: {'num_layers': 4, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 08:42:21,897] Trial 20 finished with value: 301774729.6640917 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 09:58:26,494] Trial 21 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 11:14:22,246] Trial 22 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 12:31:23,030] Trial 23 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 13:48:16,618] Trial 24 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 15:05:14,038] Trial 25 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 16:21:22,986] Trial 26 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 16:50:05,349] Trial 27 finished with value: 301761045.5418501 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 18:19:10,729] Trial 28 finished with value: 301762341.76241124 and parameters: {'num_layers': 4, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 19:55:08,012] Trial 29 finished with value: 301764946.00786006 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 21:29:52,351] Trial 30 finished with value: 301764946.00786006 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-24 22:45:48,066] Trial 31 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-25 00:01:37,875] Trial 32 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[I 2025-01-25 01:17:31,322] Trial 33 finished with value: 301758102.48443514 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 7 with value: 301758102.48443514.
[W 2025-01-25 01:17:33,457] Trial 34 failed with parameters: {'num_layers': 2, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 3} because of the following error: OutOfMemoryError('CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.13 GiB is free. Including non-PyTorch memory, this process has 668.00 MiB memory in use. Of the allocated memory 380.66 MiB is allocated by PyTorch, and 153.34 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF').
Traceback (most recent call last):
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "train.py", line 134, in __call__
    sc, time = cross_validation(model, self.X, self.y, self.args, visual=False)
  File "train.py", line 46, in cross_validation
    loss_history, val_loss_history = curr_model.fit(X_train, y_train, X_test, y_test)  # X_val, y_val)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node.py", line 64, in fit
    res = self.model(torch.as_tensor(data.X_train[:1000], device=self.device))
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/arch.py", line 31, in forward
    h = layer(layer_inp)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/nn_utils.py", line 221, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/odst.py", line 98, in forward
    bin_matches = torch.einsum('btds,dcs->btdc', bins, self.bin_codes_1hot)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/functional.py", line 377, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.13 GiB is free. Including non-PyTorch memory, this process has 668.00 MiB memory in use. Of the allocated memory 380.66 MiB is allocated by PyTorch, and 153.34 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[W 2025-01-25 01:17:33,462] Trial 34 failed with value None.
Traceback (most recent call last):
  File "train.py", line 185, in <module>
    main(arguments)
  File "train.py", line 156, in main
    study.optimize(Objective(args, model_name, X, y), n_trials=args.n_trials)
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "train.py", line 134, in __call__
    sc, time = cross_validation(model, self.X, self.y, self.args, visual=False)
  File "train.py", line 46, in cross_validation
    loss_history, val_loss_history = curr_model.fit(X_train, y_train, X_test, y_test)  # X_val, y_val)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node.py", line 64, in fit
    res = self.model(torch.as_tensor(data.X_train[:1000], device=self.device))
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/arch.py", line 31, in forward
    h = layer(layer_inp)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/nn_utils.py", line 221, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/odst.py", line 98, in forward
    bin_matches = torch.einsum('btds,dcs->btdc', bins, self.bin_codes_1hot)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/functional.py", line 377, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.13 GiB is free. Including non-PyTorch memory, this process has 668.00 MiB memory in use. Of the allocated memory 380.66 MiB is allocated by PyTorch, and 153.34 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
srun: error: stud-000: task 0: Exited with exit code 1
[I 2025-01-25 01:17:42,350] A new study created in RDB with name: NODE_Abalone
[I 2025-01-25 01:24:17,876] Trial 0 finished with value: 83.54900117305971 and parameters: {'num_layers': 4, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 2}. Best is trial 0 with value: 83.54900117305971.
[I 2025-01-25 01:40:00,064] Trial 1 finished with value: 50.99339193702194 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 1 with value: 50.99339193702194.
[I 2025-01-25 01:44:06,998] Trial 2 finished with value: 75.4493957428232 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 2}. Best is trial 1 with value: 50.99339193702194.
[I 2025-01-25 01:55:58,984] Trial 3 finished with value: 38.093803789001996 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 3 with value: 38.093803789001996.
[I 2025-01-25 02:11:46,501] Trial 4 finished with value: 50.99339193702194 and parameters: {'num_layers': 8, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 3}. Best is trial 3 with value: 38.093803789001996.
[I 2025-01-25 02:15:49,072] Trial 5 finished with value: 87.65396722047959 and parameters: {'num_layers': 2, 'total_tree_count': 2048, 'tree_depth': 6, 'tree_output_dim': 2}. Best is trial 3 with value: 38.093803789001996.
[I 2025-01-25 02:17:36,060] Trial 6 finished with value: 86.64415781549476 and parameters: {'num_layers': 2, 'total_tree_count': 1024, 'tree_depth': 6, 'tree_output_dim': 2}. Best is trial 3 with value: 38.093803789001996.
[I 2025-01-25 02:26:06,209] Trial 7 finished with value: 81.53627370480845 and parameters: {'num_layers': 8, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 3}. Best is trial 3 with value: 38.093803789001996.
[W 2025-01-25 02:26:08,193] Trial 8 failed with parameters: {'num_layers': 2, 'total_tree_count': 2048, 'tree_depth': 8, 'tree_output_dim': 3} because of the following error: OutOfMemoryError('CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.10 GiB is free. Including non-PyTorch memory, this process has 704.00 MiB memory in use. Of the allocated memory 379.17 MiB is allocated by PyTorch, and 190.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF').
Traceback (most recent call last):
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "train.py", line 134, in __call__
    sc, time = cross_validation(model, self.X, self.y, self.args, visual=False)
  File "train.py", line 46, in cross_validation
    loss_history, val_loss_history = curr_model.fit(X_train, y_train, X_test, y_test)  # X_val, y_val)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node.py", line 64, in fit
    res = self.model(torch.as_tensor(data.X_train[:1000], device=self.device))
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/arch.py", line 31, in forward
    h = layer(layer_inp)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/nn_utils.py", line 221, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/odst.py", line 98, in forward
    bin_matches = torch.einsum('btds,dcs->btdc', bins, self.bin_codes_1hot)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/functional.py", line 377, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.10 GiB is free. Including non-PyTorch memory, this process has 704.00 MiB memory in use. Of the allocated memory 379.17 MiB is allocated by PyTorch, and 190.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[W 2025-01-25 02:26:08,198] Trial 8 failed with value None.
Traceback (most recent call last):
  File "train.py", line 185, in <module>
    main(arguments)
  File "train.py", line 156, in main
    study.optimize(Objective(args, model_name, X, y), n_trials=args.n_trials)
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/home/mburu/.local/lib/python3.8/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "train.py", line 134, in __call__
    sc, time = cross_validation(model, self.X, self.y, self.args, visual=False)
  File "train.py", line 46, in cross_validation
    loss_history, val_loss_history = curr_model.fit(X_train, y_train, X_test, y_test)  # X_val, y_val)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node.py", line 64, in fit
    res = self.model(torch.as_tensor(data.X_train[:1000], device=self.device))
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/arch.py", line 31, in forward
    h = layer(layer_inp)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/nn_utils.py", line 221, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mburu/Master_Thesis/master-thesis-da/DNN_Trial/models/node_lib/odst.py", line 98, in forward
    bin_matches = torch.einsum('btds,dcs->btdc', bins, self.bin_codes_1hot)
  File "/home/mburu/miniconda3/envs/Test4Node/lib/python3.8/site-packages/torch/functional.py", line 377, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 7.81 GiB. GPU 0 has a total capacty of 7.79 GiB of which 7.10 GiB is free. Including non-PyTorch memory, this process has 704.00 MiB memory in use. Of the allocated memory 379.17 MiB is allocated by PyTorch, and 190.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
srun: error: stud-000: task 0: Exited with exit code 1
